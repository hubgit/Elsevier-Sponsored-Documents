<article xmlns="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle http://dtd.nlm.nih.gov/2.0/xsd/archivearticle.xsd" article-type="research-article">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Neuroimage</journal-id>
      <journal-title-group>
        <journal-title>Neuroimage</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1053-8119</issn>
      <issn pub-type="epub">1095-9572</issn>
      <publisher>
        <publisher-name>Academic Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmc">3224863</article-id>
      <article-id pub-id-type="pmid">19635575</article-id>
      <article-id pub-id-type="publisher-id">YNIMG6445</article-id>
      <article-id pub-id-type="doi">10.1016/j.neuroimage.2009.07.043</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Investigating spatial specificity and data averaging in MEG</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Brookes</surname>
            <given-names>Matthew J.</given-names>
          </name>
          <email>brookes@magres.nottingham.ac.uk</email>
          <xref rid="af0005" ref-type="aff">a</xref>
          <xref rid="cr0005" ref-type="corresp">⁎</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Zumer</surname>
            <given-names>Johanna M.</given-names>
          </name>
          <xref rid="af0005" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Stevenson</surname>
            <given-names>Claire M.</given-names>
          </name>
          <xref rid="af0005" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Hale</surname>
            <given-names>Joanne R.</given-names>
          </name>
          <xref rid="af0005" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Barnes</surname>
            <given-names>Gareth R.</given-names>
          </name>
          <xref rid="af0010" ref-type="aff">b</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Vrba</surname>
            <given-names>Jiri</given-names>
          </name>
          <xref rid="af0015" ref-type="aff">c</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Morris</surname>
            <given-names>Peter G.</given-names>
          </name>
          <xref rid="af0005" ref-type="aff">a</xref>
        </contrib>
      </contrib-group>
      <aff id="af0005"><label>a</label>Sir Peter Mansfield Magnetic Resonance Centre, School of Physics and Astronomy, University of Nottingham, University Park, Nottingham NG7 2RD, UK</aff>
      <aff id="af0010"><label>b</label>Wellcome Trust Centre for Neuroimaging, University College London, London, UK</aff>
      <aff id="af0015"><label>c</label>Elekta-Neuromag Oy, Helsinki, Finland</aff>
      <author-notes>
        <corresp id="cr0005"><label>⁎</label>Corresponding author. <email>brookes@magres.nottingham.ac.uk</email></corresp>
      </author-notes>
      <pub-date pub-type="pmc-release">
        <day>01</day>
        <month>1</month>
        <year>2010</year>
      </pub-date>
      <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="ppub"/>. -->
      <pub-date pub-type="ppub">
        <day>01</day>
        <month>1</month>
        <year>2010</year>
      </pub-date>
      <volume>49</volume>
      <issue>1</issue>
      <fpage>525</fpage>
      <lpage>538</lpage>
      <history>
        <date date-type="received">
          <day>28</day>
          <month>3</month>
          <year>2009</year>
        </date>
        <date date-type="rev-recd">
          <day>9</day>
          <month>7</month>
          <year>2009</year>
        </date>
        <date date-type="accepted">
          <day>13</day>
          <month>7</month>
          <year>2009</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2010 Elsevier Inc.</copyright-statement>
        <copyright-year>2009</copyright-year>
        <copyright-holder>Elsevier Inc.</copyright-holder>
        <license>
          <license-p>This document may be redistributed and reused, subject to <ext-link ext-link-type="uri" xlink:href="http://www.elsevier.com/wps/find/authorsview.authors/supplementalterms1.0">certain conditions</ext-link>.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>This study shows that the spatial specificity of MEG beamformer estimates of electrical activity can be affected significantly by the way in which covariance estimates are calculated. We define spatial specificity as the ability to extract independent timecourse estimates of electrical brain activity from two separate brain locations in close proximity. Previous analytical and simulated results have shown that beamformer estimates are affected by narrowing the time frequency window in which covariance estimates are made. Here we build on this by both experimental validation of previous results, and investigating the effect of data averaging prior to covariance estimation. In appropriate circumstances, we show that averaging has a marked effect on spatial specificity. However the averaging process results in ill-conditioned covariance matrices, thus necessitating a suitable matrix regularisation strategy, an example of which is described. We apply our findings to an MEG retinotopic mapping paradigm. A moving visual stimulus is used to elicit brain activation at different retinotopic locations in the visual cortex. This gives the impression of a moving electrical dipolar source in the brain. We show that if appropriate beamformer optimisation is applied, the moving source can be tracked in the cortex. In addition to spatial reconstruction of the moving source, we show that timecourse estimates can be extracted from neighbouring locations of interest in the visual cortex. If appropriate methodology is employed, the sequential activation of separate retinotopic locations can be observed. The retinotopic paradigm represents an ideal platform to test the spatial specificity of source localisation strategies. We suggest that future comparisons of MEG source localisation techniques (e.g. beamformer, minimum norm, Bayesian) could be made using this retinotopic mapping paradigm.</p>
      </abstract>
      <kwd-group>
        <title>Keywords</title>
        <kwd>MEG</kwd>
        <kwd>Spatial specificity</kwd>
        <kwd>Spatial resolution</kwd>
        <kwd>Source localisation</kwd>
        <kwd>Linearly constrained minimum variance beamformer</kwd>
        <kwd>Retinotopic mapping</kwd>
        <kwd>Regularisation</kwd>
        <kwd>Information content</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="s0005">
      <title>Introduction</title>
      <p>Magnetoencephalography (MEG) is a non-invasive functional brain imaging modality that measures the magnetic fields induced above the scalp by the flow of ion currents between the dendritic tree and the soma of neuronal cells (<xref rid="bb0065" ref-type="bibr">Hamalainen et al., 1993</xref>). MEG is a direct measure of neuronal activity since the magnitude of the measured fields is directly proportional to the magnitude of the neural current. This means that MEG has excellent temporal resolution. However, its spatial specificity (<italic>defined here as the ability to extract accurate temporal estimates of electrical activity from spatially separate sources in the brain</italic>) is limited due to the inverse problem which can be stated: <italic>given a measured magnetic field distribution outside the head, can we reconstruct spatially the neuronal current distribution in the brain</italic>? This problem is ill-posed (<xref rid="bb0055" ref-type="bibr">Hadamard, 1952</xref>) since, due to field cancellation, a single measured field could result from an infinite number of possible current distributions, meaning that no unique inverse solution exists. However, in recent years the spatial specificity of MEG has been improved by the introduction of beamformer techniques (<xref rid="bb0115 bb0120 bb0090 bb0050 bb0100 bb0110" ref-type="bibr">Van Drongelen et al., 1996; Van Veen et al., 1997; Robinson and Vrba, 1998; Gross et al., 2001; Sekihara et al., 2001, 2002b</xref>).</p>
      <p>Beamforming is a spatial filtering approach based on a weighted sum of field measurements (<xref rid="bb0115 bb0120 bb0090 bb0050 bb0100 bb0110 bb0085 bb0025" ref-type="bibr">Van Drongelen et al., 1996; Van Veen et al., 1997; Robinson and Vrba, 1998; Gross et al., 2001, Sekihara et al., 2001, 2002b; Robinson, 2004; Cheyne et al., 2006</xref>). Each measured field is multiplied by a weighting factor, and the weighted sum of sensor measurements gives an estimate of source amplitude at a predetermined location in the brain. Unlike other localisation metrics, weighting parameters are data driven and derived based on power minimisation: the average power emanating from the source space (i.e. the head) within a given time frequency window (the <italic>covariance window</italic>) is minimised, but with a constraint that power originating from our predetermined location must remain in the output signal. The result is a set of weighting parameters tuned specifically to a single location. Sequential application of this calculation to a number of locations can result in a volumetric image of source power. Task related change in activity can be imaged either by contrasting power estimates made using separate active and control covariance windows, or by parsing the beamformer projected time series into active and control segments using beamformer coefficients derived from a single covariance window. When processed in this way the spatial specificity of MEG is dependant on the spatial specificity of the weighting parameters. This in turn depends on the signal to noise ratio (SNR) of the data, the duration of the covariance window (<italic>T</italic><sub>cov</sub>), the signal bandwidth (BW), and matrix regularisation (<xref rid="bb0020" ref-type="bibr">Brookes et al., 2008</xref>). Some of these factors can be controlled by experimental design, i.e. <italic>T</italic><sub>cov</sub>. Other factors, i.e. BW, SNR etc. depend on the effect of interest.</p>
      <p>Neuromagnetic effects fall generally into two groups (<xref rid="bb0080" ref-type="bibr">Pfurtscheller and Lopes da Silva, 1999</xref>). <italic>Non-phase-locked induced effects</italic> comprise stimulus related changes in spontaneous rhythms. Due to their non-phase-locked nature they are eliminated by trial averaging. <italic>Phase-locked effects</italic> comprise evoked responses and driven oscillations. In both cases the onset phase of the neuromagnetic signal is equivalent for each stimulus presentation meaning that the effect remains visible after averaging. Beamformers are well suited to imaging induced responses. This is because induced power changes can last for several seconds and, in some cases, their duration can be controlled by experimental design. The covariance window is constructed by concatenating data from multiple trials and if the effect of interest remains observable and stationary for an extended period within each trial, the concatenated covariance window is large. Beamformers are sensitive to covariance window duration and the extended period helps to achieve an accurate spatial reconstruction. Averaging phase-locked effects across trials allows a larger SNR than that of induced effects, which potentially could improve spatial specificity of beamformer weights. However, averaging (rather than concatenating) data from individual trials reduces the covariance window. In addition, the reduction in random noise achieved by averaging can cause covariance matrices to become singular or ill-conditioned meaning that matrix regularisation has to be introduced. These effects make imaging averaged phase-locked responses difficult. SAMerf (<xref rid="bb0085" ref-type="bibr">Robinson, 2004</xref>) and erSAM (<xref rid="bb0025 bb0030" ref-type="bibr">Cheyne et al., 2006, 2007</xref>) are beamformer techniques that have been used to image evoked responses. In both cases, weighting parameters are derived based on unaveraged data. This is sensible since <italic>T</italic><sub>cov</sub> is made large, however, one could argue that the weights are not tuned optimally to the effect of interest and spatial specificity is not optimal.</p>
      <p>In this paper we aim to combine known theory, simulation and experiment in order to investigate the improved spatial specificity that may be afforded by the increase in SNR observed when sensor level MEG data are averaged. Initially, a simple model is considered comprising a dipolar source and Gaussian noise. Previously published theory (<xref rid="bb0020" ref-type="bibr">Brookes et al., 2008</xref>) is used to show that the accuracy of a data derived covariance matrix is affected by trial averaging. The effect of averaging on matrix condition number and techniques for matrix regularisation are also considered. This simulation is extended to a 2-source simulation employing measured MEG noise. We show that in most cases, averaging across trials will not significantly change results. However, if two phase-locked sources are in close proximity, averaging across trials can improve spatial specificity.</p>
      <p>Our simulated results are extended to a retinotopic mapping experiment. A smoothly rotating and flashing wedge visual stimulus is employed to induce driven, phase-locked oscillations within visual cortex. It is well known that the visual field is mapped retinotopically onto the visual cortex, meaning that as the wedge moves, cortical pyramidal cells at different locations are activated sequentially. This gives the impression of a moving electrical source in the brain. Tracking the retinotopic motion of such a source has been done previously (<xref rid="bb0040 bb0005 bb0045 bb0140 bb0060" ref-type="bibr">Engel et al., 1994; Aine et al., 1996; Gramfort et al., 2007; Yoshioka et al., 2008; Hagler et al., 2009</xref>); however it remains challenging in MEG due to the non-stationary nature of the source, and the complex geometry of the visual cortex. We present results showing that this moving source, induced by the retinotopic stimulus, can be tracked using MEG beamformer methodology. A sliding covariance window technique, similar to that introduced by <xref rid="bb0035" ref-type="bibr">Dalal et al. (2008)</xref>, is used to extract timecourse estimates showing the sequential activation of regions in visual cortex. We show that these results are only possible if data averaging is employed. The excellent spatiotemporal resolution of MEG is highlighted, and we propose that the retinotopy paradigm be used as a future measure of spatial specificity.</p>
    </sec>
    <sec id="s0010">
      <title>Theory and simulation</title>
      <sec id="s0015">
        <title>Notation</title>
        <p>Using a beamformer, electrical source amplitude, <italic>Q̂<sub><bold>θ</bold></sub></italic>(<italic>t</italic>) at a predetermined location in source space is estimated using a weighted sum of the field measurements such that:<disp-formula id="fo0005"><label>(1)</label><mml:math id="M1" altimg="si4.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="bold">θ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><bold><italic>m</italic></bold>(<italic>t</italic>) is a vector of magnetic field measurements made at <italic>M</italic> MEG sensors at time <italic>t</italic>. <bold><italic>W</italic></bold><sub><bold><italic>θ</italic></bold></sub> is a vector of weighting parameters that are tuned to the location and orientation represented by <bold><italic>θ</italic></bold>. Using a spherical head model, since MEG is insensitive to radial dipoles, source orientation can be represented by a vector in a plane tangential to the radial direction so that <bold><italic>θ</italic></bold> = [<bold><italic>r</italic></bold>,<italic>δ</italic>], where <bold><italic>r</italic></bold> represents location, and <italic>δ</italic> is the angle of the source with respect to the azimuthal direction. Note that using a multi sphere model (<xref rid="bb0070" ref-type="bibr">Huang et al., 1999</xref>), the tangential plane is derived with respect to the average sphere. To derive <bold><italic>W</italic></bold><sub><bold><italic>θ</italic></bold></sub>, the overall power in the estimated signal, <inline-formula><mml:math id="M2" altimg="si5.gif" overflow="scroll"><mml:mrow><mml:mi>ɛ</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="bold">θ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, computed over covariance window, <italic>T</italic><sub>cov</sub>, is minimised but with the constraint that power originating from a source with location and orientation (<bold><italic>θ</italic></bold>) must remain in the output signal. Mathematically this can be written.<disp-formula id="fo0010"><label>(2)</label><mml:math id="M3" altimg="si6.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold">θ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>ɛ</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="bold">θ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mtext> subject to </mml:mtext><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mi mathvariant="bold">θ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula>where <bold><italic>L</italic></bold><sub><bold><italic>θ</italic></bold></sub> represents the lead fields. The estimated power at <bold><italic>θ</italic></bold> can be represented by <inline-formula><mml:math id="M4" altimg="si7.gif" overflow="scroll"><mml:mrow><mml:mi>ɛ</mml:mi><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="bold">θ</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold">θ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <bold>C</bold> represents the <italic>M</italic> × <italic>M</italic> data covariance matrix. The solution to Eq. (<xref rid="fo0010" ref-type="disp-formula">2</xref>) is (<xref rid="bb0120" ref-type="bibr">Van Veen et al., 1997</xref>):<disp-formula id="fo0015"><label>(3)</label><mml:math id="M5" altimg="si8.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">θ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula></p>
        <p>Eq. (<xref rid="fo0015" ref-type="disp-formula">3</xref>) is well known and shows clearly that the beamformer weighting parameters are dependent on an accurate measurement of data covariance. For all computations in this paper the scalar beamformer is employed. In this formulation the angle <italic>δ</italic> is found independently at each <italic>r</italic> using a non-linear search to compute the orientation of maximal variance (<xref rid="bb0090" ref-type="bibr">Robinson and Vrba, 1998</xref>).</p>
      </sec>
      <sec id="s0020">
        <title>Analytical insights</title>
        <p>Our previous work (<xref rid="bb0020" ref-type="bibr">Brookes et al., 2008</xref>) has investigated what parameters affect the accuracy of the covariance matrix. The covariance matrix error, Δ<bold>C</bold>, is defined as the difference between the measured covariance matrix, <bold>C</bold>, and a perfectly calculated covariance matrix, denoted by <bold>C</bold><sub>0</sub>. Generally we can write:<disp-formula id="fo0020"><label>(4)</label><alternatives><textual-form specific-use="jats-markup">Δ<bold>C</bold> = <bold>C</bold>−<bold>C</bold><sub>0</sub>.</textual-form><mml:math id="M6" altimg="si9.gif" overflow="scroll"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mtext>.</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>Using a model incorporating a single dipolar source (amplitude <italic>Q</italic><sub>1</sub> and lead field pattern <bold><italic>B</italic></bold><sub>1</sub>) and Gaussian noise uncorrelated across sensors (variance <italic>ν</italic><sup>2</sup>) the perfectly constructed covariance matrix is given by<disp-formula id="fo0025"><label>(5)</label><mml:math id="M7" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></disp-formula>and the Frobenius norm of the covariance matrix error can be shown to be:<disp-formula id="fo0030"><label>(6)</label><mml:math id="M8" altimg="si11.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>M</mml:mi><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>SNR</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="normal">cov</mml:mi></mml:mrow></mml:msub><mml:mi>B</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula><italic>SNR</italic> represents the signal to noise ratio of the source of interest and is given by:<disp-formula id="fo0035"><label>(7)</label><mml:math id="M9" altimg="si12.gif" overflow="scroll"><mml:mrow><mml:mi>SNR</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>‖</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula></p>
        <p>The quantity <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M10" altimg="si13.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is a measure of the total error in the covariance matrix, and previous simulations have shown that if this quantity is large, the accuracy of the beamformer estimated source power will be degraded severely (<xref rid="bb0020" ref-type="bibr">Brookes et al., 2008</xref>).</p>
        <p>It is possible to use Eq. (<xref rid="fo0030" ref-type="disp-formula">6</xref>) to provide insight into the effect of data averaging on the accuracy of the covariance matrix. We know that by increasing the number of averages the random noise variance, <italic>ν</italic><sup>2</sup>, will be reduced such that <italic>ν</italic><sup>2</sup> → <italic>ν</italic><sup>2</sup> / <italic>N</italic><sub>ave</sub> where <italic>N</italic><sub>ave</sub> is the total number of trials averaged. In addition, the covariance window duration will also be reduced such that <italic>T</italic><sub>cov</sub> → <italic>T</italic><sub>cov</sub> / <italic>N</italic><sub>ave</sub>. By considering again Eq. (<xref rid="fo0030" ref-type="disp-formula">6</xref>) it is simple to show that the Frobenius norm of the covariance matrix error becomes:<disp-formula id="fo0040"><label>(8)</label><mml:math id="M11" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>M</mml:mi><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>ave</mml:mtext></mml:mrow></mml:msub><mml:mi>SNR</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>ave</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="normal">cov</mml:mi></mml:mrow></mml:msub><mml:mi>B</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula>Plotting <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M12" altimg="si15.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as a function of <italic>N</italic><sub><italic>ave</italic></sub> (see <xref rid="f0005" ref-type="fig">Fig. 1</xref>A, solid green line) shows that averaging across trials causes a slight reduction in <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M13" altimg="si16.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as the number of averages is increased.</p>
      </sec>
      <sec id="s0025">
        <title>Single source simulation</title>
        <p>As evidenced by Eq. <xref rid="fo0015" ref-type="disp-formula">(3)</xref>, the accuracy of beamformer weights is dependent not on the covariance matrix, but the inverse of the covariance matrix. This means that not only must the covariance estimate be accurate (i.e. <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M14" altimg="si17.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> should be small) but also that the inverse covariance matrix be accurate. With this in mind it becomes useful to introduce the inverse covariance matrix error, Δ<bold>C</bold><sub>inv</sub>.<disp-formula id="fo0045"><label>(9)</label><mml:math id="M15" altimg="si18.gif" overflow="scroll"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>inv</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula>where <bold>C</bold><sub>0</sub><sup>− 1</sup> is the exact covariance matrix inverse assuming an infinite number of samples, and <bold>C</bold><sup>− 1</sup> is the data derived covariance matrix inverse. Using the matrix inversion lemma and assuming an infinite amount of data, we can show that<disp-formula id="fo0050"><label>(10)</label><mml:math id="M16" altimg="si19.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula></p>
        <p>In this mathematical formulation, it is possible to measure the accuracy of the inverse covariance matrix by computing the Frobenius norm of the inverse covariance matrix error, <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold><sub>inv</sub>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M17" altimg="si20.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>inv</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        <p>The effect of data averaging on <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold>‖<sub><italic>F</italic></sub> and ‖Δ<bold>C</bold><sub>inv</sub>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M18" altimg="si21.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mtext> and </mml:mtext><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>inv</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> was investigated in simulation. All simulations were based on the third order gradiometer configuration of a 275 channel CTF MEG system (<xref rid="bb0135 bb0125 bb0130" ref-type="bibr">Vrba et al., 1991; Vrba and Robinson, 2001, 2002</xref>). The location of the head with respect to the sensor array was based on an experimental recording session and a multi sphere head model (<xref rid="bb0070" ref-type="bibr">Huang et al., 1999</xref>) was used. A single dipolar source was simulated in the occipital cortex, and oriented perpendicular to the radial direction, <italic>δ</italic> = 25°. The forward solution, <bold><italic>B</italic></bold><sub><italic>Q</italic></sub><sub>1</sub>, was based on the derivation by <xref rid="bb0095" ref-type="bibr">Sarvas (1987)</xref>. A single simulated trial comprised 0.5 s of activity (ON) followed by 0.5 s rest (OFF). The source was given as a root mean square (r.m.s.) source strength of <italic>Q</italic><sub>1</sub> = 5 nAm and the source timecourse during the ON period was represented by a series of Gaussian random numbers. A total of 100 trials were simulated, and the timecourse for each trial was identical to imitate a phase-locked evoked signal. Gaussian noise data were added at the sensor level with r.m.s. amplitude <italic>v</italic> = 86.6 fT. The sampling frequency was set to 600 Hz, and the flat frequency spectrum of both the signal and noise meant that the total bandwidth was at the Nyquist limit.</p>
        <p>The effect of data averaging was assessed by grouping and averaging trials. For completely averaged data, 100 groups, each comprising a single trial were taken and averaged. Alternative examples include, 50 groups each comprising 2 trials, or 25 groups each comprising 4 trials. In some cases the total number of trials used did not equal 100, for example 33 groups of 3 trials was used. However, in all cases the total number of trials was as close to 100 as possible. For completely unaveraged data, a single group comprising 100 trials was used. In all cases the number of averages used, <italic>N</italic><sub>ave</sub>, was equal to the total number of groups, and this took values of 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 20, 25, 33, 50 and 100.</p>
        <p>For each value of <italic>N</italic><sub>ave</sub>, four covariance matrices were constructed: <bold>C</bold><sub>act</sub> was created using only data recorded during the ON period. <bold>C</bold><sub>pass</sub> was created using data recorded during the OFF period. <inline-formula><mml:math id="M19" altimg="si22.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>act</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>pass</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> and represents the mean covariance of the ON and OFF periods. A regularised version of <bold>C</bold><sub><italic>m</italic></sub> was also constructed, denoted by <bold>C</bold><sub><italic>m</italic></sub><sup>(reg)</sup>. The strategy for regularisation is described in <xref rid="s0060" ref-type="sec">Appendix I</xref> and is summarised by the equation:<disp-formula id="fo0055"><label>(11)</label><mml:math id="M20" altimg="si23.gif" overflow="scroll"><mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtext>reg</mml:mtext><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mtext>unav</mml:mtext></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></disp-formula>where <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>s</italic><sub><bold>C</bold><sub><italic>m</italic></sub></sub></textual-form><mml:math id="M21" altimg="si24.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the minimum singular value of <bold>C</bold><sub><italic>m</italic></sub> and <italic>s</italic><sup>unav</sup> is the minimum singular value of <bold>C</bold><sup>(unav)</sup> which is a covariance matrix constructed using the entire 100 trial unaveraged dataset (including the ON and OFF periods). Here, <italic>μ</italic> represents a parameter used to regularise the unaveraged covariance matrix, <bold>C</bold><sup>(unav)</sup>.</p>
        <p>Regularisation is known to reduce spatial specificity and so for the purposes of all computations in this paper, <italic>μ</italic> was set to zero. Using Eq. (<xref rid="fo0025" ref-type="disp-formula">5</xref>), a theoretical version of <bold>C</bold><sub><italic>m</italic></sub> was constructed as <inline-formula><mml:math id="M22" altimg="si25.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> where the <inline-formula><mml:math id="M23" altimg="si26.gif" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> term accounts for the fact that this equation represents mean covariance in the ON and OFF periods. The inverse of <bold>C</bold><sub><italic>m</italic></sub><sub>0</sub> was also derived using Eq. <xref rid="fo0055" ref-type="disp-formula">10</xref>.</p>
        <p>The differences between the analytical and data derived covariance matrices were assessed. The Frobenius norm of the covariance matrix error and inverse covariance matrix error were plotted as a function of the number of averages. Beamformer weights were constructed using the regularised covariance <inline-formula><mml:math id="M24" altimg="si27.gif" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mi mathvariant="bold">θ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and used to plot reconstructed power, calculated at the known source location, for the ON (<italic>P</italic><sub>ON</sub> = <bold><italic>W</italic></bold><italic><bold><sub>θ</sub></bold><sup>T</sup></italic><bold>C</bold><sub>act</sub><bold><italic>W</italic></bold><sub><bold><italic>θ</italic></bold></sub>) and OFF (<italic>P</italic><sub>OFF</sub> = <bold><italic>W</italic></bold><italic><bold><sub>θ</sub></bold><sup>T</sup></italic><bold>C</bold><sub>pass</sub><bold><italic>W</italic></bold><sub><bold><italic>θ</italic></bold></sub>) periods as a function of <italic>N</italic><sub>ave</sub>. Finally, 1-dimensional images were created showing the spatial distribution of the pseudo-T-statistic across the source. The pseudo-T-statistic, <italic>T</italic>, is given by (<xref rid="bb0125" ref-type="bibr">Vrba and Robinson, 2001</xref>):<disp-formula id="fo0060"><label>(12)</label><graphic xlink:href="fx1"/></disp-formula>where <italic>N</italic><sub>ON</sub> and <italic>N</italic><sub>OFF</sub> represent the beamformer projected noise estimates in the ON and OFF periods respectively. The whole simulation was repeated 10 times and standard deviation between repeats plotted where appropriate. Note that in all cases, the number of data samples used to create covariance matrices was greater than the number of MEG channels. Note also that in all cases, the accuracy of the non-linear search for <italic>δ</italic> was assessed.</p>
        <p>The results of the simulation are shown in <xref rid="f0005" ref-type="fig">Fig. 1</xref>. <xref rid="f0005" ref-type="fig">Fig. 1</xref>A shows <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M25" altimg="si29.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as a function of <italic>N</italic><sub>ave</sub>. The solid line shows the theoretical relationship (Eq. (<xref rid="fo0030" ref-type="disp-formula">6</xref>)) and the data points show the simulated values. The graph shows a modest improvement in the accuracy of the covariance matrix with averaging; furthermore, the theoretical relation agrees well with simulated data. <xref rid="f0005" ref-type="fig">Fig. 1</xref>B shows <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold><sub>inv</sub>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M26" altimg="si30.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>inv</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as a function of <italic>N</italic><sub>ave</sub> for the unregularised case. As shown, without matrix regularisation, the accuracy of <bold>C</bold><sub><italic>m</italic></sub><sup>− 1</sup> declines with data averaging. This is a result of a decrease in rank of the covariance matrix. As the number of averages is increased, the noise level decreases, this causes a corresponding drop in the smallest singular value of <bold>C</bold><sub><italic>m</italic></sub>, which, in turn, causes an increase in condition number. As <bold>C</bold><sub><italic>m</italic></sub> becomes ill-conditioned, the accuracy of <bold>C</bold><sub><italic>m</italic></sub><sup>−1 </sup> is degraded. <xref rid="f0005" ref-type="fig">Fig. 1</xref>C shows <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold><sub>inv</sub>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M27" altimg="si31.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>inv</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> versus <italic>N</italic><sub>ave</sub> for the regularised case. Here the condition number of <bold>C</bold><sub><italic>m</italic></sub><sup>(reg)</sup> is maintained approximately constant (see <xref rid="s0060" ref-type="sec">Appendix I</xref>) by the regularisation strategy outlined by Eq. (<xref rid="fo0060" ref-type="disp-formula">11</xref>). The result is that the accuracy of the inverse regularised covariance matrix is no longer degraded by data averaging. However, adding to the leading diagonal of the covariance matrix is equivalent to adding Gaussian noise to the simulation. This means that noise eliminated by data averaging has effectively been added back into the covariance matrix by matrix regularisation. <xref rid="f0005" ref-type="fig">Fig. 1</xref>D shows the beamformer projected power for the ON (blue) and OFF (green) periods as a function of the number of averages. Notice here that in all cases the active and control power estimates are approximately correct and are relatively insensitive to data averaging. This result is echoed in <xref rid="f0005" ref-type="fig">Fig. 1</xref>E which shows 1-dimensional pseudo-T-statistical images. (The simulated source is located at y = 1 cm) Like projected power, the beamformer image shows no dependency on whether or not the simulated data were averaged across trials. This lack of improvement is a result of regularisation and the fact that noise reduction through averaging is countered by the regularisation procedure. Unfortunately, as evidenced by <xref rid="f0005" ref-type="fig">Fig. 1</xref>B, regularisation is necessary to maintain the condition number. The overall conclusion is that in the limits of the single source and Gaussian noise model, averaging affords no benefit to beamformer reconstruction.</p>
      </sec>
      <sec id="s0030">
        <title>Two source simulations</title>
        <p>The above simulation was extended to incorporate a second source. Sources were located 1 cm apart in the occipital cortex, with parallel orientations in the tangential plane <italic>δ</italic> = 25°. A multi sphere head model was used and the location of the head with respect to the sensor array was based on an experimental recording session. The forward solutions were based on the derivation by Sarvas. For source 1, a single simulated trial comprised 0.5 s of activity followed by 0.5 s rest. For source 2, a single trial comprised 0.5 s of rest followed by 0.5 s of activity. This gave the impression that the two sources were activated sequentially. Source 1 was given r.m.s. amplitude 5 nAm. The r.m.s. amplitude of source 2 was set to either 5 nAm or 10 nAm. As for our single source simulation, activity comprised a timecourse of Gaussian random numbers. On each iteration of the simulation, 100 trials were simulated, and source timecourses were phase-locked. The simulation was repeated 10 times.</p>
        <p>Two strategies for adding sensor noise were employed:<list list-type="simple"><list-item><label>1.</label><p>Gaussian noise data were added, equivalent to the single source simulation, with r.m.s. amplitude <italic>υ</italic> = 86.6 fT.</p></list-item><list-item><label>2.</label><p>Experimental noise data were recorded from a single healthy volunteer.</p></list-item></list></p>
        <p>To record experimental noise, a subject was asked to lie in the MEG system with their eyes open and 1000 s of resting state MEG data was recorded using the third order gradiometer configuration of a 275 channel CTF MEG system with a sampling rate of 600 Hz. (Note that 1000 s were recorded to allow 10 separate noise measurements, each 100 s in duration.) During data acquisition the location of the subject's head within the scanner was measured by energising 3 electromagnetic coils placed at three fiducial points on the head (nasion, left preauricular and right preauricular). Following data acquisition, the positions of these three coils were measured relative to the subject's head shape using a 3D digitiser (<italic>Polhemus isotrack</italic>). An MPRAGE structural MR brain image was acquired using a Philips Achieva 7 T MR system. (1 mm<sup>3</sup> isotropic resolution, 256 × 256 × 160 matrix size, TR = 8.1 ms, TE = 3.7 ms, TI = 960 ms, shot interval = 3s, FA = 8° and SENSE factor = 2.) The locations of the three fiducial points, and the MEG sensors with respect to the brain anatomy was then determined by surface matching the digitised head surface to the head surface extracted from the MR image. These measured ‘brain noise’ data were then added to the simulated measurements from the two dipoles in the visual cortex.</p>
        <p>As previously, data were grouped so that the effect of trial averaging could be assessed. For each value of <italic>N</italic><sub>ave</sub>, four covariance matrices were constructed: <bold>C</bold><sub>act</sub> was created using data recorded during the ON period of source 1 (i.e. the first 0.5 s of each trial). <bold>C</bold><sub>pass</sub> was created using data recorded during the OFF period of source 1 (i.e. 0.5 s &lt; <italic>t</italic> &lt; 1 s). A mean covariance, <bold>C</bold><sub><italic>m</italic></sub>, of the whole trial was also calculated as previously, and this contained information on both source 1 and source 2. A regularised version of <bold>C</bold><sub><italic>m</italic></sub> was also constructed using the regularisation strategy summarised by Eq.<xref rid="fo0060" ref-type="disp-formula">(11)</xref>. Beamformer weighting parameters were derived using the mean regularised covariance and a lead field tuned to the location of source 1. This meant that for the purposes of this simulation, source 1 could be thought of as the source of interest whereas source two was thought of as interference. For each value of <italic>N</italic><sub>ave</sub> the beamformer estimated source power, and source timecourse were computed at the location of source 1. Source power estimates for the ON and OFF periods were plotted as a function of <italic>N</italic><sub>ave</sub>. To test the accuracy of the timecourse estimate, the correlation between the beamformer estimated timecourse and the original simulated timecourses of both sources 1 and 2 was calculated and plotted as a function of <italic>N</italic><sub>ave</sub>. Finally, the spatial distribution of the pseudo-T-statistic was plotted.</p>
        <p>All of the above was done for both Gaussian and experimental noise and for all computations the accuracy of the estimated <italic>δ</italic> was noted.</p>
        <p><xref rid="f0010" ref-type="fig">Fig. 2</xref> shows results of the two source simulation with Gaussian noise. <xref rid="f0010" ref-type="fig">Fig. 2</xref>A shows the beamformer reconstructed power in the ON (blue) and OFF (green) periods reconstructed at the location of source 1. Results are plotted against <italic>N</italic><sub>ave</sub>. If the beamformer were completely suppressing source 2, then the green line should remain at zero, and the blue line should remain at 25 nAm<sup>2</sup>. The plot therefore shows some improvement with source 2 being better suppressed as the total number of averages is increased. This result is echoed in the timecourse correlation shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>B. Here, the blue data points show the Pearson correlation coefficient between the beamformer timecourse estimate made at the location of source 1, and the original simulated timecourse for source 1. The green data points show the Pearson correlation coefficient between the beamformer timecourse estimate made at the location of source 1, and the original simulated timecourse for source 2. Ideally the blue line should tend towards 1 whereas the green line should tend towards zero. Again a modest improvement is observed with data averaging. <xref rid="f0005" ref-type="fig">Fig. 1</xref>C shows a one-dimensional beamformer image. Note that the image is constructed using Eq. <xref rid="fo0065" ref-type="disp-formula">(12)</xref> where <italic>P</italic><sub>ON</sub> is calculated for the first 0.5 s of each trial and <italic>P</italic><sub>OFF</sub> is calculated for the last 0.5 s of each trial. Since source 2 is active during the final 0.5 s of each trial, the pseudo-T-stat at the location of source 2 (<italic>y</italic> = 0) is negative.</p>
        <p><xref rid="f0015" ref-type="fig">Fig. 3</xref> shows results of the two source simulation with experimentally recorded noise. A striking difference is observed in terms of the effect of data averaging in the Gaussian noise case, and the experimental noise case. <xref rid="f0015" ref-type="fig">Fig. 3</xref>A shows the power in the ON (blue) and OFF (green) periods reconstructed at the true location of source 1. Notice that with no averaging, the power leaking into source 1 is so great that the power estimates in the ON and OFF periods cannot be distinguished. As the level of averaging is increased, the beamformer weights become more spatially specific and are better able to cancel out interference. The timecourse correlation plots shown in <xref rid="f0015" ref-type="fig">Fig. 3</xref>B support this argument. Using unaveraged data results in a timecourse estimate with equivalent correlation to both source 1 and source 2. In other words, both sources are indistinguishable. Conversely, with averaged data the timecourse better estimates that of source 1 and correlation with source 2 is low. <xref rid="f0015" ref-type="fig">Fig. 3</xref>C shows one-dimensional images equivalent to those in <xref rid="f0010" ref-type="fig">Fig. 2</xref>C. Again the advantage of data averaging becomes apparent. The pseudo-T-statistic is based on power difference between the ON and OFF periods, since using unaveraged data the power estimates in these two temporal windows are indistinguishable, no peak occurs in the pseudo-T-statistical image.</p>
        <p>As stated above the scalar beamformer involves a search for the optimum azimuthal angle, <italic>δ</italic>, in the tangential plane. Here, using Gaussian noise, for all values of <italic>N</italic><sub>ave</sub>, this angle search produced a correct result (<italic>δ</italic> = 25 ± 1°). When using real brain noise, the higher signal to noise afforded by data averaging yielded slightly better estimation of <italic>δ</italic> for averaged (<italic>δ</italic> = 25 ± 5°) compared to unaveraged (<italic>δ</italic> = 29 ± 6°) data. This effect was however not thought be a direct cause of the differences between noise models.</p>
        <p>The difference between the Gaussian and experimentally recorded noise models can be understood if one considers the dominant noise sources in both cases, and how the beamformer distributes spatial degrees of freedom. In the case of experimentally recorded brain noise, a large number of resting state neural generators will be active leading to a large number of brain sources distributed widely across the cortex. These sources create spatially correlated signals at the channel level and must be rejected by the beamformer. Conversely, Gaussian noise is uncorrelated across channels and does not emulate brain sources. None of the resting state neural mechanisms, measured in experimental data, will be time locked to the trial onset. Averaging will therefore suppress such effects, and the beamformer must try to reject interference from fewer sources in averaged compared to unaveraged data. Previous work (<xref rid="bb0010" ref-type="bibr">Barnes and Hillebrand, 2003</xref>) has shown that the beamformer optimally distributes spatial degrees of freedom such that variations in weighting parameters are greatest close to areas of maximal activation. In other words, the greatest spatial resolution is available close to brain sources. Using averaged data the beamformer can concentrate more spatial degrees of freedom on the suppression of source 2 than it can in unaveraged experimental data. This redistribution of the degrees of freedom acts to increase the spatial specificity of the weights, leading to a more accurate estimate of source dynamics. In the Gaussian noise model, only two sources were simulated. Both were active in averaged and unaveraged data so we assume the degrees of freedom were distributed equally in both cases.</p>
      </sec>
    </sec>
    <sec id="s0035">
      <title>Retinotopic mapping experiment</title>
      <p>Insights from simulation were employed in an experiment designed to investigate spatial specificity of MEG and the beamformer formulation. To do this, the well known retinotopic organisation of the visual cortex was exploited. As an object moves in the visual field, cortical cells at different locations in the visual cortex are activated sequentially, giving the impression of a moving electrical source. The dynamic nature of such a source makes source localisation challenging. In addition the extraction of a timecourse estimate from a single retinotopic location is difficult because signals generated from neighbouring retinotopic sources act as interference. This experiment is therefore similar to our two source simulation in which multiple cortical locations are sequentially activated and the challenge is to reject interference from sources other than that at the location of interest. Four healthy subjects took part in the study, which was approved by the University of Nottingham Medical School ethics committee.</p>
      <sec id="s0040">
        <title>Experimental method</title>
        <p>The visual stimulus (implemented in PsychoPy (<xref rid="bb0075" ref-type="bibr">Peirce, 2007</xref>) <ext-link ext-link-type="uri" xlink:href="http://www.psychopy.org">www.psychopy.org</ext-link>) comprised a 45° wedge, rotating smoothly around the visual field. The wedge contained a black and white radial checkerboard pattern alternating at a frequency of 10 Hz and extending by a total of 6° from central fixation. (Each element of the checkerboard subtended an azimuthal angle of 15° and extended 2° radially from fixation.) This wedge was presented on a medium grey background. A single trial comprised one full rotation (25 s) followed by 5 s rest and in total 30 trials were presented. MEG data were again recorded using a 275 channel CTF MEG system in third order gradiometer configuration at a sampling rate of 600 Hz. As previously the location of the subject's head was measured by energising and localising 3 fiducial coils inside the scanner. Coil locations were then digitised along with the subject's head shape (<italic>Polhemus isotrack</italic>) and this was fitted to the head surface extracted from 7 T anatomical MR images (parameters as above) in order to gain the locations of the MEG sensors with respect to the brain anatomy.</p>
        <p>The 10 Hz flashing checkerboard was expected to drive a 20 Hz phase-locked response in the visual cortex. All MEG data were therefore bandpass frequency filtered between 18 Hz and 22 Hz. They were then processed using beamformer techniques applied using Matlab.</p>
        <p>To spatially localise retinotopic locations, Ŧ-statistical images were created by comparison of 18–22 Hz power in active and control time windows. The duration of these time windows was optimised to ensure that enough data was included to obtain a reasonable covariance estimate (see <xref rid="s0065" ref-type="sec">Appendix II</xref>). This resulted in a covariance duration <italic>T</italic><sub>cov</sub> = 5 s for both the active and control windows. The active time window was allowed to shift in time, and 25 separate pseudo-T-statistical images were constructed using 25 temporally shifted overlapping active windows. These windows were centred at 1 s intervals between 0 and 24 s. For active windows close to the beginning or end of stimulation, the window was allowed to wrap to obtain the required 5s of data. So for example, if a window was centred at <italic>t</italic> = 1 s, data in the range 23.5 s ≤ <italic>t</italic> ≤ 25 s and data in the range 0 s ≤ <italic>t</italic> ≤ 3.5 would be concatenated. For all 25 pseudo-T-statistical images the control time window was taken as the 5 s of rest at the end of each trial, and thus did not overlap with any portion of the active window. In the first case, covariance estimates for the active and control time windows were constructed based on data that was averaged across trials. In the second case, data were left unaveraged and active and control data segments concatenated prior to covariance calculation. In the case of averaged data, resulting covariance matrices were regularised according to the strategy outlined in Eq. <xref rid="fo0060" ref-type="disp-formula">(11)</xref>. The parameter <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>s</italic><sub><bold>C</bold><sub><italic>m</italic></sub></sub></textual-form><mml:math id="M28" altimg="si32.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> was taken as the minimum singular value of the covariance matrix derived from averaged data in the active and control window. The parameter <italic>s</italic><sup>unav</sup> was defined as the minimum singular value of a covariance matrix constructed from the unaveraged, frequency filtered dataset (i.e. using all 30 s of all 30 trials).</p>
        <p>Timecourse estimates were made for 5 locations of interest in the visual cortex derived from 5 of the pseudo-T-statistical images described above. These images showed activation in 5 s windows centred at <italic>t</italic> = 2.5 s, 7.5 s, 12.5 s, 17.5 s, and 22.5 s. In all cases two timecourse estimates were made using averaged and unaveraged data. For both, a sliding covariance window technique, similar to that described by <xref rid="bb0035" ref-type="bibr">Dalal et al. (2008)</xref> was employed. The aim of the sliding window technique was to optimise the spatial specificity of the beamformer weights calculation. The covariance window duration, <italic>T</italic><sub>cov</sub>, was set to its minimum possible value of 5 s. A total of 25 separate covariance windows were used, windows being centred at 1 s intervals between 0.5 s and 24.5 s. The timecourse estimate for the central second within each window was constructed as per Eq. <xref rid="fo0005" ref-type="disp-formula">(1)</xref>.<list list-type="simple"><list-item><label>•</label><p>For example: the timecourse estimate for the period (5 s ≤ <italic>t</italic> &lt; 6 s) was given by the equation <italic>Q̂</italic><sub><bold>θ</bold></sub> (5 s ≤ <italic>t</italic> &lt; 6 s) = <bold><italic>W</italic></bold>(3 s ≤ <italic>t</italic> &lt; 8 s)<sub><bold>θ</bold></sub><sup>T</sup> <bold><italic>m</italic></bold>(5 s ≤ <italic>t</italic> &lt; 6 s), where the weights vector <bold><italic>W</italic></bold>(3 s ≤ <italic>t</italic> &lt; 8 s)<sub><bold>θ</bold></sub> represents the beamformer weights at location and orientation <bold><italic>θ</italic></bold> constructed using an average covariance matrix derived from matrices constructed using data in the 3 s ≤ <italic>t</italic> &lt; 8 s window, and data in the control window.</p></list-item></list></p>
        <p>Basing covariance windows on reduced time windows helps to sensitise the weights and ‘focus’ the degrees of freedom on sources active only during this limited period, and not the full 30 s trial length. Reducing <italic>T</italic><sub>cov</sub> further would, in principle further improve spatial specificity. However, as shown in <xref rid="s0065" ref-type="sec">Appendix II</xref> this may reduce accuracy. Following computation, all covariance matrices were regularised according to Eq. <xref rid="fo0060" ref-type="disp-formula">(11)</xref>. Final timecourse estimates were Hilbert transformed, and the absolute value of the analytic signal computed in order to yield the envelope of oscillatory activity in the 18–22 Hz frequency band.</p>
        <p>In order to assess the robustness of temporal effects across the group, timecourses from peak locations in individual subject functional images were derived from beamformer weights constructed using averaged and unaveraged data. These timecourses were median filtered (filter width 0.33 s), averaged across subjects and plotted with error bars showing standard deviation across subjects. Structural images were spatially transformed to a template brain using FLIRT in FSL (<ext-link ext-link-type="uri" xlink:href="http://www.fmrib.ox.ac.uk/fsl/flirt/index.html">http://www.fmrib.ox.ac.uk/fsl/flirt/index.html</ext-link>). This transform was applied to all functional images and the mean location of the peaks in pseudo-<italic>T</italic>-statistical images across the group was derived and marked on the template. It is well known that large inter-individual differences are observed in retinotopic maps and averaging maps across subjects may be misleading. These peak locations therefore only show a crude estimate of approximate brain locations from which timecourses are derived.</p>
        <p>In order to quantify the improvement in spatial specificity afforded by data averaging, a simple model of the expected sequential activation of the 5 retinotopic locations was constructed. The model comprised 5 timecourses, and in all cases activation was modelled as a 6.5 s long positive going lobe of a sinusoidal function with a period of 13 s. This function was centred on <italic>t</italic> = 2.5 s, 7.5 s, 12.5 s, 17.5 s, and 22.5 s resulting in 5 timecourses with sequential modulation. A Pearson correlation coefficient between the experimental timecourses (from individual subjects) and a model was computed, along with standard error across subjects.</p>
      </sec>
    </sec>
    <sec id="s0045">
      <title>Results</title>
      <p><xref rid="f0020" ref-type="fig">Fig. 4</xref> shows the results of the retinotopic mapping experiment for a single representative subject. The left hand column shows pseudo-<italic>T</italic>-statistical beamformer images depicting the retinotopic location of the source. The images shown were based on covariance estimated using averaged data and active windows were centred on 2.5 s, 7.5 s, 12.5 s, 17.5 s, and 22.5 s. The location of the stimulus in the visual field at these times is shown inset. The source location behaves as expected: it switches hemisphere as the stimulus moves from left to right in the visual field. It also moves below the calcarine fissure when the stimulus is in the upper half of the visual field, and above the calcarine fissure when the stimulus is in the lower visual field. This is consistent with the known organisation of the visual cortex and has previously been shown using fMRI. Interestingly, the peaks in pseudo-<italic>T</italic>-statistical images did not change by more than twice the voxel dimension when covariance was constructed using unaveraged data, indicating that averaging has little effect on localisation.</p>
      <p>The centre and right hand columns of <xref rid="f0020" ref-type="fig">Fig. 4</xref> show the time evolution of the envelope of 18–22 Hz power. These temporal estimates were reconstructed for locations at the peaks in the functional images. Timecourses in the centre column are reconstructed from beamformer weights based on averaged data. These show clearly the sequential activation of the different retinotopic locations within the cortex. The timecourse from each separate location shows an increase and decrease in oscillatory activity, which occurs as the moving retinotopic source passes that particular location.</p>
      <p>It should be pointed out that the temporal scale of the rise and fall of activity in these timecourse estimates is not reflective of the temporal resolution of MEG, but rather the spatial resolution of MEG. As the retinotopic source approaches the location of interest, some power will begin to leak into the source estimate. The temporal scale of the increase in power is therefore dependent on the spatial scale of the power leakage, hence the spatial specificity of the weights, and not the temporal resolution of MEG. Timecourses shown in the right hand column of <xref rid="f0020" ref-type="fig">Fig. 4</xref> are reconstructed using unaveraged data and do not show the same temporal signature as those reconstructed using weights based on averaged data. They appear to be dominated by power changes at the beginning and the end of the stimulation period. Interestingly, the location of the wedge at the beginning and the end of the stimulation period is known to evoke activity in the upper, shallower regions of the visual cortex (i.e. those regions above the calcarine fissure). The implication is that the beamformer weights, computed using unaveraged data, lack the spatial specificity required to cancel out signals from these shallow sources which will have larger SNR simply due to geometry. Without averaging the beamformer cannot therefore accurately reconstruct the temporal signature of these deeper sources.</p>
      <p><xref rid="f0025" ref-type="fig">Fig. 5</xref> shows the results of the retinotopic mapping experiment, averaged across subjects. Both the spatial and temporal results agree with the single subject result, showing the robustness of the effects that are described. The spatial maps demonstrated the retinotopic organisation of the visual cortex in all subjects. Further, the sequential activation of 5 locations of interest could be observed when timecourse estimates were constructed using weights based on averaged data. This sequential signature was lost when weights were constructed using unaveraged data. This is confirmed in <xref rid="f0030" ref-type="fig">Fig. 6</xref> which shows the Pearson correlation between the experimentally derived timecourses and the sequential activation model for all 5 retinotopic locations. As shown, better correlation was observed for beamformer projected averaged data compared to beamformer projected unaveraged data at four out of the 5 retinotopic locations. The difference in correlation coefficients between averaged and unaveraged data for the 5 retinotopic locations were − 3(± 13)%, 8(± 22)%, 28(± 15)%, 20(± 18)%, and 28(± 18)%.</p>
    </sec>
    <sec id="s0050">
      <title>Discussion</title>
      <p>The initial aim of this study was to address the question: does data averaging improve the spatial specificity of MEG beamformer imaging. Averaging MEG data across trials obviously improves the signal to noise ratio of the measured effects, thus improving the accuracy of covariance estimates used. However, averaging also reduces the total amount of data (information) that is available to construct the covariance estimate which has been shown to degrade accuracy (<xref rid="bb0020" ref-type="bibr">Brookes et al., 2008</xref>). Furthermore the reduction in white noise that is afforded by data averaging can cause data covariance matrices to become ill-conditioned such that the inverse covariance matrix is inaccurate. The problems brought about by data averaging have led previously described methodologies to rely on unaveraged broadband weights (<xref rid="bb0085 bb0025" ref-type="bibr">Robinson, 2004; Cheyne et al., 2006</xref>).</p>
      <p>Our analytical and single source simulation results have shown that, within the limitations of a single source and uncorrelated Gaussian sensor noise model, averaging data has little effect on the final accuracy of beamformer estimates. We showed that, overall, the accuracy of the covariance matrix was improved by data averaging. However, without regularisation, the loss of rank due to averaging caused the inverse covariance matrix to become inaccurate, and therefore beamformer source estimates were distorted severely. To correct for this, a matrix regularisation strategy was introduced. Following regularisation, the noise that was eliminated by averaging was effectively added by regularisation, and therefore there was little or no advantage to averaging across trials. These single source simulation results were echoed by a two source simulation that also employed sensor level Gaussian random noise.</p>
      <p>A marked difference was found when experimentally measured broadband ‘brain noise’ was employed. In the Gaussian noise model, the dominant source of noise is obviously uncorrelated across MEG sensors. However, it is well known that in real MEG experiments, evoked stimulus-induced signals are supplemented by interference from both external devices and sources of no interest in the brain. This correlated interference from other sources must be eliminated by the beamformer if a source of interest is to be reconstructed accurately. Averaging across trials acts to reduce (or eliminate) sources of interference that are not phase-locked to stimulus onset. This gives the beamformer the opportunity to ‘focus’ its power on the remaining phase-locked interference, which is then eliminated more effectively. Our two source simulation with experimental brain noise showed that, using beamformer weights based on unaveraged data, the two sources could not be separated. However, they were separated using beamformer weights based on averaged data. This result was echoed in a retinotopic mapping MEG experiment. We tracked the retinotopic movement of a moving electrical source. Further, we showed that, using beamformer weights based on averaged data, independent timecourse estimates could be extracted from locations in the visual cortex in close proximity. These timecourses showed the sequential activation of neighbouring regions in the visual cortex and this sequential signature was not observed when the beamformer weights were computed using unaveraged data.</p>
      <p>The ultimate limit to the spatial specificity of MEG is characterised by the ability to extract two independent temporal signals from two cortical locations with a small separation. Using a beamformer technique this is characterised by the spatial specificity of the weights and it is surprising that marked changes in spatial specificity can be observed by making small changes to data covariance estimation. We have shown that spatial specificity is improved by using data averaging to reduce the total number of sources that are to be suppressed by the beamformer. Other ways of changing spatial specificity include reducing the duration of the covariance window, and reducing bandwidth (<xref rid="bb0035" ref-type="bibr">Dalal et al., 2008</xref>). Reducing the duration allows the beamformer to focus on sources active during a limited time window. Frequency filtering to reduce bandwidth allows focusing only on sources within a given frequency band. Many previous studies have used frequency filtered, temporally windowed data to obtain functional images, and then broadband data from the whole experiment to compute a timecourse. Whilst this is not incorrect, it should be pointed out that the weights used for computation of the statistical image and timecourse will have very different spatial specificities. In general, small time frequency windows will allow more focused weights; however, previous work (<xref rid="bb0020" ref-type="bibr">Brookes et al., 2008</xref>) has shown that the accuracy of covariance estimates is degraded if windows are made too small. A trade off is therefore introduced and judicious selection of a strategy to compute data covariance is imperative if the effectiveness of the beamformer estimate is to be optimal. In <xref rid="s0065" ref-type="sec">Appendix II</xref> of this paper, a very simple strategy is outlined to achieve accurate beamformer estimates, and still ensure enough information for covariance construction.</p>
      <p>Here, averaging MEG data across trials has been shown to improve spatial specificity. There are however limitations to this approach which may mean that it is not always desirable to average. Gaining an accurate source estimate using averaged data is dependent on regularisation. Here we present an approach based on equalising the range of singular values across the two datasets. This strategy adds noise, however averaging and regularising in this way can be thought of as removing correlated interference, and adding uncorrelated Gaussian noise. The latter does not require cancellation by the beamformer. Unfortunately, as the spatial specificity of the estimate improves, the beamformer becomes less robust to inaccurate forward solutions. This means that non-dipolar sources (for example an extended source) may be suppressed if data is averaged prior to covariance computation. It is also conceivable that eliminating the non-phase-locked components of some sources may lead to two spatially separate sources becoming more temporally correlated. This would also lead to suppression of these sources by the beamformer (<xref rid="bb0105" ref-type="bibr">Sekihara et al., 2002a</xref>), and another approach must be employed for accurate localisation. It is certain that in some cases it is not desirable to average data prior to beamformer application and we <italic>do not</italic> recommend that this approach be adopted as a standard. However, in cases where sources are expected in close proximity, and high spatial resolution is required, we can recommend the use of the averaging approach.</p>
      <p>Our retinotopic mapping paradigm elicits a phase-locked driven response in the visual cortex. This driven response is narrow-band and relatively long (5 s) time windows were employed to derive pseudo-<italic>T</italic>-statistical images. This paradigm was effectively used to demonstrate the improvement in spatial specificity afforded by data averaging. However, the response localised here is not necessarily representative of the more common broadband brief transient evoked responses often studied in MEG. For this reason further investigation is required to realise the benefits of averaging transient broadband evoked responses for beamformer localisation. The retinotopic mapping paradigm does however represent an ideal way to test the spatial specificity of weighting parameters. This is because sources in close proximity are sequentially active, and to obtain an accurate temporal profile at any one retinotopic location, the source localisation methodology must reject signals from neighbouring sources. Here we show that beamforming affords sufficient spatial specificity to extract the correct temporal sequence of activity from neighbouring retinotopic locations. In addition, this paradigm allows insights into how beamformers might be used to track moving dipolar sources. We have shown that there is a limit to the temporal resolution of beamformer source localisation. This is brought about due to the fact that the covariance window duration, <italic>T</italic><sub>cov</sub> must be made large enough to ensure accurate power reconstruction. We outline a simple technique to measure the limits of temporal resolution in <xref rid="s0065" ref-type="sec">Appendix II</xref>. We suggest that this approach be used when measuring moving sources, or when using a time frequency beamformer approach. Finally, we suggest that this paradigm be used to test and compare new source localisation techniques. The fact that MEG can achieve the spatial resolution required to track our moving retinotopic source is impressive. Future work should investigate the spatial specificity of MEG using similar paradigms in somatosensory, motor and auditory cortices. The latter is of particular relevance. The quiet environment of the MEG scanner is ideal to investigate tonotopic mapping, something that is difficult in fMRI due to acoustic noise.</p>
    </sec>
    <sec id="s0055">
      <title>Conclusion</title>
      <p>This study has demonstrated that the spatial specificity of MEG beamformer estimates of electrical activity are affected by the way in which covariance estimates are calculated. Previous analytical and simulated results have shown that beamformer estimates are affected by narrowing the time frequency window in which covariance estimates are made (<xref rid="bb0015 bb0035" ref-type="bibr">Brookes et al., 2007; Dalal et al., 2008</xref>). Here we build on this work by investigating the effect of data averaging prior to covariance estimation. In appropriate circumstances, averaging was shown to lead to a marked improvement in spatial specificity. However the averaging process results in ill-conditioned covariance matrices, thus necessitating an appropriate regularisation strategy. Further, averaging may worsen the problems associated with beamformers and correlated sources, and make beamformers less robust to extended (non-dipolar) sources. We therefore do not recommend averaging as a general rule. However, we have shown that when spatially separate brain sources are active in close proximity, averaging significantly improves the beamformers ability to extract temporally independent signals from locations of interest. A moving visual stimulus was used to elicit brain activation at different retinotopic locations in the visual cortex (<xref rid="bb0040" ref-type="bibr">Engel et al., 1994</xref>). This gives the impression of a moving dipolar source in the brain. We showed that the moving source can be tracked in the cortex. Timecourse estimates were extracted from neighbouring locations of interest in the visual cortex. The sequential activation of separate retinotopic locations was observed with averaging but not without averaging. Finally, the retinotopic paradigm represents an ideal platform to test the spatial specificity of MEG localisation strategies. We suggest future comparisons of MEG localisation techniques could be made using this approach.</p>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="bb0005">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Aine</surname>
              <given-names>C.J.</given-names>
            </name>
            <name>
              <surname>Supek</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>George</surname>
              <given-names>J.S.</given-names>
            </name>
            <name>
              <surname>Ranken</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Lewine</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Sanders</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Best</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Tiee</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Flynn</surname>
              <given-names>E.R.</given-names>
            </name>
            <name>
              <surname>Wood</surname>
              <given-names>C.C.</given-names>
            </name>
          </person-group>
          <article-title>Retinotopic organization of human visual cortex: departures from the classical model</article-title>
          <source>Cereb. Cortex</source>
          <volume>6</volume>
          <year>1996</year>
          <fpage>354</fpage>
          <lpage>361</lpage>
          <pub-id pub-id-type="pmid">8670663</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0010">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Barnes</surname>
              <given-names>G.R.</given-names>
            </name>
            <name>
              <surname>Hillebrand</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Statistical flattening of beamformer images</article-title>
          <source>Hum. Brain Mapp.</source>
          <volume>18</volume>
          <year>2003</year>
          <fpage>1</fpage>
          <lpage>12</lpage>
          <pub-id pub-id-type="pmid">12454907</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0015">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Brookes</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Stevenson</surname>
              <given-names>C.M.</given-names>
            </name>
            <name>
              <surname>Barnes</surname>
              <given-names>G.R.</given-names>
            </name>
            <name>
              <surname>Hillebrand</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Simpson</surname>
              <given-names>M.I.G.</given-names>
            </name>
            <name>
              <surname>Francis</surname>
              <given-names>S.T.</given-names>
            </name>
            <name>
              <surname>Morris</surname>
              <given-names>P.G.</given-names>
            </name>
          </person-group>
          <article-title>Beamformer reconstruction of correlated sources using a modified source model</article-title>
          <source>NeuroImage</source>
          <volume>34</volume>
          <year>2007</year>
          <fpage>1454</fpage>
          <lpage>1465</lpage>
          <pub-id pub-id-type="pmid">17196835</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0020">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Brookes</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Vrba</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Robinson</surname>
              <given-names>S.E.</given-names>
            </name>
            <name>
              <surname>Stevenson</surname>
              <given-names>C.M.</given-names>
            </name>
            <name>
              <surname>Peters</surname>
              <given-names>A.P.</given-names>
            </name>
            <name>
              <surname>Barnes</surname>
              <given-names>G.R.</given-names>
            </name>
            <name>
              <surname>Hillebrand</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Morris</surname>
              <given-names>P.G.</given-names>
            </name>
          </person-group>
          <article-title>Optimising experimental design for MEG beamformer imaging</article-title>
          <source>NeuroImage</source>
          <volume>39</volume>
          <year>2008</year>
          <fpage>1788</fpage>
          <lpage>1802</lpage>
          <pub-id pub-id-type="pmid">18155612</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0025">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Cheyne</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Bakhtazad</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Gaetz</surname>
              <given-names>W.</given-names>
            </name>
          </person-group>
          <article-title>Spatiotemporal mapping of cortical activity accompanying voluntary movements using an event-related beamforming approach</article-title>
          <source>Hum. Brain Mapp.</source>
          <volume>27</volume>
          <year>2006</year>
          <fpage>213</fpage>
          <lpage>229</lpage>
          <pub-id pub-id-type="pmid">16037985</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0030">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Cheyne</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Bostan</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Gaetz</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Pang</surname>
              <given-names>E.</given-names>
            </name>
          </person-group>
          <article-title>Event related beamforming: a robust method for presurgical functional mapping using MEG</article-title>
          <source>Clin. Neurophysiol.</source>
          <volume>118</volume>
          <year>2007</year>
          <fpage>1691</fpage>
          <lpage>1704</lpage>
          <pub-id pub-id-type="pmid">17587643</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0035">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Dalal</surname>
              <given-names>S.S.</given-names>
            </name>
            <name>
              <surname>Guggisberg</surname>
              <given-names>A.G.</given-names>
            </name>
            <name>
              <surname>Edwards</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Sekihara</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Findlay</surname>
              <given-names>A.M.</given-names>
            </name>
            <name>
              <surname>Canolty</surname>
              <given-names>R.T.</given-names>
            </name>
            <name>
              <surname>Berger</surname>
              <given-names>M.S.</given-names>
            </name>
            <name>
              <surname>Knight</surname>
              <given-names>R.T.</given-names>
            </name>
            <name>
              <surname>Barbaro</surname>
              <given-names>N.M.</given-names>
            </name>
            <name>
              <surname>Kirsch</surname>
              <given-names>H.E.</given-names>
            </name>
            <name>
              <surname>Nagarajan</surname>
              <given-names>S.S.</given-names>
            </name>
          </person-group>
          <article-title>Five-dimensional neuroimaging: localization of the time-frequency dynamics of cortical activity</article-title>
          <source>NeuroImage</source>
          <volume>40</volume>
          <year>2008</year>
          <fpage>1686</fpage>
          <lpage>1700</lpage>
          <pub-id pub-id-type="pmid">18356081</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0040">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Engel</surname>
              <given-names>S.A.</given-names>
            </name>
            <name>
              <surname>Rumelhart</surname>
              <given-names>D.E.</given-names>
            </name>
            <name>
              <surname>Wandell</surname>
              <given-names>B.A.</given-names>
            </name>
            <name>
              <surname>Lee</surname>
              <given-names>A.T.</given-names>
            </name>
            <name>
              <surname>Glover</surname>
              <given-names>G.H.</given-names>
            </name>
            <name>
              <surname>Chichilnisky</surname>
              <given-names>E.J.</given-names>
            </name>
            <name>
              <surname>Shadien</surname>
              <given-names>M.N.</given-names>
            </name>
          </person-group>
          <article-title>fMRI of human visual cortex</article-title>
          <source>Nature</source>
          <volume>369</volume>
          <year>1994</year>
          <fpage>525</fpage>
          <pub-id pub-id-type="pmid">8031403</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0045">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gramfort</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Cottereau</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Clerc</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Thirion</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Baillet</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <article-title>Challenging the estimation of cortical activity from MEG with simulated fMRI-constrained retinotopic maps</article-title>
          <source>Conf. Proc. IEEE Eng. Med. Biol. Soc.</source>
          <year>2007</year>
          <fpage>4945</fpage>
          <lpage>4948</lpage>
          <pub-id pub-id-type="pmid">18003116</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0050">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gross</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Kujala</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Hamalainen</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Timmermann</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Schnitzler</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Salmelin</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Dynamic imaging of coherent sources: Studying neural interactions in the human brain</article-title>
          <source>Proc. Natl. Acad. Sci. U. S. A.</source>
          <volume>98</volume>
          <year>2001</year>
          <fpage>694</fpage>
          <lpage>699</lpage>
          <pub-id pub-id-type="pmid">11209067</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0055">
        <mixed-citation publication-type="other">Hadamard, J., 1952 (Lectures on Cauchy's Problem in Linear Partial Differential Equations.1952).</mixed-citation>
      </ref>
      <ref id="bb0060">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hagler</surname>
              <given-names>D.J.</given-names>
            </name>
            <name>
              <surname>Halgren</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Martinez</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Huang</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Hillyard</surname>
              <given-names>S.A.</given-names>
            </name>
            <name>
              <surname>Dale</surname>
              <given-names>A.M.</given-names>
            </name>
          </person-group>
          <article-title>Source estimates for MEG/EEG visual evoked responses constrained by multiple, retinotopically-mapped stimulus locations</article-title>
          <source>Hum. Brain Mapp.</source>
          <volume>30</volume>
          <year>2009</year>
          <fpage>1290</fpage>
          <lpage>1309</lpage>
          <pub-id pub-id-type="pmid">18570197</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0065">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hamalainen</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Hari</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Ilmoniemi</surname>
              <given-names>R.J.</given-names>
            </name>
            <name>
              <surname>Knuutila</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Lounasmaa</surname>
              <given-names>O.V.</given-names>
            </name>
          </person-group>
          <article-title>Magnetoencephalography—theory, instrumentation and applications to non-invasive studies of the working human brain</article-title>
          <source>Rev. Modern Phys.</source>
          <volume>21</volume>
          <year>1993</year>
          <fpage>413</fpage>
          <lpage>460</lpage>
        </element-citation>
      </ref>
      <ref id="bb0070">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Huang</surname>
              <given-names>M.X.</given-names>
            </name>
            <name>
              <surname>Mosher</surname>
              <given-names>J.C.</given-names>
            </name>
            <name>
              <surname>Leahy</surname>
              <given-names>R.M.</given-names>
            </name>
          </person-group>
          <article-title>A sensor-weighted overlapping-sphere head model and exhaustive head model comparison for MEG</article-title>
          <source>Phys. Med. Biol.</source>
          <volume>44</volume>
          <year>1999</year>
          <fpage>423</fpage>
          <lpage>440</lpage>
          <pub-id pub-id-type="pmid">10070792</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0075">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Peirce</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>PsychoPy—psychophysics software in python</article-title>
          <source>J. Neurosci. Methods</source>
          <volume>162</volume>
          <year>2007</year>
          <fpage>8</fpage>
          <lpage>13</lpage>
          <pub-id pub-id-type="pmid">17254636</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0080">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Pfurtscheller</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Lopes da Silva</surname>
              <given-names>F.H.</given-names>
            </name>
          </person-group>
          <article-title>Event-realted EEG/MEG synchronization and desynchronization: basic principles</article-title>
          <source>Clin. Neurophysiol.</source>
          <volume>110</volume>
          <year>1999</year>
          <fpage>1842</fpage>
          <lpage>1857</lpage>
          <pub-id pub-id-type="pmid">10576479</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0085">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Robinson</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <article-title>Localization of event-related activity by SAM(erf)</article-title>
          <source>Neurol. Clin. Neurophysiol.</source>
          <volume>109</volume>
          <year>2004</year>
        </element-citation>
      </ref>
      <ref id="bb0090">
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Robinson</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Vrba</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <chapter-title>Functional neuroimaging by synthetic aperture magnetometry</chapter-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Yoshimoto</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Kotani</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Kuriki</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Karibe</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Nakasato</surname>
              <given-names>N</given-names>
            </name>
          </person-group>
          <source>Recent Advances in Biomagnetism</source>
          <year>1998</year>
          <publisher-name>Tohoku Univ Press</publisher-name>
          <publisher-loc>Sendai, Japan</publisher-loc>
          <fpage>302</fpage>
          <lpage>305</lpage>
        </element-citation>
      </ref>
      <ref id="bb0095">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sarvas</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Basic mathematical and electromagnetic concepts of the biomagnetic inverse problem</article-title>
          <source>Phys. Med. Biol.</source>
          <volume>32</volume>
          <year>1987</year>
          <fpage>11</fpage>
          <lpage>22</lpage>
          <pub-id pub-id-type="pmid">3823129</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0100">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sekihara</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Nagarajan</surname>
              <given-names>S.S.</given-names>
            </name>
            <name>
              <surname>Peoppel</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Marantz</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Miyashita</surname>
              <given-names>Y.</given-names>
            </name>
          </person-group>
          <article-title>Reconstructing spatio-temporal activities of neural sources using an MEG vector beamformer technique</article-title>
          <source>IEEE Trans. Biomed. Eng.</source>
          <volume>48</volume>
          <year>2001</year>
          <fpage>760</fpage>
          <lpage>771</lpage>
          <pub-id pub-id-type="pmid">11442288</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0105">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sekihara</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Nagarajan</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Poeppel</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Marantz</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Performance of an MEG adaptive- beamformer technique in the presence of correlated neural activities: effects on signal intensity and time course estimates</article-title>
          <source>IEEE Trans. Biomed. Eng.</source>
          <volume>49</volume>
          <year>2002</year>
          <fpage>1534</fpage>
          <lpage>1546</lpage>
          <pub-id pub-id-type="pmid">12549735</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0110">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sekihara</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Nagarajan</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Poeppel</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Marantz</surname>
              <given-names>A.Y.M</given-names>
            </name>
          </person-group>
          <article-title>Application of an MEG eigenspace beamformer to reconstructing spatio-temporal activities of neural sources</article-title>
          <source>Hum. Brain Mapp.</source>
          <volume>15</volume>
          <year>2002</year>
          <fpage>199</fpage>
          <lpage>215</lpage>
          <pub-id pub-id-type="pmid">11835609</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0115">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Van Drongelen</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Yuchtman</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Van Veen</surname>
              <given-names>B.D.</given-names>
            </name>
            <name>
              <surname>Van Huffelen</surname>
              <given-names>A.C.</given-names>
            </name>
          </person-group>
          <article-title>A spatial filtering technique to detect and localize multiple sources in the brain</article-title>
          <source>Brain Topogr.</source>
          <volume>9</volume>
          <year>1996</year>
          <fpage>39</fpage>
          <lpage>49</lpage>
        </element-citation>
      </ref>
      <ref id="bb0120">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Van Veen</surname>
              <given-names>B.D.</given-names>
            </name>
            <name>
              <surname>Van Drongelen</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Yuchtman</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Suzuki</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Localisation of brain electrical activity via linearly constrained minimum variance spatial filtering</article-title>
          <source>IEEE Trans. Biomed. Eng.</source>
          <volume>44</volume>
          <year>1997</year>
          <fpage>867</fpage>
          <lpage>880</lpage>
          <pub-id pub-id-type="pmid">9282479</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0125">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Vrba</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Robinson</surname>
              <given-names>S.E.</given-names>
            </name>
          </person-group>
          <article-title>Signal processing in magnetoencephalography</article-title>
          <source>Methods</source>
          <volume>25</volume>
          <year>2001</year>
          <fpage>249</fpage>
          <lpage>271</lpage>
          <pub-id pub-id-type="pmid">11812209</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0130">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Vrba</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Robinson</surname>
              <given-names>S.E.</given-names>
            </name>
          </person-group>
          <article-title>SQUID sensor array configurations for magnetoencephalography applications</article-title>
          <source>Supercond. Sci. Technol.</source>
          <volume>15</volume>
          <year>2002</year>
          <fpage>R51</fpage>
          <lpage>R89</lpage>
        </element-citation>
      </ref>
      <ref id="bb0135">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Vrba</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Haid</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Lee</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Taylor</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Fife</surname>
              <given-names>A.A.</given-names>
            </name>
            <name>
              <surname>Kubik</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>McCubbin</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Burbank</surname>
              <given-names>M.B.</given-names>
            </name>
          </person-group>
          <article-title>Biomagnetomers for unshielded and well shielded environments</article-title>
          <source>Clin. Phys. Physiol. Meas.</source>
          <volume>12</volume>
          <issue>Suppl. B</issue>
          <year>1991</year>
          <fpage>81</fpage>
          <lpage>86</lpage>
          <pub-id pub-id-type="pmid">1807884</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0140">
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yoshioka</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Toyama</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Kawato</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Yamashita</surname>
              <given-names>O.</given-names>
            </name>
            <name>
              <surname>Nishina</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Yamagishi</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Sato</surname>
              <given-names>M.A.</given-names>
            </name>
          </person-group>
          <article-title>Evaluation of hierarchical Bayesian method through retinotopic brain activities reconstruction from fMRI and MEG signals</article-title>
          <source>NeuroImage</source>
          <volume>42</volume>
          <year>2008</year>
          <fpage>1397</fpage>
          <lpage>1413</lpage>
          <pub-id pub-id-type="pmid">18620066</pub-id>
        </element-citation>
      </ref>
    </ref-list>
    <sec id="s0060">
      <title>Appendix I—Regularisation</title>
      <p>The reduction in random noise afforded by averaging can cause the condition number of covariance matrices to increase. In some cases covariance matrices can become ill-conditioned, or singular. It is therefore desirable to regularise the covariance matrix prior to matrix inversion. In this appendix we introduce a strategy for regularisation that ensures a well conditioned matrix.</p>
      <p><xref rid="f0035" ref-type="fig">Fig. A1</xref> shows schematically the spread of singular values for the averaged and unaveraged case. Let <bold>C</bold><sub><italic>m</italic></sub> represent the covariance matrix constructed from averaged data whilst <bold>C</bold><sup>(unav)</sup> represents the covariance matrix based on unaveraged data.</p>
      <p>Further, we let the minimum singular value of <bold>C</bold><sub><italic>m</italic></sub> be represented by <italic>s</italic><sub>1</sub> and the maximum singular value of <bold>C</bold><sub><italic>m</italic></sub> be represented by <italic>s</italic><sub>2</sub>. Similarly the minimum and maximum singular values of <bold>C</bold><sup>(unav)</sup> are denoted by <italic>s</italic><sub><italic>1</italic></sub><sup>(<italic>u</italic>)</sup> and <italic>s</italic><sub><italic>2</italic></sub><sup>(<italic>u</italic>)</sup> respectively. If we assume that the maximum singular vector of both covariance matrices represents the same phase-locked effect of interest, then <italic>s</italic><sub>2</sub> and <italic>s</italic><sub>2</sub><sup>(<italic>u</italic>)</sup> will be equal. In the infinite integration limit, the least significant singular value in both the unaveraged (<italic>s</italic><sub>1</sub><sup>(<italic>u</italic>)</sup>) and averaged (<italic>s</italic><sub>1</sub>) cases would be representative of the white noise level before and after data averaging respectively and the two would be related such that <inline-formula><mml:math id="M29" altimg="si33.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>ave</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. In the case of a finite number of samples however, these least significant singular values will drop below the white noise level. In the case of <italic>s</italic><sub>1</sub><sup>(<italic>u</italic>)</sup>, this effect will be slight since data are unaveraged and the number of samples is large. This means that <italic>s</italic><sub>1</sub><sup>(<italic>u</italic>)</sup> remains a useful estimate of white noise level. However, in the case of <italic>s</italic><sub>1</sub>, the number of samples used is less and so the effect will worsen meaning that <italic>s</italic><sub>1</sub> significantly underestimates white noise and <inline-formula><mml:math id="M30" altimg="si34.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>≪</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>ave</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For extremely small number of samples in the averaged data it is possible that <italic>s</italic><sub>1</sub> → 0.</p>
      <p>The regularisation strategy that we describe involves making the singular value range of regularised <bold>C</bold><sub><italic>m</italic></sub> equal to the singular value range of <bold>C</bold><sup>(unav)</sup>. This strategy ensures that the final <bold>C</bold><sub><italic>m</italic></sub> is well conditioned. Note that we will describe a general case which also allows for regularisation of <bold>C</bold><sup>(unav)</sup>.</p>
      <p>Let the regularised <bold>C</bold><sup>(unav)</sup> be given by:<disp-formula id="fo0065"><label>(A1)</label><mml:math id="M31" altimg="si35.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>unav</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>unav</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></disp-formula>The matrix condition number is defined as the maximum singular value, divided by the minimum singular value and represents a measure of the range of singular values. Using Eq. <xref rid="fo0065" ref-type="disp-formula">A1</xref> and the above notation, the condition number of the regularised matrix constructed using unaveraged data is:<disp-formula id="fo0070"><label>(A2)</label><mml:math id="M32" altimg="si36.gif" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow><mml:mi>u</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>The regularised matrix constructed from averaged data is given by<disp-formula id="fo0075"><label>(A3)</label><alternatives><textual-form specific-use="jats-markup"><bold>C</bold><sub><italic>m</italic>reg</sub> = <bold>C</bold><sub><italic>m</italic></sub> + <italic>r</italic><bold><italic>I</italic></bold></textual-form><mml:math id="M33" altimg="si37.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>and its condition number is given by <disp-formula id="fo0080"><label>(A4)</label><mml:math id="M34" altimg="si38.gif" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p>To match the range of singular values for the regularised <bold>C</bold><sub>mreg</sub> and <bold>C</bold><sub>reg</sub><sup>(unav)</sup>, we must derive a regularisation value <italic>r</italic> such that <italic>CN</italic><sub>reg</sub> =<italic>CN</italic><sub>reg</sub><sup><italic>u</italic></sup>. Assuming that <italic>r</italic> &lt;&lt; <italic>s</italic><sub>2</sub> and that <italic>μν</italic><sup>2</sup> &lt;&lt; <italic>s</italic><sub>2</sub><sup><italic>u</italic></sup>, which will be the case for data with appropriately high SNR, then we can write that:<disp-formula id="fo0085"><label>(A5)</label><mml:math id="M35" altimg="si39.gif" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mi>u</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula>The regularised <bold>C</bold><sub><italic>m</italic></sub> is therefore given by:<disp-formula id="fo0090"><label>(A6)</label><mml:math id="M36" altimg="si40.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow></mml:math></disp-formula></p>
      <p>Finally, we can assume that <italic>s</italic><sub>2</sub> ≈ <italic>s<sub>2</sub><sup>u</sup></italic>. Furthermore, assuming that there are a large number of samples in the unaveraged case we assume that <italic>ν</italic><sup><italic>2</italic></sup> ≈ <italic>s</italic><sub>1</sub><sup><italic>u</italic></sup>. The final expression for the regularised covariance matrix then becomes:<disp-formula id="fo0095"><label>(A7)</label><mml:math id="M37" altimg="si41.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>reg</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>u</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow></mml:math></disp-formula></p>
      <p>For all computations in this paper <bold>C</bold><sup>(unav)</sup> is well conditioned and <italic>s</italic><sub>1</sub><sup>(<italic>u</italic>)</sup> is deemed to be a suitably accurate estimation of white noise. For this reason the <italic>μ</italic> = 0 and we use a simplified expression <bold>C</bold><sub><italic>m</italic></sub><sup>(reg)</sup> = <bold>C</bold><italic><sub>m</sub></italic> + (<italic>s</italic><sub>1</sub><italic><sup>u</sup></italic> − <italic>s</italic><sub>1</sub>)<bold><italic>I</italic></bold> to derive the regularised covariance matrix from averaged data. In a case in which <italic>s</italic><sub>1</sub><sup>(<italic>u</italic>)</sup> is not an accurate estimation of white noise, <italic>μ</italic> can be altered accordingly and the validity of this strategy holds.</p>
    </sec>
    <sec id="s0065">
      <title>Appendix II—Covariance window optimisation</title>
      <p>Our previous work (<xref rid="bb0020" ref-type="bibr">Brookes et al., 2008</xref>) has shown that the accuracy of beamformer reconstruction is dependent on how much data is used to construct the covariance estimate. Specifically, if the covariance window duration <italic>T</italic><sub>cov</sub>, or the bandwidth <italic>BW</italic> are made too small then the electrical power, reconstructed using the beamformer, is underestimated. It is therefore of great importance to ensure judicious selection of <italic>T</italic><sub>cov</sub> and <italic>BW</italic>. In the retinotopic mapping experiment, <italic>BW</italic> was set to 10 Hz and the value of <italic>T</italic><sub>cov</sub> was optimised to ensure accurate spatial and timecourse reconstruction. Below a simple procedure for this optimisation is outlined.<list list-type="simple"><list-item><label>•</label><p>An initial guess of <italic>T</italic><sub>cov</sub> = 5 s was made. A single pseudo-<italic>T</italic>-statistical image was then constructed contrasting power in active (0 s &lt; <italic>t</italic> &lt; 5 s) and control (25 <italic>s</italic> &lt; <italic>t</italic> &lt; 30 <italic>s</italic>) windows. This image yielded a location of interest in visual cortex.</p></list-item><list-item><label>•</label><p><italic>T</italic><sub>cov</sub> was varied between 0.32 s and 8 s in 25 steps. For each value of <italic>T</italic><sub>cov</sub> the beamformer reconstructed power at the location of interest, was estimated. Power in active (starting at <italic>t</italic> = 0<italic>s</italic>) and control (starting at <italic>t</italic> = 10 <italic>s</italic>) windows was estimated.</p></list-item><list-item><label>•</label><p>Power in both active and control windows, and the power difference between active and control, were plotted as a function of <italic>T</italic><sub>cov</sub>.</p></list-item></list></p>
      <p>The above procedure was repeated using an active window starting <italic>t</italic> = 10s and a control window starting at <italic>t</italic> = 0<italic>s</italic>. This second repetition enabled <italic>T</italic><sub>cov</sub> optimisation at a different retinotopic location.</p>
      <p><xref rid="f0040" ref-type="fig">Fig. A2</xref> shows the results of the T<sub>cov</sub> optimisation procedure. Results are averaged across the two retinotopic locations, and all four subjects. A characteristic curve is produced, showing that for small <italic>T</italic><sub>cov</sub> power is underestimated, and the power difference between the active and control windows is indistinguishable. As <italic>T</italic><sub>cov</sub> is increased, power estimates, and the power difference are increased. These results are in agreement with previous analytical and simulation studies and suggest that the covariance window duration should not be made less than 5 s in order to ensure accurate power reconstruction.</p>
    </sec>
    <ack>
      <title>Acknowledgments</title>
      <p>The authors would like to thank Stephen Robinson and Sarang Dalal for helpful discussions regarding beamforming, and Jon Peirce for initial help with PsychoPy. We also gratefully acknowledge our funding sources, Medical Research Council, Engineering and Physical Sciences Research Council, the University of Nottingham and the Whitaker Foundation.</p>
    </ack>
  </back>
  <floats-group>
    <fig id="f0005">
      <label>Fig. 1</label>
      <caption>
        <p>Results of the single source simulation. (A) <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M38" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> versus <italic>N</italic><sub>ave</sub>. The solid line shows the theoretical relationship (Eq. (<xref rid="fo0030" ref-type="disp-formula">6</xref>)) and the data points show values from the simulation. (B) <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold><sub>inv</sub>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M39" altimg="si2.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>inv</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> versus <italic>N</italic><sub>ave</sub> for the unregularised covariance matrix. (C) <inline-formula><alternatives><textual-form specific-use="jats-markup">‖Δ<bold>C</bold><sub>inv</sub>‖<sub><italic>F</italic></sub></textual-form><mml:math id="M40" altimg="si3.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi mathvariant="bold">C</mml:mi><mml:mrow><mml:mtext>inv</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> versus <italic>N</italic><sub><italic>ave</italic></sub> for the regularised covariance matrix. Note the × 10<sup>− 4</sup> scaling on the <italic>y</italic>-axis. (D) Beamformer projected power for the ON (blue) and OFF (green) periods. E) One dimensional beamformer pseudo-T-stat images extracted from a single interaction of the simulation. Images were formed in this case by scanning in the <italic>y</italic> direction but equivalent results were derived for both the <italic>x</italic> and <italic>z</italic> directions.</p>
      </caption>
      <graphic xlink:href="gr1"/>
    </fig>
    <fig id="f0010">
      <label>Fig. 2</label>
      <caption>
        <p>Results of the two source simulations with Gaussian random noise. (A) beamformer reconstructed power in the ON (blue) and OFF (green) periods reconstructed at the location of source 1. Results are plotted against <italic>N</italic><sub><italic>ave</italic></sub> (B) timecourse correlation. The blue data points show the Pearson correlation coefficient between the beamformer timecourse estimate made at the location of source 1, and the original simulated timecourse for source 1. The green data points show the Pearson correlation coefficient between the beamformer timecourse estimate made at the location of source 1, and the original simulated timecourse for source 2. (C) Example 1-dimensional images, from a single iteration of the simulation, showing the pseudo-T-statistic as a function of position, <italic>y</italic>. Source 1 is at <italic>y</italic> = 1. Source 2 is at <italic>y</italic> = 0. Note for A, B and C, the amplitudes of sources 1 and 2 were 5 nAm and 10 nAm respectively.</p>
      </caption>
      <graphic xlink:href="gr2"/>
    </fig>
    <fig id="f0015">
      <label>Fig. 3</label>
      <caption>
        <p>Results of the two source simulation with <italic>Q</italic><sub>1</sub> = 5 nAm, <italic>Q</italic><sub>2</sub> = 10 nAm, and experimentally measured noise. (A) beamformer reconstructed power in the ON (blue) and OFF (green) periods reconstructed at the location of source 1. Results are plotted against <italic>N</italic><sub><italic>ave</italic></sub> (B) timecourse correlation. The blue data points show the Pearson correlation coefficient between the beamformer timecourse estimate made at the location of source 1, and the original simulated timecourse for source 1. The green data points show the Pearson correlation coefficient between the beamformer timecourse estimate made at the location of source 1, and the original simulated timecourse for source 2. (C) Example 1-dimensional images, from a single iteration of the simulation, showing the pseudo-T-statistic as a function of position, <italic>y</italic>. Source 1 is at <italic>y</italic> = 1. Source 2 is at <italic>y</italic> = 0.</p>
      </caption>
      <graphic xlink:href="gr3"/>
    </fig>
    <fig id="f0020">
      <label>Fig. 4</label>
      <caption>
        <p>Results of the retinotopic mapping experiment taken from a single subject and derived using averaged data. The left hand column shows pseudo-T-statistical images (derived from averaged data) depicting the retinotopic location of the source. Covariance windows were centred on 2.5 s, 7.5 s, 12.5 s, 17.5 s, and 22.5 s. The location of the stimulus in the visual field at these times is shown inset. The centre and right hand columns show the timecourse estimates of the envelope of 18–22 Hz power. These estimates were taken from peak locations in the images. Timecourses in the centre column are reconstructed using beamformer weights based on averaged data. Timecourses in the right hand column are reconstructed using beamformer weights based on unaveraged data.</p>
      </caption>
      <graphic xlink:href="gr4"/>
    </fig>
    <fig id="f0025">
      <label>Fig. 5</label>
      <caption>
        <p>Results averaged across subjects. The left hand column shows averaged locations for each stimulus location. The centre and right hand columns show timecourse estimates reconstructed using beamformer weights based on averaged and unaveraged data respectively. These timecourses are averaged across subjects and error bars show standard deviation.</p>
      </caption>
      <graphic xlink:href="gr5"/>
    </fig>
    <fig id="f0030">
      <label>Fig. 6</label>
      <caption>
        <p>Pearson correlation between the data derived timecourses and the sequential activation model.</p>
      </caption>
      <graphic xlink:href="gr6"/>
    </fig>
    <fig id="f0035">
      <label>Fig. A1</label>
      <caption>
        <p>Schematic diagram showing the change in the range of singular values caused by data averaging prior to covariance matrix computation. Note that in both cases, the least significant singular value will underestimate white noise level, however, this underestimation will be far more pronounced in the averaged case.</p>
      </caption>
      <graphic xlink:href="gra1"/>
    </fig>
    <fig id="f0040">
      <label>Fig. A2</label>
      <caption>
        <p>(A) Reconstructed power in the active and control covariance windows versus covariance window duration. (B) Difference in power between active and control windows. Results are averaged across all subjects and two locations.</p>
      </caption>
      <graphic xlink:href="gra2"/>
    </fig>
  </floats-group>
</article>