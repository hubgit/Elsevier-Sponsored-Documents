<article xmlns="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle http://dtd.nlm.nih.gov/2.0/xsd/archivearticle.xsd" article-type="research-article">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Physica D</journal-id>
      <journal-title>Physica D. Nonlinear Phenomena</journal-title>
      <issn pub-type="ppub">0167-2789</issn>
      <publisher>
        <publisher-name>North-Holland</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmc">2767160</article-id>
      <article-id pub-id-type="pmid">19862351</article-id>
      <article-id pub-id-type="publisher-id">PHYSD30700</article-id>
      <article-id pub-id-type="doi">10.1016/j.physd.2009.08.002</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Variational Bayesian identification and prediction of stochastic nonlinear dynamic causal models</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Daunizeau</surname>
            <given-names>J.</given-names>
          </name>
          <email>j.daunizeau@fil.ion.ucl.ac.uk</email>
          <xref rid="cor1" ref-type="corresp">⁎</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Friston</surname>
            <given-names>K.J.</given-names>
          </name>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Kiebel</surname>
            <given-names>S.J.</given-names>
          </name>
        </contrib>
      </contrib-group>
      <aff>
        <addr-line>Wellcome Trust Centre for Neuroimaging, University College, London, United Kingdom</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1"><label>⁎</label>Corresponding address: Wellcome Trust for Neuroimaging, Institute of Neurology, UCL, 12 Queen Square, London, WC1N 3BG, United Kingdom. Tel.: +44 207 833 7488; fax: +44 207 813 1445. <email>j.daunizeau@fil.ion.ucl.ac.uk</email></corresp>
      </author-notes>
      <pub-date pub-type="ppub">
        <day>01</day>
        <month>11</month>
        <year>2009</year>
      </pub-date>
      <volume>238</volume>
      <issue>21</issue>
      <fpage>2089</fpage>
      <lpage>2118</lpage>
      <history>
        <date date-type="received">
          <day>2</day>
          <month>7</month>
          <year>2008</year>
        </date>
        <date date-type="rev-recd">
          <day>29</day>
          <month>7</month>
          <year>2009</year>
        </date>
        <date date-type="accepted">
          <day>1</day>
          <month>8</month>
          <year>2009</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2009 Elsevier B.V.</copyright-statement>
        <copyright-year>2009</copyright-year>
        <copyright-holder>Elsevier B.V.</copyright-holder>
        <license>
          <p>This document may be redistributed and reused, subject to <ext-link ext-link-type="uri" xlink:href="http://www.elsevier.com/wps/find/authorsview.authors/supplementalterms1.0">certain conditions</ext-link>.</p>
        </license>
      </permissions>
      <abstract>
        <title>Abstract</title>
        <p>In this paper, we describe a general variational Bayesian approach for approximate inference on nonlinear stochastic dynamic models. This scheme extends established approximate inference on hidden-states to cover: (i) nonlinear evolution and observation functions, (ii) unknown parameters and (precision) hyperparameters and (iii) model comparison and prediction under uncertainty. Model identification or inversion entails the estimation of the marginal likelihood or evidence of a model. This difficult integration problem can be finessed by optimising a free-energy bound on the evidence using results from variational calculus. This yields a deterministic update scheme that optimises an approximation to the posterior density on the unknown model variables. We derive such a variational Bayesian scheme in the context of nonlinear stochastic dynamic hierarchical models, for both model identification and time-series prediction. The computational complexity of the scheme is comparable to that of an extended Kalman filter, which is critical when inverting high dimensional models or long time-series. Using Monte-Carlo simulations, we assess the estimation efficiency of this variational Bayesian approach using three stochastic variants of chaotic dynamic systems. We also demonstrate the model comparison capabilities of the method, its self-consistency and its predictive power.</p>
      </abstract>
      <kwd-group>
        <title>Keywords</title>
        <kwd>Approximate inference</kwd>
        <kwd>Model comparison</kwd>
        <kwd>Variational Bayes</kwd>
        <kwd>EM</kwd>
        <kwd>Laplace approximation</kwd>
        <kwd>Free-energy</kwd>
        <kwd>SDE</kwd>
        <kwd>Nonlinear stochastic dynamical systems</kwd>
        <kwd>Nonlinear state-space models</kwd>
        <kwd>DCM</kwd>
        <kwd>Kalman filter</kwd>
        <kwd>Rauch smoother</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="sec1">
      <label>1</label>
      <title>Introduction</title>
      <p>In nature, the most interesting dynamical systems are only observable through a complex (and generally non-invertible) mapping from the system’s states to some measurements. For example, we cannot observe the time-varying electrophysiological states of the brain but we can measure the electrical field it generates on the scalp using electroencephalography (EEG). Given a model of neural dynamics, it is possible to estimate parameters of interest (such as initial conditions or synaptic connection strengths) using probabilistic methods (see e.g. <xref rid="b1" ref-type="bibr">[1]</xref>, or <xref rid="b2" ref-type="bibr">[2]</xref>). However, incomplete or imperfect model specification can result in misleading parameter estimates, particularly if random or stochastic forces on system’s states are ignored <xref rid="b3" ref-type="bibr">[3]</xref>. Many dynamical systems are nonlinear and stochastic; for example neuronal activity is driven by, at least partly, physiological noise (see e.g. <xref rid="b4 b5" ref-type="bibr">[4,5]</xref>). This makes recovery of both neuronal dynamics and the parameters of their associated models a challenging focus of ongoing research (see e.g. <xref rid="b6 b7" ref-type="bibr">[6,7]</xref>). Another example of stochastic nonlinear system identification is weather forecasting; where model inversion allows predictions of hidden-states from meteorological models (e.g. <xref rid="b8" ref-type="bibr">[8]</xref>). This class of problems is found in many applied research fields such as control engineering, speech recognition, meteorology, oceanography, ecology and quantitative finance. In brief, the identification and prediction of stochastic nonlinear dynamical systems have to cope with subtle forms of uncertainty arising from; (i) the complexity of the dynamical behaviour of the system, (ii) our lack of knowledge about its structure and (iii) our inability to directly measure its states (hence the name “hidden- states”). This speaks to the importance of probabilistic methods for identifying nonlinear stochastic dynamic models (see <xref rid="b9" ref-type="bibr">[9]</xref> for a “data assimilation” perspective).</p>
      <p>Most statistical inference methods for stochastic dynamical systems rely on a state-space formulation i.e. the specification of two densities; the likelihood, derived from an observation model and a first-order Markovian transition density, which embodies prior beliefs about the evolution of the system <xref rid="b10" ref-type="bibr">[10]</xref>. The nonlinear filtering and smoothing<xref rid="fn1" ref-type="fn">1</xref> problems have already been solved using a Bayesian formulation by Kushner <xref rid="b11" ref-type="bibr">[11]</xref> and Pardoux <xref rid="b12" ref-type="bibr">[12]</xref> respectively. These authors show that the posterior densities on hidden-states given the data so far (filtering) or all the data (smoothing) obey stochastic partial differential (Kushner–Pardoux) equations. However:</p>
      <p>
        <list list-type="simple">
          <list-item>
            <label>•</label>
            <p>They suffer from the curse of dimensionality; i.e. an exponential growth of computational complexity with the number of hidden-states <xref rid="b13" ref-type="bibr">[13]</xref>. This is why most approximate inversion techniques are variants of the simpler Kalman filter <xref rid="b14 b15" ref-type="bibr">[14,15]</xref> or <xref rid="b10 b16" ref-type="bibr">[10,16]</xref>. Sampling based approximations to the posterior density (particle filters, see e.g. <xref rid="b58" ref-type="bibr">[58]</xref> or <xref rid="b17" ref-type="bibr">[17]</xref>) have also been developed, but these also suffer from the curse of dimensionality.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>The likelihood and the transition densities depend on the potentially unknown parameters and hyperparameters<xref rid="fn2" ref-type="fn">2</xref> of the underlying state-space model. These quantities have also to be estimated and induce a hierarchical inversion problem, for which there is no generally accepted solution (see <xref rid="b18" ref-type="bibr">[18]</xref> for an approximate maximum-likelihood approach to this problem). This is due to the complexity (e.g. multimodality and high-order dependencies) of the joint posterior density over hidden-states, parameters and hyperparameters. The hierarchical structure of the generative model prevents us from using the Kushner–Pardoux equations or Kalman Filter based approximations. A review of modified Kalman filters for joint estimation of model parameters and hidden-states can be found in Wan <xref rid="b19" ref-type="bibr">[19]</xref>.</p>
          </list-item>
          <list-item>
            <p>These issues make variational Bayesian (VB) schemes <xref rid="b20 b21 b22 b23" ref-type="bibr">[20–23]</xref> appealing candidates for joint estimation of states, parameters and hyperparameters. However, somewhat surprisingly, only a few VB methods have been proposed to finesse this triple estimation problem for nonlinear systems. These include:</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Roweis and Ghahramani <xref rid="b24" ref-type="bibr">[24]</xref> propose an Expectation-Maximization algorithm that yields an approximate posterior density over hidden-states and maximum-likelihood estimates of the parameters.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Valpola and Karhunen <xref rid="b25" ref-type="bibr">[25]</xref> propose a VB method for unsupervised extraction of dynamic processes from noisy data. The nonlinear mappings in the model are represented using multilayer perceptron networks. This dynamical blind deconvolution approach generalizes <xref rid="b24" ref-type="bibr">[24]</xref>, by deriving an approximate posterior density over the mapping parameters. However, as in Roweis <xref rid="b24" ref-type="bibr">[24]</xref> the method cannot embed prior knowledge about the functional form of both observation and evolution processes.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Friston et al. <xref rid="b7" ref-type="bibr">[7]</xref>, present a VB inversion scheme for nonlinear stochastic dynamical models in generalized coordinates of motion. The approach rests on formulating the free-energy optimization dynamically (in generalized coordinates) and furnishes a continuous analogue to extended Kalman smoothing algorithms. Unlike previous schemes, the algorithm can deal with serially correlated state-noise and can optimize a joint posterior density on all unknown quantities.</p>
          </list-item>
        </list>
      </p>
      <p>Despite the advances in model inversion described in theses papers, there remain some key outstanding issues: First, the difficult problem of time-series prediction, given the (inferred) structure of the system (see <xref rid="b26" ref-type="bibr">[26]</xref> for an elegant Gaussian process solution). Second, no attempt has been made to assess the statistical efficiency of the proposed VB estimators for nonlinear systems (see <xref rid="b27" ref-type="bibr">[27]</xref> for a study of asymptotic behaviour of VB estimators for conjugate-exponential models). Third, there has been no attempt to optimize the form or structure of the state-space model using approximate Bayesian model comparison.</p>
      <p>In this paper, we present a VB approach for approximating the posterior density over hidden-states and model parameters of stochastic nonlinear dynamic models. This is important because it allows one to infer the hidden-states causing data, parameters causing the dynamics of hidden-states and any non-controlled exogenous input to the system, given observations. Critically, we can make inferences even when both the observation and evolution function are nonlinear. Alternatively, this approach can be viewed as an extension of VB inversion of static models (e.g. <xref rid="b28" ref-type="bibr">[28]</xref>) to invert nonlinear state-space models. We also extend the VB scheme to approximate both the predictive density (on hidden-states and measurement space) and the sojourn density (i.e. the stationary distribution of the Markov chain) that summaries long-term behaviour <xref rid="b29" ref-type="bibr">[29]</xref>.</p>
      <p>In brief, model inversion entails optimizing an approximate posterior density that is parameterized by its sufficient statistics. This density is derived by updating the sufficient statistics using an iterative coordinate ascent on a free-energy bound on the marginal likelihood. We demonstrate the performances of this VB inference scheme when inverting (and predicting) stochastic variants of chaotic dynamic systems.</p>
      <p>This paper comprises three sections. In the first, we review the general problem of model inversion and comparison in a variational Bayesian framework. More precisely, this section describes the extension of the VB approach to non-Gaussian posterior densities, under the Laplace approximation. The second section demonstrates the VB-Laplace update rules for a specific yet broad class of generative models, namely: stochastic dynamic causal models (see <xref rid="b1" ref-type="bibr">[1]</xref> for a Bayesian treatment of deterministic DCMs). It also provides a computationally efficient alternative to the standard tool for long-term prediction (the stationary or sojourn density), based upon an approximation to the predictive density. The third section provides an evaluation of the method’s capabilities in terms of accuracy, model comparison, self-consistency and prediction, using Monte Carlo simulations from three stochastic nonlinear dynamical systems. In particular, we compare the VB approach to standard extended Kalman filtering, which is used routinely in nonlinear filtering applications. We also include results providing evidence for the asymptotic efficiency of the VB estimator in this context. Finally, we discuss the properties of the VB approach.</p>
    </sec>
    <sec id="sec2">
      <label>2</label>
      <title>Approximate variational Bayesian inference</title>
      <sec id="sec2.1">
        <label>2.1</label>
        <title>Variational learning</title>
        <p>To interpret any observed data y with a view to making predictions based upon it, we need to select the best model m that provides formal constraints on the way those data were generated; and will be generated in the future. This selection can be based on Bayesian probability theory to choose among several models in the light of data. This necessarily involves evaluating the marginal likelihood; i.e. the plausibility of observed data given model m: <disp-formula id="fd1"><label>(1)</label><mml:math id="M1" altimg="si97.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>ϑ</mml:mi></mml:math></disp-formula> where the generative model m is defined in terms of a likelihood <mml:math id="M2" altimg="si99.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> and prior <mml:math id="M3" altimg="si100.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> on the model parameters, ϑ, whose product yields the joint density by Bayes rule: <disp-formula id="fd2"><label>(2)</label><mml:math id="M4" altimg="si102.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> The marginal likelihood or evidence <mml:math id="M5" altimg="si103.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> is required to compare different models. Usually, the evidence is estimated by converting the difficult integration problem in Eq. <xref rid="fd1" ref-type="disp-formula">(1)</xref> into an easier optimization problem by optimizing a free-energy bound on the log-evidence. This bound is constructed using Jensen’s inequality and is induced by an arbitrary density <mml:math id="M6" altimg="si104.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><xref rid="b21" ref-type="bibr">[21]</xref>: <disp-formula id="fd3"><label>(3)</label><mml:math id="M7" altimg="si105.gif" display="block" overflow="scroll"><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mo>−</mml:mo><mml:mi>S</mml:mi></mml:math></disp-formula><disp-formula><mml:math id="M8" altimg="si106.gif" display="block" overflow="scroll"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>ln</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>ϑ</mml:mi><mml:mtext>.</mml:mtext></mml:math></disp-formula> The free-energy comprises an energy term <mml:math id="M9" altimg="si107.gif" display="inline" overflow="scroll"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math> and an entropy term <mml:math id="M10" altimg="si108.gif" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math>.<xref rid="fn3" ref-type="fn">3</xref> The free-energy is a lower bound on the log-evidence because the Kullback–Leibler cross-entropy or divergence, D between the arbitrary and posterior densities is non-negative. Maximizing the free-energy with respect to <mml:math id="M11" altimg="si110.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> minimizes the divergence, rendering the arbitrary density <mml:math id="M12" altimg="si111.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> an approximate posterior density.</p>
        <p>To make this maximization easier one usually assumes <mml:math id="M13" altimg="si112.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> factorizes into approximate marginal posterior densities, over sets of parameters <mml:math id="M14" altimg="si113.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><disp-formula id="fd4"><label>(4)</label><mml:math id="M15" altimg="si114.gif" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> In statistical physics this is called a mean-field approximation <xref rid="b30" ref-type="bibr">[30]</xref>. This approximation replaces stochastic dependencies between the partitioned model variables by deterministic relationships between the sufficient statistics of their approximate marginal posterior density (see <xref rid="b31" ref-type="bibr">[31]</xref> and below).</p>
        <p>Under the mean-field approximation it is straightforward to show that the approximate marginal posterior densities satisfy the following set of equations <xref rid="b32" ref-type="bibr">[32]</xref>: <disp-formula id="fd5"><label>(5)</label><mml:math id="M16" altimg="si115.gif" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>⇒</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M17" altimg="si116.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <mml:math id="M18" altimg="si117.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math> are the sufficient statistics of the approximate marginal posterior density <mml:math id="M19" altimg="si118.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math>, and <mml:math id="M20" altimg="si119.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math> is a normalisation constant (i.e., partition function). We will call <mml:math id="M21" altimg="si120.gif" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> the variational energy. If the integral in Eq. <xref rid="fd5" ref-type="disp-formula">(5)</xref> is analytically tractable (e.g., through the use of conjugate priors) the above Boltzmann equation can be used as an update rule for the sufficient statistics. Iterating these updates then provides a simple deterministic optimization of the free-energy with respect to the approximate posterior density.</p>
      </sec>
      <sec id="sec2.2">
        <label>2.2</label>
        <title>The Laplace approximation</title>
        <p>When inverting realistic generative models, nonlinearities in the likelihood function generally induce posterior densities that are not in the conjugate-exponential family. This means that there are an infinite number of sufficient statistics of the approximate posterior density; rendering the integral in Eq. <xref rid="fd5" ref-type="disp-formula">(5)</xref> analytically intractable. The Laplace approximation is a useful and generic device, which can finesse this problem by reducing the set of sufficient statistics of the approximate posterior density to its first two moments. This means that each approximate marginal posterior density is further approximated by a Gaussian density: <disp-formula id="fd6"><label>(6)</label><mml:math id="M22" altimg="si121.gif" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>〉</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where the sufficient statistics <mml:math id="M23" altimg="si122.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> encode the posterior mean and covariance of the i-th approximate marginal posterior density. This (fixed-form) Gaussian approximation is derived from a second-order truncation of the Taylor series to the variational energy <xref rid="b28" ref-type="bibr">[28]</xref>: <disp-formula id="fd7"><label>(7)</label><mml:math id="M24" altimg="si124.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>arg</mml:mo><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M25" altimg="si125.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula><disp-formula><mml:math id="M26" altimg="si126.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mo>∖</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M27" altimg="si127.gif" display="block" overflow="scroll"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Eq. <xref rid="fd7" ref-type="disp-formula">(7)</xref> defines each variational energy and approximate marginal posterior density as explicit functions of the sufficient statistics of the other approximate marginal posterior densities. Under the VB-Laplace approximation, the iterative update of the sufficient statistics just requires the gradients and curvatures of <mml:math id="M28" altimg="si128.gif" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> (the log-joint density) with respect to the unknown variables of the generative model. We will refer to this approximate Bayesian inference scheme to as the VB-Laplace approach.</p>
      </sec>
      <sec id="sec2.3">
        <label>2.3</label>
        <title>Statistical Bayesian inference</title>
        <p>The VB-Laplace approach above provides an approximation <mml:math id="M29" altimg="si129.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> to the posterior density <mml:math id="M30" altimg="si130.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> over any unknown model parameter ϑ, given a set of observations y and a generative model m. Since this density summarizes our knowledge (from both the data and priors), we could use it as the basis for posterior inference; however, these densities generally tell us more than we need to know. In this section, we briefly discuss standard approaches for summarizing such distributions; i.e. Bayesian analogues for common frequentist techniques of point estimation and confidence interval estimation.<xref rid="fn4" ref-type="fn">4</xref> We refer the reader to <xref rid="b33" ref-type="bibr">[33]</xref> for further discussion.</p>
        <p>To obtain a point estimate <mml:math id="M31" altimg="si134.gif" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:math> of any unknown we need to select a summary of <mml:math id="M32" altimg="si135.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>, such as its mean or mode. These estimators can be motivated by different estimation losses, which, under the Laplace approximation, are all equivalent and reduce to the first-order posterior moment or posterior mean. The Bayesian analogue of a frequentist confidence interval is defined formally as follows: a <mml:math id="M33" altimg="si136.gif" display="inline" overflow="scroll"><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>% posterior confidence interval for ϑ is a subset C of the parameter space, such that its posterior probability is equal to <mml:math id="M34" altimg="si139.gif" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:math>; i.e., <mml:math id="M35" altimg="si140.gif" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>ϑ</mml:mi></mml:math>. Under the Laplace approximation, the optimal <mml:math id="M36" altimg="si141.gif" display="inline" overflow="scroll"><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>% posterior confidence interval is the interval whose bounds are the <mml:math id="M37" altimg="si142.gif" display="inline" overflow="scroll"><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math> and <mml:math id="M38" altimg="si143.gif" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math> quantiles of <mml:math id="M39" altimg="si144.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><xref rid="b34" ref-type="bibr">[34]</xref>. This means Bayesian confidence intervals are simple functions of the second-order posterior moment or posterior variance. We will demonstrate this later.</p>
        <p>In what follows, we introduce the class of generative models we are interested in; i.e. hierarchical stochastic nonlinear dynamic models. We then present update equations for each approximate marginal posterior density, starting with the straightforward updates (the parameters of the generative model) and finishing with the computationally more demanding updates of the time-varying hidden-states. These are derived from a variational extended Kalman–Rauch marginalization procedure <xref rid="b10" ref-type="bibr">[10]</xref>, which exploits the Laplace approximation above.</p>
      </sec>
    </sec>
    <sec id="sec3">
      <label>3</label>
      <title>Variational Bayesian treatment of stochastic DCMs</title>
      <p>In this section, we illustrate VB inference in the context of an important and broad class of generative models. These are stochastic dynamic causal models that combine nonlinear stochastic differential equations governing the evolution of hidden-states and a nonlinear observer function, to provide a nonlinear state-space model of data. Critically, neither the states nor the parameters of the state-space model functions are known. This means that the generative model is hierarchical, which induces a natural mean-field partition into states and parameters. This section describes stochastic DCMs and the update rules entailed by our VB-Laplace approach. In the next section, we illustrate the performance of the method in terms of model inversion, selection and time-series prediction using Monte Carlo simulations of chaotic systems.</p>
      <sec id="sec3.1">
        <label>3.1</label>
        <title>Stochastic DCMs and state-space models</title>
        <p>The generative model of a stochastic DCM rests on two equations: the observation equation, which links observed data <mml:math id="M40" altimg="si145.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> comprising T vector-samples to hidden-states <mml:math id="M41" altimg="si147.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> and a stochastic differential equation (SDE) governing the evolution of these hidden-states: <disp-formula id="fd8"><label>(8)</label><mml:math id="M42" altimg="si148.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula><mml:math id="M43" altimg="si149.gif" display="block" overflow="scroll"><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>ϖ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula> where φ and θ are unknown parameters of the observation function g and equation of motion (drift) a respectively; <mml:math id="M44" altimg="si154.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> are known exogenous inputs that drive the hidden-states or response; <mml:math id="M45" altimg="si155.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math> is a vector of random Gaussian measurement-noise; b may, in general, be a function of the states and time and <mml:math id="M46" altimg="si157.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ϖ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> denotes a Wiener process or state-noise that acts as a stochastic forcing term.</p>
        <p>A Wiener process is a continuous zero mean random process, whose variance grows as time increases; i.e. <disp-formula id="fd9"><label>(9)</label><mml:math id="M47" altimg="si158.gif" display="block" overflow="scroll"><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mrow><mml:mi>ϖ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext><mml:mspace width="2em" class="qquad"/><mml:mrow><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϖ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>ϖ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:mspace width="1em" class="quad"/><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mtext>.</mml:mtext></mml:math></disp-formula> The continuous-time formulation of the SDE in Eq. <xref rid="fd8" ref-type="disp-formula">(8)</xref> can also be written using the following (stochastic) integral formulation: <disp-formula id="fd10"><label>(10)</label><mml:math id="M48" altimg="si159.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Riemann integral</mml:mtext></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>ϖ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mtext>Ito’s integral</mml:mtext></mml:mrow></mml:munder></mml:math></disp-formula> where the second integral is a stochastic integral, whose peculiar properties led to the derivation of Ito stochastic calculus <xref rid="b35" ref-type="bibr">[35]</xref>. Eq. <xref rid="fd10" ref-type="disp-formula">(10)</xref> can be converted into a discrete-time analogue using local linearization, or Euler–Maruyama methods, yielding the standard first-order autoregressive process (AR(1)) form of nonlinear state-space models: <disp-formula id="fd11"><label>(11)</label><mml:math id="M49" altimg="si160.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula><mml:math id="M50" altimg="si161.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula> where <mml:math id="M51" altimg="si162.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℜ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math> is a Gaussian state-noise vector of variance <mml:math id="M52" altimg="si163.gif" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:math> and f is the evolution function given by: <disp-formula id="fd12"><label>(12)</label><mml:math id="M53" altimg="si165.gif" display="block" overflow="scroll"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>J</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>J</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>⟶</mml:mo></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mspace width="0.16667em"/><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Here J is the Jacobian of a and <mml:math id="M54" altimg="si168.gif" display="inline" overflow="scroll"><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:math> is the time interval between samples. The first line corresponds to the local linearization method <xref rid="b36" ref-type="bibr">[36]</xref>, and the second line instantiates the so-called Euler–Maruyama discretisation scheme <xref rid="b35" ref-type="bibr">[35]</xref>. The discrete-time variant of the state-space model yields the Gaussian likelihood and transition densities (where dependence on exogenous inputs and time is left implicit): <disp-formula id="fd13"><label>(13)</label><mml:math id="M55" altimg="si169.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M56" altimg="si170.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where σ (resp. α) is the precision of the measurement-noise <mml:math id="M57" altimg="si173.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> (resp. state-noise <mml:math id="M58" altimg="si174.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math>). From Eqs. <xref rid="fd10 fd13" ref-type="disp-formula">(10) and (13)</xref>, we note that the state-noise precision is <mml:math id="M59" altimg="si175.gif" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="normal"><mml:mi>Δ</mml:mi></mml:mstyle><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math>, where the transition density can be regarded as a prior that prescribes the likely evolution of hidden-states. From now on, we will assume the state-noise precision is independent of the hidden-states, which narrows the class of generative models we deal with (e.g. GARCH models, see <xref rid="b37" ref-type="bibr">[37]</xref>); volatility models, see e.g. <xref rid="b38" ref-type="bibr">[38]</xref>; bilinear stochastic models, see <xref rid="b39" ref-type="bibr">[39]</xref>.</p>
        <sec id="sec3.1.1">
          <label>3.1.1</label>
          <title>The predictive and sojourn densities</title>
          <p>The predictive density over the hidden-states is derived from the transition density given in Eq. <xref rid="fd13" ref-type="disp-formula">(13)</xref> through the iterated Chapman–Kolmogorov equation: <disp-formula id="fd14"><label>(14)</label><mml:math id="M60" altimg="si176.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∫</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mo>∫</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∫</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:math></disp-formula> This exploits the Markov property of the hidden-states. Despite the Gaussian form of the transition density, nonlinearities in the evolution function render the predictive density non-Gaussian. In particular, nonlinear evolution functions can lead to multimodal predictive densities.</p>
          <p>Under mild conditions, it is known that nonlinear stochastic systems as in Eq. <xref rid="fd8" ref-type="disp-formula">(8)</xref> are ergodic, i.e. their distribution becomes stationary <xref rid="b40" ref-type="bibr">[40]</xref>. The fact that a dynamical system is ergodic means that random state-noise completely change its stability properties. Its deterministic variant can have several stable fixed points or attractors, whereas, when there are stochastic forces, there is a unique steady state, which is approached in time by all other states. Any local instabilities of the deterministic system disappear, manifesting themselves only in the detailed form of the stationary density. This (equilibrium) stationary density, which we will call the <italic>sojourn density</italic>, is given by the predictive density when <mml:math id="M61" altimg="si177.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:math>. The sojourn density summarizes the long-term behaviour of the hidden-states: it quantifies the proportion of time spent by the system at each point in state-space (the so-called “sojourn time”). We will provide approximate solutions to the sojourn density below and use it in the next section for long-term prediction.</p>
        </sec>
        <sec id="sec3.1.2">
          <label>3.1.2</label>
          <title>The hierarchical generative model</title>
          <p>In a Bayesian setting, we also have to specify prior densities on the unknown parameters of the generative model m. Without loss of generality,<xref rid="fn5" ref-type="fn">5</xref> we assume Gaussian priors on the parameters, initial conditions of the hidden-states and Gamma priors on the precision hyperparameters: <disp-formula id="fd15"><label>(15)</label><mml:math id="M62" altimg="si179.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M63" altimg="si180.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M64" altimg="si181.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M65" altimg="si182.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M66" altimg="si183.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext>,</mml:mtext></mml:math></disp-formula> where <mml:math id="M67" altimg="si184.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub></mml:math> (<italic>resp.</italic> <mml:math id="M68" altimg="si185.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:math> and <mml:math id="M69" altimg="si186.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math>) are the prior mean and covariance of the observation parameters φ (<italic>resp.</italic> the evolution parameters θ and initial condition <mml:math id="M70" altimg="si189.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math>); and <mml:math id="M71" altimg="si190.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:math> (<italic>resp</italic>. <mml:math id="M72" altimg="si191.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:math>) are the prior shape and inverse scale parameters of the Gamma-variate precision of the measurement-noise (<italic>resp.</italic> state-noise).</p>
          <p><xref rid="fig1" ref-type="fig">Fig. 1</xref> shows the Bayesian dependency graph representing the ensuing generative model defined by Eqs. <xref rid="fd13 fd15" ref-type="disp-formula">(13) and (15)</xref>. The structure of the generative model is identical to that in <xref rid="b22" ref-type="bibr">[22]</xref>; the only difference is the nonlinearity in the observation and evolution functions (i.e. in the likelihood and transition densities). This class of generative model defines a stochastic DCM and generalizes both static convolution models (i.e. <mml:math id="M73" altimg="si192.gif" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math>) and non-stochastic DCMs (i.e. <mml:math id="M74" altimg="si193.gif" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:math>).</p>
        </sec>
      </sec>
      <sec id="sec3.2">
        <label>3.2</label>
        <title>The VB-Laplace update rules</title>
        <p>The mean-field approximation to the approximate posterior density, for the state-space model m described above is <disp-formula id="fd16"><label>(16)</label><mml:math id="M75" altimg="si195.gif" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Eq. <xref rid="fd5" ref-type="disp-formula">(5)</xref> provides the variational energy of each mean-field partition variable using the expectations of <mml:math id="M76" altimg="si196.gif" display="inline" overflow="scroll"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>, under the Markov blanket<xref rid="fn6" ref-type="fn">6</xref> of each of these variables. Using the mean-field partition in Eq. <xref rid="fd16" ref-type="disp-formula">(16)</xref>, these respective variational energies are (omitting constants for clarity): <disp-formula id="fd17"><label>(17)</label><mml:math id="M77" altimg="si197.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula><mml:math id="M78" altimg="si198.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula><mml:math id="M79" altimg="si199.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula><mml:math id="M80" altimg="si200.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula><mml:math id="M81" altimg="si201.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></disp-formula><disp-formula><mml:math id="M82" altimg="si202.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:math></disp-formula> We will use the VB-Laplace approximation (Eq. <xref rid="fd7" ref-type="disp-formula">(7)</xref>) to handle nonlinearities in the generative model when deriving approximate posterior densities, with the exception of the precision hyperparameters, for which we used free-form VB update rules.</p>
        <sec id="sec3.2.1">
          <label>3.2.1</label>
          <title>Updating the sufficient statistics of the hyperparameters</title>
          <p>Under the VB-Laplace approximation on the parameters and hidden-states, the approximate posterior density of the precision parameters <mml:math id="M83" altimg="si203.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> does not require any further approximation. This is because their prior is conjugate to a Gaussian likelihood. Therefore, their associated VB update rule is derived from the standard free-form approximate posterior density in Eq. <xref rid="fd5" ref-type="disp-formula">(5)</xref>.</p>
          <p>First, consider the free-form approximate posterior density of the measurement-noise precision. It can be shown that <mml:math id="M84" altimg="si204.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> has the form <mml:math id="M85" altimg="si205.gif" display="inline" overflow="scroll"><mml:mo>ln</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>ln</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:math>, which means <mml:math id="M86" altimg="si206.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> is a Gamma density <disp-formula id="fd18"><label>(18)</label><mml:math id="M87" altimg="si207.gif" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula> with shape and scale parameters <mml:math id="M88" altimg="si208.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub></mml:math> given by <disp-formula id="fd19"><label>(19)</label><mml:math id="M89" altimg="si209.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M90" altimg="si210.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msubsup><mml:mspace class="nbsp"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Here, <mml:math id="M91" altimg="si211.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> is a <mml:math id="M92" altimg="si212.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi></mml:math> matrix of prediction errors in measurement space; <mml:math id="M93" altimg="si213.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math>, and <mml:math id="M94" altimg="si214.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> denotes the <mml:math id="M95" altimg="si215.gif" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:math> instantaneous posterior covariance of the hidden-states (see below). A similar treatment shows that α is also <italic>a posteriori</italic> Gamma-distributed: <disp-formula id="fd20"><label>(20)</label><mml:math id="M96" altimg="si217.gif" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula> with shape and scale parameters <disp-formula id="fd21"><label>(21)</label><mml:math id="M97" altimg="si218.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M98" altimg="si219.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msubsup><mml:mspace class="nbsp"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <mml:math id="M99" altimg="si220.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> is the <mml:math id="M100" altimg="si221.gif" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:math> vector of estimated state-noise, <mml:math id="M101" altimg="si222.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> is the <mml:math id="M102" altimg="si223.gif" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:math> lagged posterior covariance of the hidden-states (see below).</p>
        </sec>
        <sec id="sec3.2.2">
          <label>3.2.2</label>
          <title>Updating the sufficient statistics of the parameters</title>
          <p>These updates follow the same procedure above, except that the VB-Laplace update rules for deriving the approximate posterior densities of the parameters are based on an iterative Gauss–Newton optimization of their respective variational energy (see Eqs. <xref rid="fd6 fd7" ref-type="disp-formula">(6) and (7)</xref>). Consider the variational energy of the observation parameters: <disp-formula id="fd22"><label>(22)</label><mml:math id="M103" altimg="si224.gif" display="block" overflow="scroll"><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> This quadratic form in φ yield the Gauss–Newton update rule for the mean of the approximate posterior density over observation parameters: <disp-formula id="fd23"><label>(23)</label><mml:math id="M104" altimg="si226.gif" display="block" overflow="scroll"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M105" altimg="si227.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula> where the gradient and curvatures are evaluated at the previous estimate of the approximate posterior mean <mml:math id="M106" altimg="si228.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub></mml:math>. Note that, in the following, we use condensed notations for mixed derivatives; i.e. <disp-formula id="fd24"><label>(24)</label><mml:math id="M107" altimg="si229.gif" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>vec</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mtext>,</mml:mtext><mml:mspace width="2em" class="qquad"/><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>vec</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Using a bilinear Taylor expansion of the observation function, Eq. <xref rid="fd23" ref-type="disp-formula">(23)</xref> can be implemented as: <disp-formula id="fd25"><label>(25)</label><mml:math id="M108" altimg="si230.gif" display="block" overflow="scroll"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M109" altimg="si231.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math></disp-formula> Similar considerations give the VB-Laplace update rules for the evolution parameters: <disp-formula id="fd26"><label>(26)</label><mml:math id="M110" altimg="si232.gif" display="block" overflow="scroll"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M111" altimg="si233.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula> which yields: <disp-formula id="fd27"><label>(27)</label><mml:math id="M112" altimg="si234.gif" display="block" overflow="scroll"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>vec</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M113" altimg="si235.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi><mml:mspace width="0.16667em"/><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math></disp-formula> Iterating Eqs. <xref rid="fd25 fd27" ref-type="disp-formula">(25) and (27)</xref> implements a standard Gauss–Newton scheme for optimizing the variational energy of the observation and evolution parameters. To ensure convergence, we halve the size of the Gauss–Newton update until the variational energy increases. Under certain mild assumptions, this regularized Gauss–Newton scheme is guaranteed to converge <xref rid="b41" ref-type="bibr">[41]</xref>.</p>
        </sec>
        <sec id="sec3.2.3">
          <label>3.2.3</label>
          <title>Updating the sufficient statistics of the hidden-states</title>
          <p>The last approximate posterior density is <mml:math id="M114" altimg="si236.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>. This approximate posterior could be obtained by treating the time-series of hidden-states <mml:math id="M115" altimg="si237.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> as a single finite-dimensional vector and using the VB-Laplace approximation with an expansion of the evolution and observation functions around the last mean. However, it is computationally more expedient to exploit the Markov properties of the dynamics and assemble the sufficient statistics <mml:math id="M116" altimg="si238.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math> and <mml:math id="M117" altimg="si239.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math> sequentially, using a VB-Laplace variant of the extended Kalman–Rauch smoother <xref rid="b10" ref-type="bibr">[10]</xref>. These probabilistic filters evaluate the (instantaneous) marginals, <mml:math id="M118" altimg="si240.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> time point by time point, as opposed to the full joint posterior density over the whole time sequence, <mml:math id="M119" altimg="si241.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>. They are approximate solutions to the Kushner–Pardoux partial differential equations that describe the instantaneous evolution of the marginal posterior density on the hidden-states.</p>
          <p>Algorithmically, the VB-Laplace Kalman–Rauch marginalization procedure is divided into two passes that propagate (in time) the first and second-order moments of the approximate posterior density. These propagation equations require only the gradients and mixed derivatives of the evolution and observation functions. The two passes comprise a forward pass (which furnishes the approximate filtering density, which can be used to derive an on-line version of the algorithm) and a backward pass (which derives the approximated posterior density from the approximate filtering density).</p>
          <sec id="sec3.2.3.1">
            <label>3.2.3.1</label>
            <title>Forward pass</title>
            <p>The forward pass entails two steps (prediction and update) that are alternated from <mml:math id="M120" altimg="si242.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math> to <mml:math id="M121" altimg="si243.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:math>: The <italic>prediction step</italic> is derived from the Chapman–Kolmogorov belief propagation Eq. <xref rid="fd14" ref-type="disp-formula">(14)</xref>: <disp-formula id="fd28"><label>(28)</label><mml:math id="M122" altimg="si244.gif" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>⟶</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <mml:math id="M123" altimg="si245.gif" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> is the current approximate predictive density and <mml:math id="M124" altimg="si246.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> is the last VB-Laplace approximate filtering density (see above update step). Under the VB-Laplace approximation, the prediction step is given by the following Gauss–Newton update for the predicted mean and covariance: <disp-formula id="fd29"><label>(29)</label><mml:math id="M125" altimg="si247.gif" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>standard Gauss</mml:mi></mml:mstyle><mml:mtext>–</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>Newton EKF prediction</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>mean</mml:mi></mml:mstyle><mml:mtext>-</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>field perturbation term</mml:mi></mml:mstyle></mml:mrow></mml:munder></mml:math></disp-formula><disp-formula><mml:math id="M126" altimg="si248.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula><disp-formula><mml:math id="M127" altimg="si249.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>mean</mml:mi></mml:mstyle><mml:mtext>-</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>field perturbation term</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> This VB-Laplace approximation to the predictive density differs from the traditional extended Kalman filter because it accounts for the uncertainty in the evolution parameters θ (mean-field terms in Eq. <xref rid="fd29" ref-type="disp-formula">(29)</xref>). This is critical when making predictions of highly nonlinear systems (as we will see in the next section) with unknown parameters. The <italic>update step</italic> can be written as follows: <disp-formula id="fd30"><label>(30)</label><mml:math id="M128" altimg="si251.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mo>exp</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mover><mml:mrow><mml:mo>⟶</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Again, under the VB-Laplace approximation, the update rule for the sufficient statistics of the approximate filtering density is given by: <disp-formula id="fd31"><label>(31)</label><mml:math id="M129" altimg="si252.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>standard Gauss</mml:mi></mml:mstyle><mml:mtext>-</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>Newton EKF update</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munderover><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>mean</mml:mi></mml:mstyle><mml:mtext>-</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>field perturbation term</mml:mi></mml:mstyle></mml:mrow></mml:munder></mml:math></disp-formula><disp-formula><mml:math id="M130" altimg="si253.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>mean</mml:mi></mml:mstyle><mml:mtext>-</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>field perturbation term</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math></disp-formula></p>
          </sec>
          <sec id="sec3.2.3.2">
            <label>3.2.3.2</label>
            <title>Backward pass</title>
            <p>In its parallel implementation (two-filter Kalman–Rauch–Striebel smoother), the backward pass also requires two steps, which are alternated from <mml:math id="M131" altimg="si254.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:math> to <mml:math id="M132" altimg="si255.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math>. The first is a β-<italic>message passing</italic> scheme: <disp-formula id="fd32"><label>(32)</label><mml:math id="M133" altimg="si257.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>⟶</mml:mo></mml:mrow><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> Where a local VB-Laplace approximation ensures (omitting constants): <disp-formula id="fd33"><label>(33)</label><mml:math id="M134" altimg="si258.gif" display="block" overflow="scroll"><mml:mo>ln</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> leading to the following mean and covariance backward propagation equation: <disp-formula id="fd34"><label>(34)</label><mml:math id="M135" altimg="si259.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mspace width="0.2777em"/><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mspace width="0.16667em"/><mml:mspace width="0.2777em"/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M136" altimg="si260.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula><disp-formula><mml:math id="M137" altimg="si261.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Note that the β-message is not a density over the hidden-states; it has the form of a likelihood function. More precisely, it is the approximate likelihood of the current hidden-states with respect to all future observations. It contains the information discarded by the forward pass, relative to the approximate posterior density. The latter is given by combining the output of the forward pass (updated density) with the β-message (see below) giving the <mml:math id="M138" altimg="si264.gif" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:math>-<italic>message passing</italic> scheme: <disp-formula id="fd35"><label>(35)</label><mml:math id="M139" altimg="si265.gif" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mover><mml:mrow><mml:mo>⟶</mml:mo></mml:mrow><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> with, by convention <mml:math id="M140" altimg="si266.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math> and: <disp-formula id="fd36"><label>(36)</label><mml:math id="M141" altimg="si267.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M142" altimg="si268.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula> where the necessary sufficient statistics are given in Eqs. <xref rid="fd29 fd31 fd34" ref-type="disp-formula">(29), (31) and (34)</xref>. These specify the instantaneous posterior density on the hidden-states.</p>
            <p>Eqs. <xref rid="fd29 fd31 fd34 fd36" ref-type="disp-formula">(29), (31), (34) and (36)</xref> specify the VB-Laplace update rules for the sufficient statistics of the approximate posterior of the hidden-states. These correspond to a Gauss–Newton scheme for optimizing their variational energy, where the Gauss–Newton increment <mml:math id="M143" altimg="si269.gif" display="inline" overflow="scroll"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> is simply the difference between the result of Eq. <xref rid="fd36" ref-type="disp-formula">(36)</xref> and the previous approximate mean.</p>
            <p>Finally, we need the expression for the lagged posterior covariance <mml:math id="M144" altimg="si270.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> to update the evolution, observation and precision parameters (see Eqs. <xref rid="fd22 fd25" ref-type="disp-formula">(22) and (25)</xref>). This is derived from the following joint density <xref rid="b22" ref-type="bibr">[22]</xref>: <disp-formula id="fd37"><label>(37)</label><mml:math id="M145" altimg="si271.gif" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mover><mml:mrow><mml:mo>⟶</mml:mo></mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mo>exp</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:munderover></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where the last line follows from the VB-Laplace approximation. As in the forward step of the VB-Laplace Kalman filter, the sufficient statistics of this approximate joint posterior density can be derived explicitly from the gradients of the evolution function: <disp-formula id="fd38"><label>(38)</label><mml:math id="M146" altimg="si272.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula> where <mml:math id="M147" altimg="si273.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> and <mml:math id="M148" altimg="si274.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> are given in Eqs. <xref rid="fd26 fd31" ref-type="disp-formula">(26) and (31)</xref>, and the gradients are evaluated at the mode <mml:math id="M149" altimg="si275.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math>.</p>
          </sec>
          <sec id="sec3.2.3.3">
            <label>3.2.3.3</label>
            <title>Initial conditions</title>
            <p>The approximate posterior density over the initial conditions is obtained from the usual VB-Laplace approach. The update rule for the Gauss–Newton optimization of the variational energy of the initial conditions is<xref rid="fn7" ref-type="fn">7</xref>: <disp-formula id="fd39"><label>(39)</label><mml:math id="M150" altimg="si276.gif" display="block" overflow="scroll"><mml:mi>Δ</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ς</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M151" altimg="si277.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math></disp-formula></p>
          </sec>
        </sec>
        <sec id="sec3.2.4">
          <label>3.2.4</label>
          <title>Evaluation of the free-energy</title>
          <p>Under the mean-field approximation, the free-energy evaluation requires the sum of the entropy of each approximate marginal posterior density. Except for the hidden-states, evaluating these are relatively straightforward under the Laplace assumption. However, due to the use of the Kalman–Rauch marginalization scheme in the derivation of the posterior <mml:math id="M152" altimg="si278.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>, the calculation of the joint entropy over the hidden-states requires special consideration. First, let us note that the joint <mml:math id="M153" altimg="si279.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> factorizes over instantaneous transition density (Chapman–Kolmogorov equation): <disp-formula id="fd40"><label>(40)</label><mml:math id="M154" altimg="si280.gif" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext>.</mml:mtext></mml:math></disp-formula> Therefore, its entropy decomposes into: <disp-formula id="fd41"><label>(41)</label><mml:math id="M155" altimg="si281.gif" display="block" overflow="scroll"><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo>∫</mml:mo><mml:mo>ln</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>∫</mml:mo><mml:mo>ln</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mo>ln</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mo>ln</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mo>ln</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where the matrix determinants are evaluated during the backward pass (when forming the <mml:math id="M156" altimg="si282.gif" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mi>β</mml:mi></mml:math>-messages) and the posterior lagged covariance is given by Eq. <xref rid="fd38" ref-type="disp-formula">(38)</xref>.</p>
        </sec>
        <sec id="sec3.2.5">
          <label>3.2.5</label>
          <title>Predictive and sojourn densities</title>
          <p>Having identified the model, one may want to derive predictions about the evolution of the system. This requires the computation of a predictive density; i.e. the propagation of the posterior density over the hidden-states from the last observation. The predictive density can be accessed through the Chapman–Kolmogorov equation (Eq. <xref rid="fd17" ref-type="disp-formula">(17)</xref>). However, the requisite integrals do not have an analytical solution. To finesse this problem we can extend our VB-Laplace approach to derive an approximation to the predictive density: <disp-formula id="fd42"><label>(42)</label><mml:math id="M157" altimg="si283.gif" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mo>∫</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∫</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:mo>exp</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mo>∫</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> for any <mml:math id="M158" altimg="si284.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math>. Here, the last line motivates a recursive Laplace approximation to the predictive density. As above, this is used to form a propagation equation for the mean and covariance of the approximate predictive density: <disp-formula id="fd43"><label>(43)</label><mml:math id="M159" altimg="si285.gif" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula><mml:math id="M160" altimg="si286.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula><disp-formula><mml:math id="M161" altimg="si287.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> Eq. <xref rid="fd43" ref-type="disp-formula">(43)</xref> is used recursively in time to yield a Laplace approximation to the predictive density over hidden-states in the future. Similarly, we can derive an approximate predictive density for the data: <disp-formula id="fd44"><label>(44)</label><mml:math id="M162" altimg="si288.gif" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mo>∫</mml:mo><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>exp</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>φ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> which leads to the following moment propagation equations: <disp-formula id="fd45"><label>(45)</label><mml:math id="M163" altimg="si289.gif" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula><mml:math id="M164" altimg="si290.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula><disp-formula><mml:math id="M165" altimg="si291.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>˜</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi><mml:mi>∂</mml:mi><mml:mi>φ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> These equations are very similar to the predictive step of the forward pass of the VB-Laplace Kalman filter (Eq. <xref rid="fd29" ref-type="disp-formula">(29)</xref>). They can be used for time-series prediction on hidden-states and measurements by iterating from <mml:math id="M166" altimg="si292.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math> to <mml:math id="M167" altimg="si293.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>τ</mml:mi></mml:math>.</p>
          <p>From the approximate predictive densities we can derive the approximate sojourn distribution over both state and measurement spaces. By definition, the sojourn distribution is the stationary density of the Markov chain, i.e. it is invariant under the transition density: <disp-formula id="fd46"><label>(46)</label><mml:math id="M168" altimg="si294.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>d</mml:mi></mml:mstyle><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:math></disp-formula> Estimating the sojourn density from partial observations of the system is a difficult inferential problem (see e.g. <xref rid="b42" ref-type="bibr">[42]</xref>). Here, we relate the sojourn distribution to the predictive density via the ergodic decomposition theorem <xref rid="b29" ref-type="bibr">[29]</xref>: <disp-formula id="fd47"><label>(47)</label><mml:math id="M169" altimg="si295.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>lim</mml:mo></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.2777em"/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <mml:math id="M170" altimg="si296.gif" display="inline" overflow="scroll"><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:math> is the number of predicted time steps and <mml:math id="M171" altimg="si297.gif" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> is the Laplace approximation of the predictive density at time <mml:math id="M172" altimg="si298.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math> (Eqs. <xref rid="fd42 fd43" ref-type="disp-formula">(42) and (43)</xref>). Eq. <xref rid="fd47" ref-type="disp-formula">(47)</xref> subsumes three approximations: (i) the system is ergodic, (ii) a truncation of the infinite series of the ergodic decomposition theorem and (iii) a Laplace approximation to the predictive density. Effectively, Eq. <xref rid="fd47" ref-type="disp-formula">(47)</xref> represents a mixture of Gaussian densities approximation to the sojourn distribution. It is straightforward to show that the analogous sojourn distribution in measurement space is given by: <disp-formula id="fd48"><label>(48)</label><mml:math id="M173" altimg="si299.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where <mml:math id="M174" altimg="si300.gif" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> is the Laplace approximation to the measurement predictive density at time <mml:math id="M175" altimg="si301.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math> (Eqs. <xref rid="fd44 fd45" ref-type="disp-formula">(44) and (45)</xref>).</p>
        </sec>
      </sec>
    </sec>
    <sec id="sec4">
      <label>4</label>
      <title>Evaluations of the VB-Laplace scheme</title>
      <p>In this section, we try to establish the validity and accuracy of the VB-Laplace scheme using four complementary approaches:</p>
      <p>
        <list list-type="simple">
          <list-item>
            <label>•</label>
            <p>Comparative evaluations with the extended Kalman filter (EKF): We compared the estimation error of the VB-Laplace and EKF estimators in terms of estimation efficiency, when applied to systems with nonlinear evolution and observation functions.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Bayesian model comparison: The application of the proposed scheme may include the identification of different forms or structures of state-space models subtending observed data. We therefore asked whether models whose structure could have generated the data are <italic>a posteriori</italic> more plausible than models that could not. To address this question we used the free-energy as a bound approximation to the log-model-evidence to compute an approximate posterior density on model space.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Quantitative evaluation of asymptotic efficiency: Since our VB-Laplace approach provides us with an approximate posterior density, we assessed whether the VB estimator becomes optimal with large sample size.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Assessment of time-series prediction: We explored the potential advantages and caveats in using the VB-Laplace approach for time-series prediction.</p>
          </list-item>
        </list>
      </p>
      <p>These analyses were applied to three well-known low-dimensional nonlinear stochastic systems; a double-well potential, Lorenz attractor and van der Pol oscillator. The dynamical behaviours of these systems cover diverse but important phenomena, ranging from limit cycles to strange attractors. These systems are described qualitatively below and their equations of motion are given in <xref rid="tbl1" ref-type="table">Table 1</xref>.</p>
      <p>After having reviewed the dynamical properties of these systems, we will summarize the Bayesian decision theory used to quantify the performance of the method. Finally, we describe the Monte Carlo simulations used to compare VB-Laplace to the standard EKF, perform model comparison, assess asymptotic efficiency and characterise the prediction capabilities of VB-Laplace approach.</p>
      <sec id="sec4.1">
        <label>4.1</label>
        <title>Simulated systems</title>
        <sec id="sec4.1.1">
          <label>4.1.1</label>
          <title>Double-well</title>
          <p>The double-well potential system models a dissipative system, whose potential energy is a quadratic (double-well) function of position. As a consequence, the system is bistable with two basins of attraction to two stable fixed points, <mml:math id="M176" altimg="si302.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> and <mml:math id="M177" altimg="si303.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>. In its deterministic variant, the system ends up spiralling around one or the other attractors, depending on its initial conditions and the magnitude of a damping force or dissipative term. Because we consider state-noise, the stochastic DCM can switch (tunnel) from one basin to the other, which leads to itinerant behaviour; this is why the double-well system can be used to model bistable perception <xref rid="b43" ref-type="bibr">[43]</xref>.</p>
          <p><xref rid="fig2" ref-type="fig">Fig. 2</xref> shows the double-well potential and a sample path of the system (as a function of time in state-space; <mml:math id="M178" altimg="si304.gif" display="inline" overflow="scroll"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math>). In this example, the evolution parameters were <mml:math id="M179" altimg="si305.gif" display="inline" overflow="scroll"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup></mml:math>, the precision of state-noise was <mml:math id="M180" altimg="si306.gif" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math> and the initial conditions were picked at random. The path shows two jumps over the potential barrier (points <mml:math id="M181" altimg="si307.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> and <mml:math id="M182" altimg="si308.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math>), the first being due primarily to kinetic energy (<mml:math id="M183" altimg="si309.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>), and the second to state-noise (<mml:math id="M184" altimg="si310.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math>). Between these two, the path spirals around the stable attractors.</p>
        </sec>
        <sec id="sec4.1.2">
          <label>4.1.2</label>
          <title>Lorenz attractor</title>
          <p>The Lorenz attractor was originally proposed as a simplified version of the Navier–Stokes equations, in the context of meteorological fluid dynamics <xref rid="b44" ref-type="bibr">[44]</xref>. The Lorenz attractor models the autonomous formation of convection cells, whose dynamics are parameterized using three parameters; <mml:math id="M185" altimg="si311.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>: the Rayleigh number, which characterizes the fluid viscosity, <mml:math id="M186" altimg="si312.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math>: the Prandtl number which measures the efficacy of heat transport through the boundary layer and <mml:math id="M187" altimg="si313.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math>: a dissipative coefficient. When the Rayleigh number is bigger than one, the system has two symmetrical fixed points <mml:math id="M188" altimg="si314.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:mo>,</mml:mo><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math>, which act as a pair of local attractors. For certain parameter values; e.g., <mml:math id="M189" altimg="si315.gif" display="inline" overflow="scroll"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>28</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup></mml:math>, the Lorenz attractor exhibits chaotic behaviour on a butterfly-shaped strange attractor. For almost any initial conditions (other than the fixed points), the trajectory unfolds on the attractor. The path begins spiralling onto one wing and then jumps to the other and back in a chaotic way. The stochastic variant of the Lorenz system possesses more than one random attractor. However, with the parameters above, the sojourn distribution settles around the deterministic strange attractor <xref rid="b45" ref-type="bibr">[45]</xref>.</p>
          <p><xref rid="fig3" ref-type="fig">Fig. 3</xref> shows a sample path of the Lorenz system (<mml:math id="M190" altimg="si316.gif" display="inline" overflow="scroll"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math>). In this example, the evolution parameters were set as above, the precision of state-noise was <mml:math id="M191" altimg="si317.gif" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math> and the initial conditions were picked at random. The path shows four jumps from one wing to the other.</p>
        </sec>
        <sec id="sec4.1.3">
          <label>4.1.3</label>
          <title>van der Pol oscillator</title>
          <p>The van der Pol oscillator has been used as the basis for neuronal action potential models <xref rid="b46 b47" ref-type="bibr">[46,47]</xref>. It is a non-conservative oscillator with nonlinear damping parameterized by a single parameter, <mml:math id="M192" altimg="si318.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>. It is a stable system for all initial conditions and dampening parameter. When <mml:math id="M193" altimg="si319.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> is positive, the system enters a limit cycle. <xref rid="fig4" ref-type="fig">Fig. 4</xref> shows a sample path (<mml:math id="M194" altimg="si320.gif" display="inline" overflow="scroll"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math>) of the van der Pol oscillator. In this example, the evolution parameter was <mml:math id="M195" altimg="si321.gif" display="inline" overflow="scroll"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math>, the precision of state-noise was <mml:math id="M196" altimg="si322.gif" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math> and the initial conditions were picked at random. The path exhibits four periods of a quasi-limit cycle after a short transient (point <mml:math id="M197" altimg="si323.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>).</p>
        </sec>
      </sec>
      <sec id="sec4.2">
        <label>4.2</label>
        <title>Estimation loss and statistical efficiency</title>
        <p>The statistical efficiency of an estimator is a decision theoretic measure of accuracy <xref rid="b34" ref-type="bibr">[34]</xref>. Given the true parameters of the generative model and their estimator, we can evaluate the squared error loss <mml:math id="M198" altimg="si324.gif" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> with: <disp-formula id="fd49"><label>(49)</label><mml:math id="M199" altimg="si325.gif" display="block" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula> where <mml:math id="M200" altimg="si326.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math> is the ith element of the estimator of <mml:math id="M201" altimg="si328.gif" display="inline" overflow="scroll"><mml:mi>ϑ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math>. The SEL is a standard estimation error measure, whose <italic>a posteriori</italic> expectation is minimized by the posterior mean. In Bayesian decision theoretic terms, this means that an estimator based on the posterior mean; <mml:math id="M202" altimg="si329.gif" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math> is optimal with respect to squared error loss.</p>
        <p>It can be shown that the expected SEL under the joint density <mml:math id="M203" altimg="si330.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> is bounded by the Bayesian Fisher information: <disp-formula id="fd50"><label>(50)</label><mml:math id="M204" altimg="si331.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math></disp-formula> Eq. <xref rid="fd50" ref-type="disp-formula">(50)</xref> gives the so-called Bayesian Cramer–Rao bound, which quantifies the minimum average SEL, under the generative model m<xref rid="b48" ref-type="bibr">[48]</xref>. By definition, the proximity to the Cramer–Rao bound measures the efficiency of an approximate Bayesian estimator. The efficiency of the method is related to the amount of available information, which, when the observation function is the identity mapping (<mml:math id="M205" altimg="si333.gif" display="inline" overflow="scroll"><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math>), is proportional to the sample size T. In this case, asymptotic efficiency is achieved whenever estimators attain the Cramer–Rao bound when <mml:math id="M206" altimg="si335.gif" display="inline" overflow="scroll"><mml:mi>T</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:math>.</p>
        <p>In addition to efficiency, we also evaluated the approximate posterior confidence intervals. As noted above, under the Laplace assumption, this reduces to assessing the accuracy of the posterior covariance. In decision theoretic terms, confidence interval evaluation, under the Laplace approximation, is equivalent to squared error loss estimation, since: <disp-formula id="fd51"><label>(51)</label><mml:math id="M207" altimg="si336.gif" display="block" overflow="scroll"><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>tr</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula> where the <italic>a posteriori</italic> expected loss <mml:math id="M208" altimg="si337.gif" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> is the Bayesian estimator of SEL. <mml:math id="M209" altimg="si338.gif" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> thus provides a self-consistency measure that is related to confidence intervals (see <xref rid="b34" ref-type="bibr">[34]</xref>).</p>
      </sec>
      <sec id="sec4.3">
        <label>4.3</label>
        <title>Comparing VB-Laplace and EKF</title>
        <p>The EKF provides an approximation to the posterior density on the hidden-states of the state-space model given in Eq. <xref rid="fd11" ref-type="disp-formula">(11)</xref>. The standard variant of the EKF uses a forward pass, comprising a prediction and an update step (see e.g. <xref rid="b16" ref-type="bibr">[16]</xref>): <disp-formula id="fd52"><label>(52)</label><mml:math id="M210" altimg="si339.gif" display="block" overflow="scroll"><mml:mtext>Prediction step:</mml:mtext><mml:mspace class="nbsp"/><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M211" altimg="si340.gif" display="block" overflow="scroll"><mml:mtext>Update step:</mml:mtext><mml:mspace class="nbsp"/><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>T</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> These two steps are iterated from <mml:math id="M212" altimg="si341.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math> to <mml:math id="M213" altimg="si342.gif" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:math>. It is well known that both model misspecification (e.g. using incorrect parameters and hyperparameters) and local linearization can introduce biases and errors in the covariance calculations that degrade EKF performance <xref rid="b49" ref-type="bibr">[49]</xref>.</p>
        <p>We conducted a series of fifty Monte Carlo simulations for each dynamical system. The observation function for all three systems was taken to be the following sigmoid mapping: <disp-formula id="fd53"><label>(53)</label><mml:math id="M214" altimg="si343.gif" display="block" overflow="scroll"><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula> where the constants <mml:math id="M215" altimg="si344.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> were chosen to ensure changes in hidden-states were of sufficient amplitude to cause nonlinear effects (i.e. saturation) in measurement space. <xref rid="tbl2" ref-type="table">Table 2</xref> shows the different simulation and prior parameters for the dynamical systems we examined.</p>
        <p>Note that the standard EKF cannot estimate parameters or hyperparameters. Therefore, we have used two EKF versions: EKF1 used the prior means of the parameters (<mml:math id="M216" altimg="si345.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math>), and EKF2 uses their posterior mean from the VB-Laplace algorithm (<mml:math id="M217" altimg="si346.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math>).</p>
        <p><xref rid="fig5 fig6 fig7" ref-type="fig">Figs. 5–7</xref> show the results of the comparative evaluations of VB-Laplace, EKF1 and EKF2, where these and subsequent figures use the same format:</p>
        <p>
          <list list-type="simple">
            <list-item>
              <label>•</label>
              <p>Top-left: first- and second-order moments of the approximate predictive density on the observations (and simulated data) as given by VB-Laplace.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Bottom-left: first- and second-order moments of the approximate posterior density on the hidden-states (and simulated hidden-states) as given by VB-Laplace.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Top-right: first- and second-order moments of the approximate posterior density on the hidden-states (and simulated hidden-states) as given by EKF1.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Bottom-right: first- and second-order moments of the approximate posterior density on the hidden-states (and simulated hidden-states) as given by the EKF2.</p>
            </list-item>
          </list>
        </p>
        <p>It can be seen that despite the nonlinear observation and evolution functions, both VB-Laplace and EKF2 estimate the hidden-states accurately. Furthermore, they both provide reliable posterior confidence intervals. This is not the case for the EKF1, which, in these examples, exhibits significant estimation errors.</p>
        <p>We computed the SEL score on the hidden-states for the three approaches. The Monte Carlo distributions of this score are given in <xref rid="fig8" ref-type="fig">Fig. 8</xref>. There was always a significant difference (one-sample paired t-test, 5% confidence level, df = 49) between the VB-Laplace and the EKF1 approaches, with the VB-Laplace method exhibiting greater efficiency. This difference is greatest for the van der Pol system, in which the nonlinearity in the observation function was the strongest. There was a (less) significant difference between the VB-Laplace and the EKF2 approaches for the Lorenz and the van der Pol systems; VB-Laplace is more (respectively less) efficient than the EKF2 when applied to the van der Pol (respectively Lorenz) system. <xref rid="tbl3" ref-type="table">Table 3</xref> summarizes these results. It is also worth reporting that 11% of the Monte Carlo simulations led to numerical divergences of the EKF2 algorithm for the van der Pol system (these were not used for when computing the paired t-test).</p>
        <p>To summarize, the EKF seems sensitive to model misspecification. This is why the EKF1 (relying on prior means) performs badly when compared to the EKF2 (relying on the VB-Laplace posterior means). This is not the case for the VB-Laplace approach, which seems more robust to model misspecification. In addition, the EKF seems very sensitive to noise in presence of strong nonlinearity (cf. numerical divergence of EKF2 for the van der Pol system). It could be argued that the good estimation performances achieved by EKF2 are inherited from the VB-Laplace through the posterior parameter estimates and implicit learning of the structure of the hidden stochastic systems.</p>
      </sec>
      <sec id="sec4.4">
        <label>4.4</label>
        <title>Assessing VB-Laplace model comparison</title>
        <p>Here, we asked whether one can identify the structure of the hidden stochastic system using Bayesian model comparison based on the free-energy. We assessed whether models whose structure could have generated the data are <italic>a posteriori</italic> more plausible than models that could not. To do this, we conducted another 50 Monte Carlo simulations for each of the three systems. For each of these simulations, we compared two classes of models: the model used to generate the simulated data (referred to as the “true” model) and a so-called “generic” model, which was the same as the true model except for the form of the evolution function: <disp-formula id="fd54"><label>(54)</label><mml:math id="M218" altimg="si349.gif" display="block" overflow="scroll"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula><mml:math id="M219" altimg="si350.gif" display="block" overflow="scroll"><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msub></mml:math></disp-formula> where the elements of the matrices <mml:math id="M220" altimg="si351.gif" display="inline" overflow="scroll"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math> were unknown and estimated using VB-Laplace. The number of evolution parameters θ depends on the number of hidden-states: <mml:math id="M221" altimg="si353.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>n</mml:mi><mml:mi>!</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>!</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>. This evolution function can be regarded as a second-order Taylor expansion of the equations of motion; <mml:math id="M222" altimg="si354.gif" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>. This means that the generic model recover the dynamical structure of the Lorenz system, which is a generic model with the following parameters: <disp-formula id="fd55"><label>(55)</label><mml:math id="M223" altimg="si355.gif" display="block" overflow="scroll"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>10</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>28</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>8</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mtext>,</mml:mtext><mml:mspace width="2em" class="qquad"/><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:math></disp-formula> However, the generic model cannot capture the dynamical structure of the van Der Pol and double-well systems (cf. <xref rid="tbl1" ref-type="table">Table 1</xref>). The specifications of the generative models are identical to those given in <xref rid="tbl2" ref-type="table">Table 2</xref>, except for the “generic” generative model, for which the priors on the evolution parameters are given in <xref rid="tbl4" ref-type="table">Table 4</xref>.</p>
        <p><xref rid="fig9 fig10 fig11" ref-type="fig">Figs. 9–11</xref> compare the respective VB-Laplace inversion of the true and the generic generative models; specifically</p>
        <p>
          <list list-type="simple">
            <list-item>
              <label>•</label>
              <p>Top-left: first- and second-order moments of the approximate predictive density on the observations (and simulated data) under the true model.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Bottom-left: first- and second-order moments of the approximate posterior density on the hidden-states (and simulated hidden-states) under the true model.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Top-right: first- and second-order moments of the approximate predictive density on the observations (and the simulated data) under the generic model.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Bottom-right: first- and second-order moments of the approximate posterior density on the hidden-states (and simulated hidden-states) under the generic model.</p>
            </list-item>
          </list>
        </p>
        <p>It can be seen from these figures that the Lorenz system’s hidden-states are estimated well under both the true and generic models. This is not the case for the van der Pol and the double-well systems, for which the estimation of the hidden-states under the generic model deviates significantly from the simulated time-series. Note also that the posterior confidence intervals reflect the mismatch between the simulated and estimated hidden-states. This is most particularly prominent for the van der Pol system (<xref rid="fig11" ref-type="fig">Fig. 11</xref>), where the posterior variances increase enormously, whenever the observations fall on the nonlinear (saturation) domain of the sigmoid observation function. Nevertheless, for both true and generic models, the data were predicted almost perfectly for all three systems: the measured data always lie within the confidence intervals of the approximate predictive densities.</p>
        <p>The VB-Laplace approach provides us with the free-energy of the true and generic models for each Monte Carlo simulation. Its empirical Monte Carlo distribution for each class of systems is shown in <xref rid="fig12" ref-type="fig">Fig. 12</xref>. In addition, for each simulation, we computed the standard “goodness-of-fit” sum of squared error <mml:math id="M224" altimg="si356.gif" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math>, which is the basis for any non-Bayesian statistical model comparison. Finally, we computed the estimation loss (SEL) on the hidden-states, which cannot be obtained in real applications. These performance measures allowed us to test for significant differences between the true and generic models in terms of their free-energy, SSE and SEL. The results are summarized in <xref rid="tbl5" ref-type="table">Table 5</xref>.</p>
        <p>Unsurprisingly, the estimation loss (SEL) was always significantly smaller for the true model. This means that the hidden-states were always estimated more accurately under the true, relative to the generic model. More surprisingly (because the fits looked equally accurate), there was always a significant difference between the true and generic models, in terms of their goodness-of-fit (SSE). However had we based our model comparison on this index, we would have favoured the generic model over the true van der Pol system.</p>
        <p>There was always a significant difference between the true and generic models in terms of free-energy. Model comparison based on the free-energy would have led us to select the true against the generic model for the Double-well and van der Pol — but not for the Lorenz system. This is what we predicted, because the generic model covers the dynamical structure of the Lorenz system. <xref rid="fig13" ref-type="fig">Fig. 13</xref> shows the Monte Carlo average of the posterior means of both matrices A and B, given data generated by the Lorenz system. The inferred structure is very similar to the true system. Note however; (i) the global rescaling of the Monte Carlo average of the A matrix relative to its Lorenz analogue and (ii) the slight ambiguity regarding the contributions of the nonlinear <mml:math id="M225" altimg="si360.gif" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math> and <mml:math id="M226" altimg="si361.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math> effects on <mml:math id="M227" altimg="si362.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math>. The global rescaling is due to the “minimum norm” priors imposed on the evolution parameters of the generic model. The fact that the nonlinear effects on <mml:math id="M228" altimg="si363.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math> are shared between the quadratic <mml:math id="M229" altimg="si364.gif" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math> and <mml:math id="M230" altimg="si365.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math> interaction terms is due to the strong correlation between the time-series of <mml:math id="M231" altimg="si366.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> and <mml:math id="M232" altimg="si367.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math> (see e.g. <xref rid="fig3 fig6 fig10" ref-type="fig">Figs. 3, 6 and 10</xref>). We discuss the results of this model comparison below.</p>
      </sec>
      <sec id="sec4.5">
        <label>4.5</label>
        <title>Assessing the asymptotic efficiency of the VB-Laplace approach</title>
        <p>In this third set of simulations, we asked whether the VB-Laplace estimation accuracy is close to optimal and assessed the quality of the posterior confidence intervals, when the sample size becomes large. In other words, we wanted to understand the influence of sample size on the estimation capabilities of the method. To do this, we used the simplest observation function; the identity mapping: <mml:math id="M233" altimg="si368.gif" display="inline" overflow="scroll"><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math> and varied sample size. This means we could evaluate the behaviour of the measured squared error loss <mml:math id="M234" altimg="si369.gif" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> as a function of sample size T, for each of the three nonlinear stochastic systems above.</p>
        <p>We conducted a series of fifty Monte Carlo simulations for seven sample sizes (<mml:math id="M235" altimg="si371.gif" display="inline" overflow="scroll"><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mn>5</mml:mn><mml:mo>;</mml:mo><mml:mn>10</mml:mn><mml:mo>;</mml:mo><mml:mn>50</mml:mn><mml:mo>;</mml:mo><mml:mn>100</mml:mn><mml:mo>;</mml:mo><mml:mn>500</mml:mn><mml:mo>;</mml:mo><mml:mn>1000</mml:mn><mml:mo>;</mml:mo><mml:mn>5000</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:math>) and for each dynamical system. <xref rid="tbl3" ref-type="table">Table 3</xref> shows the simulated and prior parameters used.</p>
        <p>We applied the VB-Laplace scheme to each of these 1050 simulations. We then calculated the squared error loss (SEL) and expected loss (EL)<xref rid="fn8" ref-type="fn">8</xref> from the ensuing approximated posterior densities.</p>
        <p>Sampling the empirical Monte Carlo distributions of both these evaluation measures allowed us to approximate their expectation under the marginal likelihood. Therefore, characterising the behaviour of Monte Carlo average SEL as a function of the sample size T provides a numerical assessment of asymptotic efficiency. Furthermore, comparing the Monte Carlo average SEL and Monte Carlo average EL furnishes a quantitative validation of the posterior confidence intervals.</p>
        <p><xref rid="fig14" ref-type="fig">Fig. 14</xref> (resp. <xref rid="fig15" ref-type="fig">Fig. 15</xref>) shows the Monte Carlo distributions (10%, 50% and 90% percentiles) of the relative squared error for the initial conditions, evolution parameters and hidden-states (resp. the estimated state-noise <mml:math id="M236" altimg="si378.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> and the precision hyperparameters). Except for the initial conditions, all the VB-Laplace estimators show a jump around <mml:math id="M237" altimg="si379.gif" display="inline" overflow="scroll"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:math>; above which the squared error loss seems to asymptote. Moreover, the VB-Laplace estimators of both evolution parameters θ and hidden-states <mml:math id="M238" altimg="si381.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> exhibit a significant (quasi-monotonic) variation with T (see <xref rid="fig14" ref-type="fig">Fig. 14</xref>).<xref rid="fn9" ref-type="fn">9</xref> On average, and within the range of T we considered, the squared root loss seems to be inversely related to the sample size T: <disp-formula id="fd56"><label>(56)</label><mml:math id="M239" altimg="si387.gif" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>min</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:mo>max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext>.</mml:mtext></mml:math></disp-formula> This would be expected when estimating the parameters of a linear model, since (under a linear model) the Cramer–Rao bound is: <disp-formula id="fd57"><label>(57)</label><mml:math id="M240" altimg="si388.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>trace</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.2777em"/><mml:mo>∝</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula> where <mml:math id="M241" altimg="si389.gif" display="inline" overflow="scroll"><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:math> enumerates the degrees of freedom. However, we are dealing with nonlinear models, whose number of unknowns (the hidden-states) increases with sample size and for which no theoretical bound is available. Nevertheless, our Monte Carlo simulations suggest that Eq. <xref rid="fd57" ref-type="disp-formula">(57)</xref> seems to be satisfied over the range of T considered. This result seems to indicate that the VB-Laplace estimator of both hidden-states and evolution parameters attains asymptotic efficiency.</p>
        <p>Surprisingly, the estimation efficiency for the initial conditions <mml:math id="M242" altimg="si391.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math> does not seem to be affected by the sample size because it does not show significant variation within the range of T considered. This might be partially explained by the fact that the systems we are dealing with are close to ergodic. If the system is ergodic, then there is little information about the initial conditions at the end of the time-series. In this case, the approximate marginal posterior density of the initial conditions depends weakly on the sample size. This effect also interacts with the mean-field approximation: the derivation of the approximate posterior density of the initial conditions <mml:math id="M243" altimg="si393.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> depends primarily on that of the first hidden-state <mml:math id="M244" altimg="si394.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> through the message passing algorithm.<xref rid="fn10" ref-type="fn">10</xref> Therefore, it should not matter whether we increase the sample size: the effective amount of available information for the initial conditions is approximately invariant. Lastly, we note a significant variation of the estimation efficiency for both the state-noise and the precision hyperparameters (except for the van der Pol case: see <xref rid="fig9" ref-type="fig">Fig. 9</xref>). This efficiency gain is qualitatively similar to that of evolution parameters and hidden-states, though to a lesser extent.</p>
        <p><xref rid="fig16" ref-type="fig">Fig. 16</xref> shows the VB-Laplace self-consistency measure, in terms of the quantitative relationship between the measured loss (<mml:math id="M245" altimg="si397.gif" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:math>) and its posterior expectation (<mml:math id="M246" altimg="si398.gif" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math>). To demonstrate the ability of the method to predict its own estimation error, we constructed log–log scatter plots of the posterior loss versus measured loss (having pooled over simulation) for hidden-states (<mml:math id="M247" altimg="si399.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math>), parameters (θ and <mml:math id="M248" altimg="si401.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math>) and state-noise (<mml:math id="M249" altimg="si402.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>). The hidden-states show a nearly one-to-one mapping between measured and expected loss, which is due to the fact that the hidden-states populated the lowest level in the hierarchical model. As a consequence, the VB-Laplace approximation to their posterior density does not suffer from having to integrate over intermediate levels. Both the evolution parameters and initial conditions show a close relationship between measured and expected loss. Nevertheless, it can be seen from <xref rid="fig16" ref-type="fig">Fig. 16</xref> that the VB-Laplace estimates of the evolution parameters for the double-well and the van der Pol system are slightly underconfident. This underconfidence is also observed for the state-noise precision. This might partially be due to a slight but systematic underestimation of the state-noise precision hyperparameter α.This pessimistic VB-Laplace estimation of the squared error loss (SEL) would lead to conservative posterior confidence intervals.</p>
        <p>However, note that this underconfidence is not observed for the Lorenz parameters, whose VB-Laplace estimation appears to be slightly overconfident (shrinked posterior confidence intervals). This is important, since this means that the bias of posterior confidence interval VB-Laplace estimation depends upon the system to be inverted. These underconfidence/overconfidence effects are discussed in details below (see discussion section “<italic>On asymptotic efficiency</italic>”).</p>
      </sec>
      <sec id="sec4.6">
        <label>4.6</label>
        <title>Assessing prediction ability</title>
        <p>Finally, we assessed the quality of the predictive and sojourn densities. <xref rid="fig17 fig18 fig19" ref-type="fig">Figs. 17–19</xref> show the approximate predictive densities over the hidden-states (<mml:math id="M250" altimg="si404.gif" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>), as given by VB-Laplace and a standard Monte Carlo Markov Chain (MCMC) sampling technique <xref rid="b35" ref-type="bibr">[35]</xref>, for each of the three dynamical systems. Specifically:</p>
        <p>
          <list list-type="simple">
            <list-item>
              <label>•</label>
              <p>Top-left: MCMC predictive density using the true parameters.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Top-right: MCMC predictive density using the parameters and hyperparameters estimated by the VB-Laplace approach.</p>
            </list-item>
            <list-item>
              <label>•</label>
              <p>Bottom-left: VB-Laplace approximate predictive density using the parameters and hyperparameters estimated by VB-Laplace.</p>
            </list-item>
          </list>
        </p>
        <p>Note that we used the Monte Carlo averages of the VB-Laplace posterior densities parameters and hyperparameters from the first series of Monte Carlo simulations. After a “burn-in” period, the predictive density settles down into stationary (double-well and van der Pol) or cyclostationary<xref rid="fn11" ref-type="fn">11</xref> (Lorenz) states that are multimodal.<xref rid="fn12" ref-type="fn">12</xref></p>
        <p>The double-well system (<xref rid="fig17" ref-type="fig">Fig. 17</xref>) exhibits a stationary bimodal density whose modes are centred on the two wells. Its burn-in period is similar for both MCMC estimates (ca. one second). The bimodality occurs because of diffusion over the barrier caused by state-noise. The Lorenz system (<xref rid="fig18" ref-type="fig">Fig. 18</xref>) shows a quasi-cyclostationary predictive density, after a burn-in period of about 1.5 s under the true parameters, and 0.8 s under their VB estimates. Note that due to the diffusive effect of state-noise, this quasi-cyclostationary density slowly converges to a stationary density (not shown). Within a cycle, each mode reproduces the trajectory of one oscillation around each wing of the Lorenz attractor. The bimodality of the Lorenz predictive density is very different in nature to that of the double-well system. First, there are periodic times at which the two modes co-occur, i.e. for which the predictive density can be considered as unimodal. This occurs approximately every 700 ms. At these times the states are close to the transition point <mml:math id="M251" altimg="si405.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math> between the two attractor wings. At this transition point, state-noise allows the system to switch to one or the other wing of the attractor. However, the trajectory between transition points is quasideterministic, i.e. it evolves in the neighbourhood of the deterministic orbit around the chosen wing. This is because the evolution function is dominated by the deterministic part of the evolution function. The van der Pol system (<xref rid="fig19" ref-type="fig">Fig. 19</xref>) shows a stationary bimodal density, after a burn-in period of about 1 s. The modes of the stationary density are centred on the extremal values of its deterministic variant (around <mml:math id="M252" altimg="si406.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mn>2</mml:mn></mml:math>). Here again, the bimodality of the van der Pol predictive density is very different from the two other systems. The main effect of state-noise is to cause random jitter in the phase of the van der Pol oscillator. In addition, the system slows down when approaching extremal values. As a consequence, an ensemble of stochastic van der Pol oscillator will mostly populate the neighbourhoods of both the extremal values of the deterministic oscillator.</p>
        <p>The stationarity in each of the three systems seems to be associated with ergodicity (at least for the first moment of the predictive density). Note that both the form of the stationary density and the burn-in period depends upon the structure of the dynamical system, and particularly on the state-noise precision hyperparameter. This latter dependence is expressed acutely in the Lorenz attractor (<xref rid="fig18" ref-type="fig">Fig. 18</xref>): the modes of the cyclostationary distribution under the true parameters and hyperparameters are wider than those under the VB estimates. Also, the burn-in period is much shorter under the VB estimates. This is due to the fact that the state-noise precision hyperparameter has been underestimated.</p>
        <p>The VB-Laplace approximation to the predictive density cannot reproduce the multimodal structure of the predictive density (<xref rid="fig17" ref-type="fig">Figs. 17</xref>, <xref rid="fig18 fig19" ref-type="fig">18 and 19</xref>). However, it is a good approximation to the true predictive density during the burn-in period. It can be seen from <xref rid="fig17" ref-type="fig">Figs 17</xref>, <xref rid="fig18 fig19" ref-type="fig">18 and 19</xref> that the burn-in MCMC unimodal predictive density is very similar to its VB-Laplace approximation, except for the slight overconfidence problem. Note also the drop in the precision of the VB-Laplace approximate predictive density after the burn-in period, for both the double-well and the Lorenz system. This means that the VB-Laplace approach predicts its own inaccuracy, after the burn-in period. In summary, these results mean that, contrary to middle-term predictions, short-term predictions are not compromised by the Gaussian approximation to the predictive density. By short-term predictions, we mean predictions over the burn-in period. The accuracy of the VB-Laplace predictions shows a clear transition when the system actually becomes ergodic. When this is the case (middle-term), the VB-Laplace predictions become useless.</p>
        <p><xref rid="fig20 fig21 fig22" ref-type="fig">Figs. 20–22</xref> depict the sojourn distributions as given by VB-Laplace and Monte Carlo Markov Chain (MCMC) sampling, for each of the three dynamical systems. The MCMC sojourn density of the double-well system (<xref rid="fig20" ref-type="fig">Fig. 20</xref>) is composed of two (nearly Gaussian) modes, connected to each other by a “bridge”. The difference between the amplitudes of this bridge under the true parameters and under the VB estimates is again due to a slight underestimation of the state-noise precision hyperparameter. As can be seen from <xref rid="fig20" ref-type="fig">Fig. 20</xref>, the approximate sojourn distribution of the Double-Well system is far from perfect: one of the two modes (associated with the left potential well) is missing. This is due to the fact that the Gaussian approximation to the predictive density cannot account for stochastic phase transitions. This means that the prediction for this system will be biased by the initial conditions (last <italic>a posteriori</italic> inferred state), and will get worse with time. In contrast, <xref rid="fig21 fig22" ref-type="fig">Figs. 21 and 22</xref> suggest a good agreement between VB-Laplace approximate and MCMC sampled sojourn distributions for the Lorenz and van der Pol systems. Qualitatively, their state-space maps seem to be recovered correctly, ensuring a robust long-term (average) prediction. Note that the lack of precision of the Lorenz VB-Laplace approximate sojourn density (<xref rid="fig21" ref-type="fig">Fig. 21</xref>) is mainly due to the underestimation of the state-noise precision hyperparameter, since the same “smoothing” effect is noticeable on the MCMC sojourn distribution under the VB hyperparameters. The structure of the van der Pol sojourn distribution is almost perfectly captured, except for a slight residual from the initial conditions (centred on the fixed point <mml:math id="M253" altimg="si407.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math>).</p>
        <p>Taken together, these preliminary results indicate that the long-term predictive power of the VB-Laplace scheme depends on the structure of the stochastic system to be predicted. This means that accuracy of the VB-Laplace long-term predictions might only hold for a certain class of stochastic nonlinear systems (see Section <xref rid="sec5" ref-type="sec">5</xref>).</p>
      </sec>
    </sec>
    <sec id="sec5">
      <label>5</label>
      <title>Discussion</title>
      <p>We have proposed a variational Bayesian approach to the inversion and prediction of nonlinear stochastic dynamic models. This probabilistic technique yields (i) approximate posterior densities over hidden-states, parameters and hyperparameters and (ii) approximate predictive and sojourn densities on state and measurement space. Using simulations of three nonlinear stochastic dynamical systems, the schemes’ estimation and model identification capabilities have been demonstrated and examined in terms self-consistency. The results suggest that:</p>
      <p>
        <list list-type="simple">
          <list-item>
            <label>•</label>
            <p>VB-Laplace outperforms standard extended Kalman filtering, in terms of estimating of hidden-states. In particular, VB-Laplace seems to be more robust to model misspecification.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Approximate Bayesian model comparison allows one to identify models whose structure could have generated the data. This means that the free-energy bound on log-model-evidence is not confounded by the variational approximations and remains an operationally useful proxy for model comparison.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>VB-Laplace estimators of hidden-states and model parameters seem to attain asymptotic efficiency. However, we have observed a slight but systematic underestimation of the state-noise precision hyperparameter.</p>
          </list-item>
          <list-item>
            <label>•</label>
            <p>Short- and long-term prediction can be efficient, depending on the nature of the stochastic nonlinear dynamical system.</p>
          </list-item>
        </list>
      </p>
      <p>Overall, our results suggest that the VB-Laplace scheme is a fairly efficient solution to estimation, time-series prediction and model comparison problems. Nevertheless, some very specific characteristics of the proposed VB-Laplace scheme were shown to be system-specific. We discuss these properties below, along with related issues and insights.</p>
      <sec id="sec5.1">
        <label>5.1</label>
        <title>On asymptotic efficiency</title>
        <p>Asymptotic efficiency for the state-noise <italic>per se</italic> might be important for estimating unknown exogenous input to the system. For example, when inverting neural-mass models using neuroimaging data, retrieving the correct structure of the network might depend on explaining away external inputs. Furthermore, discovering consistent trends in estimated innovations might lead to further improvements in modelling the dynamical system. Alternative models can then be compared using the VB-Laplace approximation to the marginal likelihood as above.</p>
        <p>We now consider an analytic interpretation of asymptotic efficiency for VB-Laplace estimators. Recall that under the Laplace approximation, the posterior covariance matrix <mml:math id="M254" altimg="si408.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow></mml:msub></mml:math> is given by: <disp-formula id="fd58"><label>(58)</label><mml:math id="M255" altimg="si409.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:math></disp-formula> Therefore, its expectation under the marginal likelihood should, asymptotically, tend to the Bayesian Cramer–Rao bound: <disp-formula id="fd59"><label>(59)</label><mml:math id="M256" altimg="si410.gif" display="block" overflow="scroll"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>⟶</mml:mo></mml:mrow><mml:mrow><mml:mo>dim</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>y</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:math></disp-formula> Provided the approximate posterior density <mml:math id="M257" altimg="si411.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> converges to the true posterior density <mml:math id="M258" altimg="si412.gif" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> with large sample sizes. For non-asymptotic regime, the normal approximation is typically more accurate for marginal distributions of components of ϑ than for the full joint distribution. Determining the marginal distribution of a component of ϑ is equivalent to averaging over all other components of ϑ; rendering it closer to normality, by the same logic that underlies the central limit theorem <xref rid="b51" ref-type="bibr">[51]</xref>. Therefore, the numerical evidence for asymptotic efficiency of the VB-Laplace scheme<xref rid="fn13" ref-type="fn">13</xref> can be taken as a <italic>post hoc</italic> justification of the underlying variational approximations. This provides a numerical argument for extending the theoretical result of <xref rid="b27" ref-type="bibr">[27]</xref> on VB asymptotic convergence for conjugate-exponential (CE) models to nonlinear (non-CE) hierarchical models. Nevertheless, this does not give any prediction about the convergence rate to the likely VB-Laplace asymptotic efficiency. The Monte Carlo simulation series seem to indicate that this convergence rate might be dependent upon the system to be inverted (in our examples, the Lorenz system might be quicker than the double-well and the van der Pol systems; see <xref rid="fig14 fig15" ref-type="fig">Figs. 14 and 15</xref>). In other words, the minimum sample size required to confidently identify a system might strongly depend on the system itself.</p>
        <p>In addition, VB-Laplace seems to suffer from an <italic>underconfidence</italic> problem: the posterior expectation of the estimation error is often over-pessimistic when compared to empirically measured estimation error. Generally speaking, free-form variational Bayesian inference on conjugate-exponential models is known to be <italic>overconfident</italic><xref rid="b21" ref-type="bibr">[21]</xref>. This is thought to be due to the mean-field approximation, which neglects dependencies within the exact joint posterior density. However, this heuristic does not hold for non-exponential models, e.g. nonlinear hierarchical models of the sort that we are dealing with.</p>
        <p>This underconfidence property might be due to a slight underestimation of the precision hyperparameters, which would inflate posterior uncertainty about other variables in the model. This underestimation bias of the precision hyperparameters might itself be due to the priors we have chosen (weakly informative Gamma pdf with first-order moment two orders of magnitude lower than the actual precision hyperparameters, see <xref rid="tbl2 tbl6" ref-type="table">Tables 2 and 6</xref>). This is important, since the overall underconfidence bias (on evolution parameters) that was observed in the simulation series might be sensitive to the choice of precision hyperparameters priors.</p>
        <p>However, this is certainly not the only effect, since this could not explain why the evolution parameter estimates of the Lorenz system are (as in the CE case) <italic>overconfident</italic> (see <xref rid="fig16" ref-type="fig">Fig. 16</xref>). Note that in this latter case, the evolution function is linear in the evolution parameters. This means that in the context of hierarchical nonlinear models, VB-Laplace might over-compensate for the tendency of variational approaches to underestimate posterior uncertainty. The subsequent underconfidence might then be due the Taylor approximation of the curvature of the log-transition density: <disp-formula id="fd60"><label>(60)</label><mml:math id="M259" altimg="si417.gif" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo>〈</mml:mo><mml:mi>α</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>〈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>〉</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>α</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>〉</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>+</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>υ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>VB</mml:mi></mml:mstyle><mml:mtext>-</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>Laplace</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>α</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>∂</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>〉</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>neglected</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math></disp-formula> Eq. <xref rid="fd60" ref-type="disp-formula">(60)</xref> gives the expression for the posterior covariance matrix of the evolution parameters. When the evolution function <mml:math id="M260" altimg="si418.gif" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math> is linear in the parameters (CE case), the neglected term is zero. In this case the curvature of the log-transition density is estimated exactly, which would allow VB overconfidence to be expressed in the usual way. However, in the nonlinear case, neglecting this term will result in an overestimate of the posterior covariance. Note that underestimating α leads to an (even more) increased posterior covariance for the evolution parameters. This effect can be seen in the VB-Laplace approximation to the Lorenz sojourn distribution. This potential lack of consistency of variational Bayesian inversion of linear state-space models has already been pointed out by Wang <xref rid="b27" ref-type="bibr">[27]</xref>. It is possible that both effects highlighted by Eq. <xref rid="fd60" ref-type="disp-formula">(60)</xref> could contribute to underconfidence in nonlinear models.</p>
      </sec>
      <sec id="sec5.2">
        <label>5.2</label>
        <title>On time-series prediction</title>
        <p>Our assessment of the approximate predictive and sojourn densities provided only partly satisfactory results. Overall, the VB-Laplace scheme furnishes a veridical approximation to the short-term predictive density. In addition, the long-term predictions seem to be accurate for systems that have qualitatively similar deterministic and stochastic dynamical behaviours, which is the case for both the Lorenz and the van der Pol systems, but not for the double-well system. The VB-Laplace approximation to the sojourn density relies on the ergodicity of the hidden stochastic system, which is a weak assumption for the class of systems we have considered. However, there are two classes of stochastic ergodic systems, for which the deterministic variant might also be ergodic or not. The former class of stochastic systems is called <italic>quasideterministic</italic>, and has a number of desirable properties <xref rid="b52" ref-type="bibr">[52]</xref>. The dynamical behaviour of quasideterministic systems can be approximated by small fluctuations around their deterministic trajectory (hence their name). This means that a local Gaussian approximation around the deterministic trajectory of the system will lead to a veridical approximation of the sojourn distribution. Systems are quasideterministic if and only if they are stable with respect to small changes in the initial conditions <xref rid="b40" ref-type="bibr">[40]</xref>. This is certainly the case for the van der Pol oscillator, which exhibits a stable limit cycle. The stochastic Lorenz system is also quasideterministic <xref rid="b56" ref-type="bibr">[56]</xref>. As a consequence, their VB-Laplace approximation to the stationary (sojourn) distribution is qualitatively valid. However, this is not the case for the double-well system, for which weak stochastic forces can lead to a drastic departure from deterministic dynamics <xref rid="b57" ref-type="bibr">[57]</xref> (e.g. phase transitions). In brief, long-term predictions based on the VB-Laplace approximations are only valid if the system is quasideterministic; i.e. if the complexity of its dynamical behaviour is not increased substantially by the stochastic effects.</p>
      </sec>
      <sec id="sec5.3">
        <label>5.3</label>
        <title>On model comparison</title>
        <p>In terms of model comparison, our results show that the VB-Laplace scheme could identify the structure of the hidden stochastic nonlinear dynamical system; in the sense that models that cover the dynamical structure of the hidden system are <italic>a posteriori</italic> the most plausible. However, the free-energy showed a slight bias in favour of more complex models: when comparing two models that could both have generated the data, the free-energy identified the model with the higher dimensionality (e.g. comparison between generic versus true Lorenz systems). This might be due to the minimum norm priors that were used for the evolution parameters. As a consequence, the structure of the true hidden system was explained by a large number of small parameters (as opposed to a small number of large parameters). Since the free-energy decreases with the Kullback–Leibler divergence between the prior and the posterior density, this “minimum norm spreading” is less costly. Importantly, this effect does not seem to confound correct model identification when models that do not cover the true structure are compared.</p>
      </sec>
      <sec id="sec5.4">
        <label>5.4</label>
        <title>On algorithmic convergence</title>
        <p>The variational Bayesian approach replaces the multidimensional integrals required for standard Bayesian inference by an optimization scheme. However, this optimization can also be a difficult problem, because the free-energy is a nonlinear function of the sufficient statistics of the posterior density. The VB-Laplace update rule optimizes a third-order approximation to the free-energy with respect to the sufficient statistics <mml:math id="M261" altimg="si420.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><xref rid="b28" ref-type="bibr">[28]</xref>. Note that this approximation to the free-energy comes from neglecting the contributions of fourth and higher (even) order central moments of the Gaussian approximate posterior densities. Since the latter are polynomial functions of the posterior covariance matrix <mml:math id="M262" altimg="si421.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math> (and are independent of the posterior modes <mml:math id="M263" altimg="si422.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math>), a moment closure procedure could be used to finesse the calculation of the variational energies, guaranteeing strict convergence. However, when dealing with analytic observation and evolution functions, the series generally converge rapidly. This means that the contributions of high-order moments to the free-energy, under the Laplace approximation, become negligible. Under these conditions, marginal optimization of the variational energies almost guarantees local optimization of the free-energy.</p>
        <p>Obviously, this does not circumvent the problem of global optimization of the free-energy. However, local convergence of the free-energy w.r.t. the sufficient statistics now reduces to local convergence of the variational energy optimization w.r.t. the modes. This is because the only sufficient statistics that need to be optimized are the first-order moments of the approximate marginal posterior densities (the second-order moments are functions of the modes; see Eq. <xref rid="fd7" ref-type="disp-formula">(7)</xref>). We used a regularized Gauss–Newton scheme for the variational energy optimization, which is expected to converge under mild conditions. This convergence has been empirically observed over all our Monte Carlo simulations. However, we foresee two reasons why VB-Laplace might not converge: either the evolution or the observation functions are non-analytic or the algorithm reaches its stopping criterion too early. The first situation includes models with discrete types of nonlinearities (i.e., “on/off” switches). In this case, convergence issues could be handled by extending to switching state-space hierarchical models (see <xref rid="b55" ref-type="bibr">[55]</xref> for the CE case). The second situation might arise due to slow convergence rates, if the stopping criterion is based on the free-energy increment between two iterations.</p>
      </sec>
      <sec id="sec5.5">
        <label>5.5</label>
        <title>On scalability</title>
        <p>A key issue with Bayesian filters is scalability. It is well known that scalability is one of the main advantages of Kalman-like filters over sampling schemes (e.g. particle filters) or high-order approximations to the Kushner–Pardoux PDEs. The VB-Laplace update of the hidden-states posterior density is a regularized Gauss–Newton variant of the Kalman filter. Therefore, the VB-Laplace and Kalman schemes share the same the scalability properties.</p>
        <p>To substantiate this claim, we analyzed the VB-Laplace scheme using basic computational complexity of matrix algebra. Assuming that arithmetic with individual elements has complexity <mml:math id="M264" altimg="si423.gif" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math> (as with fixed-precision floating-point arithmetic), it is easy to show that the per-iteration costs (i.e. the number of computations) for the VB updates are: <disp-formula id="fd61"><label>(61)</label><mml:math id="M265" altimg="si424.gif" display="block" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>EKF</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>︸</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mstyle mathvariant="normal"><mml:mi>mean</mml:mi></mml:mstyle><mml:mtext>-</mml:mtext><mml:mstyle mathvariant="normal"><mml:mi>field terms</mml:mi></mml:mstyle></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>p</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>)</mml:mo></mml:mrow><mml:mtext>.</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula> This derives from the sparsity of the mean-field terms, which rely on Kronecker products with identity matrices (see Eqs. <xref rid="fd29 fd31 fd34" ref-type="disp-formula">(29), (31) and (34)</xref>). It can be seen that the per-iteration cost is the same as a Kalman filter; i.e., it grows as <mml:math id="M266" altimg="si425.gif" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math>, where n is the number of hidden-states.</p>
        <p>In terms of memory, the implementation of our VB scheme has the following matrix storage requirements: <mml:math id="M267" altimg="si427.gif" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>6</mml:mn><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>φ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>, which is required for the calculation of the posterior covariance matrices (see Eqs. <xref rid="fd29 fd31 fd34" ref-type="disp-formula">(29), (31) and (34)</xref>). This computational load is similar to a Kalman filter; i.e., it grows as <mml:math id="M268" altimg="si428.gif" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math>. Overall, this means that the VB-Laplace scheme inherits the scalability properties of the Kalman filter.</p>
      </sec>
      <sec id="sec5.6">
        <label>5.6</label>
        <title>On influence of noise</title>
        <p>In the Monte Carlo simulation series we presented, we did not assess the response of the VB-Laplace scheme to a systematic variation of noise precision. This was justified by our main target application, i.e. neuroimaging data (EEG/MEG and fMRI) analysis, for which the SNR is known (see e.g., <xref rid="b53" ref-type="bibr">[53]</xref>).</p>
        <p>In addition, we have also fixed the state-noise precision hyperparameter. This is because a subtle balance between drift and state-noise is required for stochastic dynamical systems to exhibit “interesting” properties, which would disappear in both low- and high-noise situations. For example, the expected time interval between two transitions of the double-well system is proportional to the state-noise precision (see e.g. <xref rid="b54" ref-type="bibr">[54]</xref>). As a consequence, the low-noise double-well system will hardly show any transition. In contradistinction, the high-noise double-well system looks like white noise, because the drift term has no significant influence on the dynamics anymore. Therefore, local and global oscillations co-occur only within a given range of state-noise precision (stochastic resonance).</p>
        <p>Nevertheless, a comprehensive assessment of the behaviour of the VB-Laplace scheme would require varying the precision of both the measurement and the state-noise precisions. Preliminary results (not shown) seem to indicate that the VB-Laplace scheme does not systematically suffer from over- or under-fitting, even in the weakly informative precision prior case. However, no formal conclusions can yet be drawn onto the influence of high noise on the VB-Laplace scheme, which could potentially be a limiting factor for particular applications.</p>
      </sec>
    </sec>
    <sec id="sec6">
      <label>6</label>
      <title>Conclusion</title>
      <p>In this paper, we have presented an approximate variational Bayesian inference scheme to estimate the hidden-states, parameters, and hyperparameters of dynamic nonlinear causal models. We have also assessed its asymptotic efficiency, prediction ability and model selection performances using decision theoretic measures and extensive Monte Carlo simulations. Our results suggest that variational Bayesian techniques are a promising avenue for solving complex inference problems that arise from structured uncertainty in dynamical systems.</p>
    </sec>
  </body>
  <back>
    <ack>
      <title>Acknowledgement</title>
      <p>The work was funded by Wellcome trust.</p>
    </ack>
    <fn-group>
      <fn id="fn1">
        <label>1</label>
        <p>Note that <italic>filtering</italic> techniques provide the instantaneous posterior density, (i.e. the posterior density given observed time-series data so far) as opposed to <italic>smoothing</italic> schemes, which cannot operate on-line, but furnish the full posterior density (given the complete time-series data).</p>
      </fn>
      <fn id="fn2">
        <label>2</label>
        <p>In this article, we refer to parameters governing the second-order moments of the probability density functions as (variance or, reciprocally, precision) <italic>hyperparameters</italic>.</p>
      </fn>
      <fn id="fn3">
        <label>3</label>
        <p>Note that all these quantities are the negative of their thermodynamic homologues.</p>
      </fn>
      <fn id="fn4">
        <label>4</label>
        <p>The class of decision theoretic problems (i.e. hypothesis testing) is treated as a model comparison problem in a Bayesian framework.</p>
      </fn>
      <fn id="fn5">
        <label>5</label>
        <p>One can apply any arbitrary nonlinear transform to the parameters to implement an implicit probability integral transform.</p>
      </fn>
      <fn id="fn6">
        <label>6</label>
        <p>The Markov blanket of a node in a directed acyclic graph (of the sort given in <xref rid="fig1" ref-type="fig">Fig. 1</xref>) comprises the node’s parents, children and parents of those children.</p>
      </fn>
      <fn id="fn7">
        <label>7</label>
        <p>For both hidden-states and initial conditions, we halve the size of the Gauss–Newton update until their respective variational energy increases.</p>
      </fn>
      <fn id="fn8">
        <label>8</label>
        <p>To compare different variables and systems, we used a relative squared error loss (<italic>RSEL</italic>), defined as: <disp-formula><mml:math id="M269" altimg="si372.gif" display="block" overflow="scroll"><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϑ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mtext>.</mml:mtext></mml:math></disp-formula> We report this measure in log space as a function of T i.e., <mml:math id="M270" altimg="si374.gif" display="inline" overflow="scroll"><mml:mo>ln</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>, such that <mml:math id="M271" altimg="si375.gif" display="inline" overflow="scroll"><mml:mo>ln</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:math> means that the relative estimation error is smaller than 10<sup>−1</sup> (<mml:math id="M272" altimg="si376.gif" display="inline" overflow="scroll"><mml:mn>0.9</mml:mn><mml:mspace width="0.16667em"/><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mo>ˆ</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1.1</mml:mn><mml:mspace width="0.16667em"/><mml:msub><mml:mrow><mml:mi>ϑ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math>).</p>
      </fn>
      <fn id="fn9">
        <label>9</label>
        <p>Note that the relationship between RSEL and T depicted in <xref rid="fig14" ref-type="fig">Fig. 14</xref> might not, strictly speaking, appear monotonic (cf., e.g., the Lorenz evolution parameters). This is likely to be due to finite size effects in the Monte Carlo simulation series (50 samples per value of T). However, the rate at which the VB-Laplace reaches the asymptotic regime might be different for the systems considered (see Section <xref rid="sec5" ref-type="sec">5</xref> “on asymptotic efficiency”).</p>
      </fn>
      <fn id="fn10">
        <label>10</label>
        <p>Strictly speaking, <mml:math id="M273" altimg="si395.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> also depends on <mml:math id="M274" altimg="si396.gif" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>.</p>
      </fn>
      <fn id="fn11">
        <label>11</label>
        <p>A cyclostationary system is such that the sufficient statistics of its predictive density are periodic. It can be thought of as an ergodic process that constitutes multiple interleaved stationary processes <xref rid="b50" ref-type="bibr">[50]</xref>.</p>
      </fn>
      <fn id="fn12">
        <label>12</label>
        <p>Note that the bimodality of the predictive density does not imply bimodality of the posterior density.</p>
      </fn>
      <fn id="fn13">
        <label>13</label>
        <p>The Monte Carlo simulations provide us with a sampling approximation to the left-hand term of Eq. <xref rid="fd55" ref-type="disp-formula">(55)</xref> (sampling averages of the squared error loss, see <xref rid="fig8 fig9" ref-type="fig">Figs. 8 and 9</xref>) given model m.</p>
      </fn>
    </fn-group>
    <ref-list>
      <title>References</title>
      <ref id="b1">
        <label>[1]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Friston</surname>
              <given-names>K.J.</given-names>
            </name>
            <name>
              <surname>Harrison</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Penny</surname>
              <given-names>W.</given-names>
            </name>
          </person-group>
          <article-title>Dynamic causal modelling</article-title>
          <source>Neuroimage</source>
          <year>2003</year>
          <volume>19</volume>
          <fpage>1273</fpage>
          <lpage>1302</lpage>
          <pub-id pub-id-type="pmid">12948688</pub-id>
        </citation>
      </ref>
      <ref id="b2">
        <label>[2]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kiebel</surname>
              <given-names>S.J.</given-names>
            </name>
            <name>
              <surname>Garrido</surname>
              <given-names>M.I.</given-names>
            </name>
            <name>
              <surname>Friston</surname>
              <given-names>K.J.</given-names>
            </name>
          </person-group>
          <article-title>Dynamic causal modelling of evoked responses: The role of intrinsic connections</article-title>
          <source>Neuroimage</source>
          <year>2007</year>
          <volume>36</volume>
          <fpage>332</fpage>
          <lpage>345</lpage>
          <pub-id pub-id-type="pmid">17462916</pub-id>
        </citation>
      </ref>
      <ref id="b3">
        <label>[3]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Judd</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>L.A.</given-names>
            </name>
          </person-group>
          <article-title>Indistinguishable states II: The imperfect model scenario</article-title>
          <source>Physica D</source>
          <year>2004</year>
          <volume>196</volume>
          <fpage>224</fpage>
          <lpage>242</lpage>
        </citation>
      </ref>
      <ref id="b4">
        <label>[4]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Saarinen</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>LInne</surname>
              <given-names>M.L.</given-names>
            </name>
            <name>
              <surname>Yli-Harja</surname>
              <given-names>O.</given-names>
            </name>
          </person-group>
          <article-title>Stochastic differential equation model for cerebellar granule cell excitability</article-title>
          <source>Plos Comput. Bio.</source>
          <year>2008</year>
          <volume>4</volume>
        </citation>
      </ref>
      <ref id="b5">
        <label>[5]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Herrmann</surname>
              <given-names>C.S.</given-names>
            </name>
          </person-group>
          <article-title>Human EEG responses to 1–100 Hz flicker: Resonance phenomena in visual cortex and their potential correlation to cognitive phenomena</article-title>
          <source>Exp. Brain Res.</source>
          <year>1988</year>
          <volume>137</volume>
          <fpage>149</fpage>
          <lpage>160</lpage>
        </citation>
      </ref>
      <ref id="b6">
        <label>[6]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Jimenez</surname>
              <given-names>J.C.</given-names>
            </name>
            <name>
              <surname>Ozaki</surname>
              <given-names>T.</given-names>
            </name>
          </person-group>
          <article-title>An approximate innovation method for the estimation of diffusion processes from discrete data</article-title>
          <source>J. Time Ser. Anal.</source>
          <year>2006</year>
          <volume>76</volume>
          <fpage>77</fpage>
          <lpage>97</lpage>
        </citation>
      </ref>
      <ref id="b7">
        <label>[7]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Friston</surname>
              <given-names>K.J.</given-names>
            </name>
            <name>
              <surname>Trujillo</surname>
              <given-names>N.J.</given-names>
            </name>
            <name>
              <surname>Daunizeau</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>DEM: A variational treatment of dynamical systems</article-title>
          <source>Neuroimage</source>
          <year>2008</year>
          <volume>41</volume>
          <fpage>849</fpage>
          <lpage>885</lpage>
          <pub-id pub-id-type="pmid">18434205</pub-id>
        </citation>
      </ref>
      <ref id="b8">
        <label>[8]</label>
        <citation citation-type="other">A. Joly-Dave, The fronts and Atlantic storm-track experiment (FASTEX): Scientific objectives and experimental design, Bull. Am. Soc. Meteorol, Mto-France, Toulous, France, 1997. <ext-link xlink:href="http://citeseer.ist.psu.edu/496255.html" ext-link-type="uri">http://citeseer.ist.psu.edu/496255.html</ext-link></citation>
      </ref>
      <ref id="b9">
        <label>[9]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wikle</surname>
              <given-names>C.K.</given-names>
            </name>
            <name>
              <surname>Berliner</surname>
              <given-names>L.M.</given-names>
            </name>
          </person-group>
          <article-title>A Bayesian tutorial for data assimilation</article-title>
          <source>Physica D</source>
          <year>2007</year>
          <volume>230</volume>
          <fpage>1</fpage>
          <lpage>16</lpage>
        </citation>
      </ref>
      <ref id="b10">
        <label>[10]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Briers</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Doucet</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Maskell</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <article-title>Smoothing algorithm for state-space models</article-title>
          <source>IEEE Trans. Signal Process.</source>
          <year>2004</year>
        </citation>
      </ref>
      <ref id="b11">
        <label>[11]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Kushner</surname>
              <given-names>H.J.</given-names>
            </name>
          </person-group>
          <source>Probability Methods for Approximations in Stochastic Control and for Elliptic Equations</source>
          <source>Mathematics in Science and Engineering</source>
          <volume>vol. 129</volume>
          <year>1977</year>
          <publisher-name>Accademic Press</publisher-name>
          <publisher-loc>New York</publisher-loc>
        </citation>
      </ref>
      <ref id="b12">
        <label>[12]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Pardoux</surname>
              <given-names>E.</given-names>
            </name>
          </person-group>
          <article-title>Filtrage non-lineaire et equations aux derivees partielles stochastiques associees, Ecole d’ete de probabilites de Saint-Flour XIX - 1989</article-title>
          <source>Lectures Notes in Mathematics</source>
          <volume>vol. 1464</volume>
          <year>1991</year>
          <publisher-name>Springer-Verlag</publisher-name>
        </citation>
      </ref>
      <ref id="b13">
        <label>[13]</label>
        <citation citation-type="other">F.E. Daum, J. Huang, The curse of dimensionality for particle filters, in: Proc. of IEEE Conf. on Aerospace, Big Sky, MT, 2003</citation>
      </ref>
      <ref id="b14">
        <label>[14]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Julier</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Uhlmann</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Durrant-Whyte</surname>
              <given-names>H.F.</given-names>
            </name>
          </person-group>
          <article-title>A new method for the nonlinear transformation of means and covariances in filters and estimators</article-title>
          <source>IEEE Trans. Automat. Control.</source>
          <year>2000</year>
        </citation>
      </ref>
      <ref id="b15">
        <label>[15]</label>
        <citation citation-type="other">G.L. Eyink, A variational formulation of optimal nonlinear estimation. <ext-link xlink:href="arxiv:physics/0011049" ext-link-type="uri">ArXiv:physics/0011049</ext-link>, 2001</citation>
      </ref>
      <ref id="b16">
        <label>[16]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Budhiraja</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Lee</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <article-title>A survey of numerical methods for nonlinear filtering problems</article-title>
          <source>Physica D</source>
          <year>2007</year>
          <volume>230</volume>
          <fpage>27</fpage>
          <lpage>36</lpage>
        </citation>
      </ref>
      <ref id="b17">
        <label>[17]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Arulampalam</surname>
              <given-names>M.S.</given-names>
            </name>
            <name>
              <surname>Maskell</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Gordon</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Clapp</surname>
              <given-names>T.</given-names>
            </name>
          </person-group>
          <article-title>A tutorial on particle filters for online nonlinear/non-Gaussian Bayesian tracking</article-title>
          <source>IEEE Trans. Signal Process.</source>
          <year>2002</year>
          <volume>50</volume>
          <issue>2</issue>
          <comment>(special issue)</comment>
        </citation>
      </ref>
      <ref id="b18">
        <label>[18]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Doucet</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Tadic</surname>
              <given-names>V.</given-names>
            </name>
          </person-group>
          <article-title>Parameter estimation in general state-space models using particle methods</article-title>
          <source>Ann. Inst. Stat. Math.</source>
          <year>2003</year>
          <volume>55</volume>
          <fpage>409</fpage>
          <lpage>422</lpage>
        </citation>
      </ref>
      <ref id="b19">
        <label>[19]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Wan</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Nelson</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Dual extended Kalman filter methods</article-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Haykin</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <source>Filtering and Neural Networks</source>
          <year>2001</year>
          <publisher-name>Wiley</publisher-name>
          <publisher-loc>New York</publisher-loc>
          <fpage>123</fpage>
          <lpage>173</lpage>
          <comment>(Chapter 5)</comment>
        </citation>
      </ref>
      <ref id="b20">
        <label>[20]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Yedidia</surname>
              <given-names>J.S.</given-names>
            </name>
          </person-group>
          <article-title>An Idiosyncratic Journey Beyond Mean Field Theory</article-title>
          <year>2000</year>
          <publisher-name>MIT Press</publisher-name>
        </citation>
      </ref>
      <ref id="b21">
        <label>[21]</label>
        <citation citation-type="other">M. Beal, Variational algorithms for approximate Bayesian inference, University of London Ph.D. Thesis, 2003</citation>
      </ref>
      <ref id="b22">
        <label>[22]</label>
        <citation citation-type="other">M. Beal, Z. Ghahramani, The variational Kalman smoother. Technical Report, University College London, 2001. <ext-link xlink:href="http://citeseer.ist.psu.edu/ghahramani01variational.html" ext-link-type="uri">http://citeseer.ist.psu.edu/ghahramani01variational.html</ext-link></citation>
      </ref>
      <ref id="b23">
        <label>[23]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wang</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Titterington</surname>
              <given-names>D.M.</given-names>
            </name>
          </person-group>
          <article-title>Convergence and asymptotic normality of variational Bayesian approximations for exponential family models with missing values</article-title>
          <source>ACM Internat. Conf. Proc. Series</source>
          <year>2004</year>
          <volume>70</volume>
          <fpage>577</fpage>
          <lpage>584</lpage>
        </citation>
      </ref>
      <ref id="b24">
        <label>[24]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Roweis</surname>
              <given-names>S.T.</given-names>
            </name>
            <name>
              <surname>Ghahramani</surname>
              <given-names>Z.</given-names>
            </name>
          </person-group>
          <article-title>An EM algorithm for identification of nonlinear dynamical systems</article-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Haykin</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <source>Kalman Filtering and Neural Networks</source>
          <year>2001</year>
          <ext-link xlink:href="http://citeseer.ist.psu.edu/306925.html" ext-link-type="uri">http://citeseer.ist.psu.edu/306925.html</ext-link>
        </citation>
      </ref>
      <ref id="b25">
        <label>[25]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Valpola</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Karhunen</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>An unsupervised learning method for nonlinear dynamic state-space models</article-title>
          <source>Neural Comput.</source>
          <year>2002</year>
          <volume>14</volume>
          <issue>1</issue>
          <fpage>2547</fpage>
          <lpage>2692</lpage>
        </citation>
      </ref>
      <ref id="b26">
        <label>[26]</label>
        <citation citation-type="other">C. Archambeau, D. Cornford, M. Opper, J. Shawe-Taylor, Gaussian process approximations of stochastic differential equations, in: JMLR: Workshop and Conferences Proceedings, vol. 1, 2007, pp. 1–16</citation>
      </ref>
      <ref id="b27">
        <label>[27]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wang</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Titterington</surname>
              <given-names>D.M.</given-names>
            </name>
          </person-group>
          <article-title>Lack of consistency of mean-field and variational Bayes approximations for state-space models</article-title>
          <source>Neural Process. Lett.</source>
          <year>2004</year>
          <volume>20</volume>
          <fpage>151</fpage>
          <lpage>170</lpage>
        </citation>
      </ref>
      <ref id="b28">
        <label>[28]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Friston</surname>
              <given-names>K.J.</given-names>
            </name>
            <name>
              <surname>Mattout</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Trujillo-Barreto</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Ashburner</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Penny</surname>
              <given-names>W.</given-names>
            </name>
          </person-group>
          <article-title>Variational free-energy and the Laplace approximation</article-title>
          <source>Neuroimage</source>
          <year>2007</year>
          <volume>34</volume>
          <fpage>220</fpage>
          <lpage>234</lpage>
          <pub-id pub-id-type="pmid">17055746</pub-id>
        </citation>
      </ref>
      <ref id="b29">
        <label>[29]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Gray</surname>
              <given-names>R.M.</given-names>
            </name>
          </person-group>
          <article-title>Entropy and Information Theory</article-title>
          <year>1990</year>
          <publisher-name>Springer-Verlag</publisher-name>
        </citation>
      </ref>
      <ref id="b30">
        <label>[30]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Tanaka</surname>
              <given-names>T.</given-names>
            </name>
          </person-group>
          <article-title>A theory of mean field approximation</article-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Kearns</surname>
              <given-names>M.S.</given-names>
            </name>
            <name>
              <surname>Solla</surname>
              <given-names>S.A.</given-names>
            </name>
            <name>
              <surname>Cohn</surname>
              <given-names>D.A.</given-names>
            </name>
          </person-group>
          <source>Advances in Neural Information Processing Systems</source>
          <year>2001</year>
          <ext-link xlink:href="http://Citeseer.ist.psu.edu/303901.html" ext-link-type="uri">http://Citeseer.ist.psu.edu/303901.html</ext-link>
        </citation>
      </ref>
      <ref id="b31">
        <label>[31]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Tanaka</surname>
              <given-names>T.</given-names>
            </name>
          </person-group>
          <article-title>Information geometry of mean field approximation</article-title>
          <source>Neural Comput.</source>
          <year>2000</year>
          <volume>12</volume>
          <fpage>1951</fpage>
          <lpage>1968</lpage>
          <pub-id pub-id-type="pmid">10953246</pub-id>
        </citation>
      </ref>
      <ref id="b32">
        <label>[32]</label>
        <citation citation-type="other">G.E. Hinton, D. Van Camp, Keeping neural networks simple by minimizing the description length of the weights, in: Proc. of COLT-93, 1993, pp. 5–13</citation>
      </ref>
      <ref id="b33">
        <label>[33]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Carlin</surname>
              <given-names>B.P.</given-names>
            </name>
            <name>
              <surname>Louis</surname>
              <given-names>T.A.</given-names>
            </name>
          </person-group>
          <article-title>Bayes and empirical Bayes methods for data analysis</article-title>
          <source>Text in Statistical Science</source>
          <edition>2nd ed.</edition>
          <year>2000</year>
          <publisher-name>Chapman and Hall/CRC</publisher-name>
        </citation>
      </ref>
      <ref id="b34">
        <label>[34]</label>
        <citation citation-type="other">C. Robert, L’analyse statistique Bayesienne, Ed. Economica, 1992</citation>
      </ref>
      <ref id="b35">
        <label>[35]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Kloeden</surname>
              <given-names>P.E.</given-names>
            </name>
            <name>
              <surname>Platen</surname>
              <given-names>E.</given-names>
            </name>
          </person-group>
          <article-title>Numerical Solution of Stochastic Differential Equations, Stochastic Modeling and Applied Probability</article-title>
          <edition>third ed.</edition>
          <year>1999</year>
          <publisher-name>Springer</publisher-name>
        </citation>
      </ref>
      <ref id="b36">
        <label>[36]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ozaki</surname>
              <given-names>T.</given-names>
            </name>
          </person-group>
          <article-title>A bridge between nonlinear time series models and nonlinear stochastic dynamical systems: A local linearization approach</article-title>
          <source>Statistica Sinica</source>
          <year>1992</year>
          <volume>2</volume>
          <fpage>113</fpage>
          <lpage>135</lpage>
        </citation>
      </ref>
      <ref id="b37">
        <label>[37]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kleibergen</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Van Dijk</surname>
              <given-names>H.K.</given-names>
            </name>
          </person-group>
          <article-title>Non-stationarity in GARCH models: A Bayesian analysis</article-title>
          <source>J. Appl. Econom.</source>
          <year>1993</year>
          <volume>8</volume>
          <fpage>S41</fpage>
          <lpage>S61</lpage>
        </citation>
      </ref>
      <ref id="b38">
        <label>[38]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Meyer</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Fournier</surname>
              <given-names>D.A.</given-names>
            </name>
            <name>
              <surname>Berg</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Stochastic volatility: Bayesian computation using automatic differentiation and the extended Kalman filter</article-title>
          <source>Econom. J.</source>
          <year>2003</year>
          <volume>6</volume>
          <fpage>408</fpage>
          <lpage>420</lpage>
        </citation>
      </ref>
      <ref id="b39">
        <label>[39]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sornette</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Pisarenko</surname>
              <given-names>V.F.</given-names>
            </name>
          </person-group>
          <article-title>Properties of a simple bilinear stochastic model: Estimation and predictability</article-title>
          <source>Physica D</source>
          <year>2008</year>
          <volume>237</volume>
          <fpage>429</fpage>
          <lpage>445</lpage>
        </citation>
      </ref>
      <ref id="b40">
        <label>[40]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Tropper</surname>
              <given-names>M.M.</given-names>
            </name>
          </person-group>
          <article-title>Ergodic and quasideterministic properties of finite-dimensional stochastic systems</article-title>
          <source>J. Stat. Phys.</source>
          <year>1977</year>
          <volume>17</volume>
          <fpage>491</fpage>
          <lpage>509</lpage>
        </citation>
      </ref>
      <ref id="b41">
        <label>[41]</label>
        <citation citation-type="book"><person-group person-group-type="author"><name><surname>Björck</surname><given-names>A.</given-names></name></person-group><article-title>Numerical Methods for Least Squares Problems</article-title><year>1996</year><publisher-name>SIAM</publisher-name><publisher-loc>Philadelphia</publisher-loc>0-89871-360-9</citation>
      </ref>
      <ref id="b42">
        <label>[42]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lacour</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <article-title>Nonparametric estimation of the stationary density and the transition density of a Markov chain</article-title>
          <source>Stoch. Process. Appl.</source>
          <year>2008</year>
          <volume>118</volume>
          <fpage>232</fpage>
          <lpage>260</lpage>
        </citation>
      </ref>
      <ref id="b43">
        <label>[43]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Angeli</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Ferrell</surname>
              <given-names>J.E.</given-names>
            </name>
            <name>
              <surname>Sontag</surname>
              <given-names>E.D.</given-names>
            </name>
          </person-group>
          <article-title>Detection of multistability, bifurcations, and hysteresis in a large class of biological positive-feedback systems</article-title>
          <source>Proc. Nat. Atl. Sci.</source>
          <year>2004</year>
          <volume>101</volume>
          <fpage>1822</fpage>
          <lpage>1827</lpage>
        </citation>
      </ref>
      <ref id="b44">
        <label>[44]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lorenz</surname>
              <given-names>E.N.</given-names>
            </name>
          </person-group>
          <article-title>Deterministic nonperiodic flow</article-title>
          <source>J. Atmospheric Sci.</source>
          <year>1963</year>
          <volume>20</volume>
          <fpage>130</fpage>
          <lpage>141</lpage>
        </citation>
      </ref>
      <ref id="b45">
        <label>[45]</label>
        <citation citation-type="other">H. Keller, Attractors and bifurcations of the stochastic Lorenz system, Technical Report No. 389, Universitat Bremen, 1996. <ext-link xlink:href="http://citeseer.ist.psu.edu/keller96attractors.html" ext-link-type="uri">citeseer.ist.psu.edu/keller96attractors.html</ext-link></citation>
      </ref>
      <ref id="b46">
        <label>[46]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Fitzhugh</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Impulses and physiological states in theoretical models of nerve membranes</article-title>
          <source>Biophys. J.</source>
          <year>1961</year>
          <volume>1</volume>
          <fpage>445</fpage>
          <lpage>466</lpage>
          <pub-id pub-id-type="pmid">19431309</pub-id>
        </citation>
      </ref>
      <ref id="b47">
        <label>[47]</label>
        <citation citation-type="other">J.S. Nagumo, S. Arimoto, S. Yoshizawa, An active pulse transmission line simulating nerve axon, Proc. IRE 1962 50, pp. 2061–2070</citation>
      </ref>
      <ref id="b48">
        <label>[48]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gill</surname>
              <given-names>R.D.</given-names>
            </name>
            <name>
              <surname>Levit</surname>
              <given-names>B.Y.</given-names>
            </name>
          </person-group>
          <article-title>Applications of the van trees inequality: a Bayesian Cramer–Rao bound</article-title>
          <source>Bernouilli</source>
          <year>1995</year>
          <volume>1</volume>
          <fpage>59</fpage>
          <lpage>79</lpage>
        </citation>
      </ref>
      <ref id="b49">
        <label>[49]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Slotine</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>W.</given-names>
            </name>
          </person-group>
          <article-title>Applied Nonlinear Control</article-title>
          <year>1991</year>
          <publisher-name>Prentice-Hall, Inc</publisher-name>
          <publisher-loc>New Jersey</publisher-loc>
        </citation>
      </ref>
      <ref id="b50">
        <label>[50]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gardner</surname>
              <given-names>W.A.</given-names>
            </name>
            <name>
              <surname>Napolitano</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Paura</surname>
              <given-names>L.</given-names>
            </name>
          </person-group>
          <article-title>Cyclostationarity: Half a century of research</article-title>
          <source>Sig. Process.</source>
          <year>2006</year>
          <volume>86</volume>
          <fpage>639</fpage>
          <lpage>697</lpage>
        </citation>
      </ref>
      <ref id="b51">
        <label>[51]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Gelman</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Carlin</surname>
              <given-names>J.B.</given-names>
            </name>
            <name>
              <surname>Stern</surname>
              <given-names>H.S.</given-names>
            </name>
            <name>
              <surname>Rubin</surname>
              <given-names>D.B.</given-names>
            </name>
          </person-group>
          <article-title>Bayesian Data Analysis</article-title>
          <edition>2d ed.</edition>
          <year>2004</year>
          <publisher-name>Chapman &amp; Hall/CRC editions</publisher-name>
        </citation>
      </ref>
      <ref id="b52">
        <label>[52]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hanson</surname>
              <given-names>F.B.</given-names>
            </name>
            <name>
              <surname>Ryan</surname>
              <given-names>D.</given-names>
            </name>
          </person-group>
          <article-title>Mean and quasideterministic equivalence for linear stochastic dynamics</article-title>
          <source>Math. Biosci.</source>
          <year>1988</year>
          <volume>93</volume>
          <fpage>1</fpage>
          <lpage>14</lpage>
          <pub-id pub-id-type="pmid">2520020</pub-id>
        </citation>
      </ref>
      <ref id="b53">
        <label>[53]</label>
        <citation citation-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Friston</surname>
              <given-names>K.J.</given-names>
            </name>
            <name>
              <surname>Ashburner</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Kiebel</surname>
              <given-names>S.J.</given-names>
            </name>
            <name>
              <surname>Nichols</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Penny</surname>
              <given-names>W.D.</given-names>
            </name>
          </person-group>
          <article-title>Statistical Parametric Mapping, The Analysis of Functional Brain Images</article-title>
          <year>2006</year>
          <publisher-name>Academic Press, Elsevier Ltd.</publisher-name>
          <comment>ISBN: 10: 0-12-372560-7</comment>
        </citation>
      </ref>
      <ref id="b54">
        <label>[54]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Petrelis</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Aumaitre</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Mallick</surname>
              <given-names>K.</given-names>
            </name>
          </person-group>
          <article-title>Escape from a potential well, stochastic resonance and zero-frequency component of the noise</article-title>
          <source>Europhys. Lett.</source>
          <year>2007</year>
          <volume>79</volume>
          <fpage>40004</fpage>
        </citation>
      </ref>
      <ref id="b55">
        <label>[55]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ghahramani</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Hinton</surname>
              <given-names>G.A.</given-names>
            </name>
          </person-group>
          <article-title>Variational learning for switching state-space models</article-title>
          <source>Neural Comput.</source>
          <year>2000</year>
          <volume>12</volume>
          <fpage>831</fpage>
          <lpage>864</lpage>
          <pub-id pub-id-type="pmid">10770834</pub-id>
        </citation>
      </ref>
      <ref id="b56">
        <label>[56]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ito</surname>
              <given-names>H.M.</given-names>
            </name>
          </person-group>
          <article-title>Ergodicity of randomly perturbed Lorenz model</article-title>
          <source>J. Stat. Phys.</source>
          <year>1984</year>
          <volume>35</volume>
          <fpage>151</fpage>
          <lpage>158</lpage>
        </citation>
      </ref>
      <ref id="b57">
        <label>[57]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Turbiner</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Anharmonic oscillator and double-well potential: Approximating eigenfunctions</article-title>
          <source>Lett. Math. Phys.</source>
          <year>2005</year>
          <volume>74</volume>
          <fpage>169</fpage>
          <lpage>180</lpage>
        </citation>
      </ref>
      <ref id="b58">
        <label>[58]</label>
        <citation citation-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Crisan</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Lyons</surname>
              <given-names>T.</given-names>
            </name>
          </person-group>
          <article-title>A particle approximation of the solution of the Kushner–Stratonovitch equation</article-title>
          <source>Probab. Theory Related Fields</source>
          <year>1999</year>
          <volume>115</volume>
          <fpage>549</fpage>
          <lpage>578</lpage>
        </citation>
      </ref>
    </ref-list>
  </back>
  <floats-wrap>
    <fig id="fig1">
      <label>Fig. 1</label>
      <caption>
        <p>Graph representing the generative model m: The sequence of observations <mml:math id="M275" altimg="si2.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> is represented as the plate over T pairs of hidden variables <mml:math id="M276" altimg="si4.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> (<mml:math id="M277" altimg="si5.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math> denotes the initial condition of the hidden-states). φ and θ are unknown parameters of the observation and evolution function. <mml:math id="M278" altimg="si8.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math> is an exogenous input. σ (resp. α) is the precision (inverse variance) of the unknown measurement-noise <mml:math id="M279" altimg="si11.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math> (resp. unknown state-noise <mml:math id="M280" altimg="si12.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math>).</p>
      </caption>
      <graphic xlink:href="gr1"/>
    </fig>
    <fig id="fig2">
      <label>Fig. 2</label>
      <caption>
        <p>Double-well potential stochastic system: The double-well potential (as a function of position) and an example of a path (as a function of time in state-space) are shown. The system is bistable and its state-space exhibits two basin of attraction around two stable fixed points, <mml:math id="M281" altimg="si13.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math> and <mml:math id="M282" altimg="si14.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>. State-noise allows the state to “tunnel” from one basin to the other (see transition points <mml:math id="M283" altimg="si15.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math> and <mml:math id="M284" altimg="si16.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math>), leading to itinerant dynamics.</p>
      </caption>
      <graphic xlink:href="gr2"/>
    </fig>
    <fig id="fig3">
      <label>Fig. 3</label>
      <caption>
        <p>Lorenz attractor: A sample path of the Lorenz system is shown as a function of time (left) and in state-space (right). The Lorenz attractor is a butterfly-shaped strange attractor: the path begins spiralling onto one wing and then jumps onto to the other and so forth, in a chaotic way. Points <mml:math id="M285" altimg="si17.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>, <mml:math id="M286" altimg="si18.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math>, <mml:math id="M287" altimg="si19.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math> and <mml:math id="M288" altimg="si20.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math> are transition points from one wing to the other.</p>
      </caption>
      <graphic xlink:href="gr3"/>
    </fig>
    <fig id="fig4">
      <label>Fig. 4</label>
      <caption>
        <p>van der Pol oscillator: A sample path of the van der Pol oscillator (as a function of time and in state-space) is shown. In this example, the deterministic variant of the system is stable and possesses a limit cycle. The sample path <mml:math id="M289" altimg="si21.gif" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math> shows four periods of the quasi-limit cycle, following a short transient (point <mml:math id="M290" altimg="si22.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>) converging towards the attractor manifold.</p>
      </caption>
      <graphic xlink:href="gr4"/>
    </fig>
    <fig id="fig5">
      <label>Fig. 5</label>
      <caption>
        <p>Comparison between the VB-Laplace and the EKF approaches: a double-well potential example: The figure depicts the estimated hidden-states of a simulated Double-well system as given respectively by the VB-Laplace and the EKF methods. Top-left: first- (solid line) and second-order (shaded area) moments of the VB-Laplace approximate predictive density over observations, and simulated data (dashed line — here superimposed). Bottom-left: first- (solid line) and second-order (shaded area) moments of the VB-Laplace approximate posterior density over hidden-states, and simulated hidden-states (dashed line). Top-right: first- (solid line) and second-order (shaded area) moments of the EKF1 approximate posterior density over hidden-states, and simulated hidden-states (dashed line). Top-right: first- (solid line) and second-order (shaded area) moments of the EKF2 approximate posterior density over hidden-states, and simulated hidden-states (dashed line). The second-order moment is represented using the 90% posterior confidence interval (shaded area). Red boxes highlight typical estimation instabilities of the EKF, which are not evidenced by the VB-Laplace approach. Note that when the first-order moment matches the simulated variable, the dashed line is hidden by the solid line.</p>
      </caption>
      <graphic xlink:href="gr5"/>
    </fig>
    <fig id="fig6">
      <label>Fig. 6</label>
      <caption>
        <p>Comparison between the VB-Laplace and the EKF approaches: a Lorenz attractor example: This figure uses the same format as <xref rid="fig5" ref-type="fig">Fig. 5</xref>.</p>
      </caption>
      <graphic xlink:href="gr6"/>
    </fig>
    <fig id="fig7">
      <label>Fig. 7</label>
      <caption>
        <p>Comparison between the VB-Laplace and the EKF approaches: a van der Pol oscillator example: This figure uses the same format as <xref rid="fig5" ref-type="fig">Fig. 5</xref>.</p>
      </caption>
      <graphic xlink:href="gr7"/>
    </fig>
    <fig id="fig8">
      <label>Fig. 8</label>
      <caption>
        <p>Monte Carlo comparison between the VB-Laplace and the EKF approaches: The empirical Monte Carlo distributions of the SEL score (on a logarithmic scale) for all methods (VB-Laplace, EKF1 and EKF2), as a function of the simulated system (top-left: double-well, top-right: Lorenz, bottom-left: van der Pol).</p>
      </caption>
      <graphic xlink:href="gr8"/>
    </fig>
    <fig id="fig9">
      <label>Fig. 9</label>
      <caption>
        <p>Comparison between the VB-Laplace inversion of the true model and of the generic model: a double-well potential example: This figure shows the VB-Laplace estimator of the hidden-states of a simulated Double-well system under both the true and generic models. Top-left: first- (solid line) and second-order (shaded area) moments of the VB-Laplace approximate predictive density over observations, and simulated data (dashed line), under the true model. Bottom-left: first- (solid line) and second-order (shaded area) moments of the VB-Laplace approximate posterior density over hidden-states, and simulated hidden-states (dashed line), under the true model. Top-right: first- (solid line) and second-order (shaded area) moments of the VB-Laplace approximate predictive density over observations, and simulated data (dashed line), under the generic model. Bottom-left: first- (solid line) and second-order (shaded area) moments of the VB-Laplace approximate posterior density over hidden-states, and simulated hidden-states (dashed line), under the generic model. The second-order moment is represented using the 90% posterior confidence interval (shaded area). Red boxes highlight significant estimation errors of the VB-Laplace approach, under the generic model.</p>
      </caption>
      <graphic xlink:href="gr9"/>
    </fig>
    <fig id="fig10">
      <label>Fig. 10</label>
      <caption>
        <p>Comparison between the VB-Laplace inversion of the true model and of the generic model: a Lorenz attractor example: This figure uses the same format as <xref rid="fig9" ref-type="fig">Fig. 9</xref>.</p>
      </caption>
      <graphic xlink:href="gr10"/>
    </fig>
    <fig id="fig11">
      <label>Fig. 11</label>
      <caption>
        <p>Comparison between the VB-Laplace inversion of the true model and of the generic model: a van der Pol oscillator example: This figure uses the same format as <xref rid="fig9" ref-type="fig">Fig. 9</xref>.</p>
      </caption>
      <graphic xlink:href="gr11"/>
    </fig>
    <fig id="fig12">
      <label>Fig. 12</label>
      <caption>
        <p>Monte Carlo assessment of the VB-Laplace model comparison capabilities: The empirical Monte Carlo distributions of the free-energy are given for both models (true and generic), as a function of the simulated system (top-left: double-well, top-right: Lorenz, bottom-left: van der Pol).</p>
      </caption>
      <graphic xlink:href="gr12"/>
    </fig>
    <fig id="fig13">
      <label>Fig. 13</label>
      <caption>
        <p>Comparison between the dynamical structure of the true Lorenz system and its VB-Laplace estimation under the generic model: The figure depicts the matrices A encoding linear effects (left) and B nonlinear effects (right) of the generic model. The top row shows the true A and B matrices of the Lorenz model, which can be expressed in the generic form. The bottom row shows the Monte Carlo average of the VB-Laplace estimator of the A and B matrices, under the generic model.</p>
      </caption>
      <graphic xlink:href="gr13"/>
    </fig>
    <fig id="fig14">
      <label>Fig. 14</label>
      <caption>
        <p>Monte Carlo evaluation of estimation accuracy: states and parameters: The solid line (respectively the dashed line) plots the Monte Carlo 50% percentile (respectively the Monte Carlo 10% and 90% percentiles) of the log relative SEL for the initial conditions, evolution parameters and hidden-states, for each dynamical system, as a function of the number of time-samples T.</p>
      </caption>
      <graphic xlink:href="gr14"/>
    </fig>
    <fig id="fig15">
      <label>Fig. 15</label>
      <caption>
        <p>Monte Carlo evaluation of estimation accuracy: state-noise and precision hyperparameters: This figure uses the same format as <xref rid="fig14" ref-type="fig">Fig. 14</xref>.</p>
      </caption>
      <graphic xlink:href="gr15"/>
    </fig>
    <fig id="fig16">
      <label>Fig. 16</label>
      <caption>
        <p>Monte Carlo evaluation of posterior confidence intervals: The three panels show the relationship between the Monte Carlo mean squared error loss (SEL) and its posterior expectation (<mml:math id="M291" altimg="si30.gif" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:math>) as log–log plots, for the three dynamical systems. Dots (respectively bars) show the Monte Carlo mean (respectively the 90% Monte Carlo confidence intervals) as a function of the sample size: <mml:math id="M292" altimg="si31.gif" display="inline" overflow="scroll"><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mn>5</mml:mn><mml:mo>;</mml:mo><mml:mn>10</mml:mn><mml:mo>;</mml:mo><mml:mn>50</mml:mn><mml:mo>;</mml:mo><mml:mn>100</mml:mn><mml:mo>;</mml:mo><mml:mn>500</mml:mn><mml:mo>;</mml:mo><mml:mn>1000</mml:mn><mml:mo>;</mml:mo><mml:mn>5000</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:math>. These are shown for state-noise (top-left), hidden-states (bottom-left), evolution parameters and initial conditions (top-right). The <mml:math id="M293" altimg="si32.gif" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:math> dashed line depicts perfect self-consistency; i.e. expected loss is equal to measured loss. The area above this diagonal corresponds to underconfidence, where expected loss is greater than measured loss.</p>
      </caption>
      <graphic xlink:href="gr16"/>
    </fig>
    <fig id="fig17">
      <label>Fig. 17</label>
      <caption>
        <p>Short-term predictive power of the VB-Laplace approach: the double-well system: The figure compares the VB-Laplace approximation to the predictive density over hidden-states (bottom) with that obtained from MCMC sampling (top). Only the predictive density over the first hidden-state (<mml:math id="M294" altimg="si33.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math>) is shown. Top-left: MCMC predictive density using the true parameters. Top-right: MCMC predictive density using the VB-Laplace estimates. The red arrows depict the burn-in period (before entering a quasi-stationary bimodal state).</p>
      </caption>
      <graphic xlink:href="gr17"/>
    </fig>
    <fig id="fig18">
      <label>Fig. 18</label>
      <caption>
        <p>Short-term predictive power of the VB-Laplace approach: the Lorenz system: This figure uses the same format as <xref rid="fig17" ref-type="fig">Fig. 17</xref>.</p>
      </caption>
      <graphic xlink:href="gr18"/>
    </fig>
    <fig id="fig19">
      <label>Fig. 19</label>
      <caption>
        <p>Short-term predictive power of the VB-Laplace approach: the Lorenz system: This figure uses the same format as <xref rid="fig17 fig18" ref-type="fig">Figs. 17 and 18</xref>.</p>
      </caption>
      <graphic xlink:href="gr19"/>
    </fig>
    <fig id="fig20">
      <label>Fig. 20</label>
      <caption>
        <p>Long-term predictive power of the VB-Laplace approach: the double-well system: The figure compares the VB-Laplace approximation to the sojourn density over hidden-states (bottom) with that obtained from MCMC sampling (top). Top-left: MCMC predictive density using the true parameters. Top-right: MCMC predictive density using the VB-Laplace estimates. The red dashed circle depicts the position of the missing mode of the sojourn density.</p>
      </caption>
      <graphic xlink:href="gr20"/>
    </fig>
    <fig id="fig21">
      <label>Fig. 21</label>
      <caption>
        <p>Long-term predictive power of the VB-Laplace approach: the Lorenz system: This figure uses the same format as <xref rid="fig20" ref-type="fig">Fig. 20</xref>. Note that the sojourn density has been marginalized over <mml:math id="M295" altimg="si34.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math> to give <mml:math id="M296" altimg="si35.gif" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math>.</p>
      </caption>
      <graphic xlink:href="gr21"/>
    </fig>
    <fig id="fig22">
      <label>Fig. 22</label>
      <caption>
        <p>Long-term predictive power of the VB-Laplace approach: the van der Pol system: This figure uses the same format as <xref rid="fig20 fig21" ref-type="fig">Figs. 20 and 21</xref>.</p>
      </caption>
      <graphic xlink:href="gr22"/>
    </fig>
    <table-wrap position="float" id="tbl1">
      <label>Table 1</label>
      <caption>
        <p>ODEs of three chaotic dynamical systems.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <tbody>
          <tr>
            <td align="left">Double-well</td>
            <td align="left">
              <mml:math id="M297" altimg="si36.gif" display="inline" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>˙</mml:mo>
                  </mml:mrow>
                </mml:mover>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>θ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>θ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>θ</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>θ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>θ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Lorenz</td>
            <td align="left">
              <mml:math id="M298" altimg="si37.gif" display="inline" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>˙</mml:mo>
                  </mml:mrow>
                </mml:mover>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>θ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>θ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>3</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>θ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">van der Pol</td>
            <td align="left">
              <mml:math id="M299" altimg="si38.gif" display="inline" overflow="scroll">
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>˙</mml:mo>
                  </mml:mrow>
                </mml:mover>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="center">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>θ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="tbl2">
      <label>Table 2</label>
      <caption>
        <p>Parameters of the generative model for the three simulated dynamical systems.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left"/>
            <th align="left"/>
            <th align="left">Double-well</th>
            <th align="left">Lorenz</th>
            <th align="left">van der Pol</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="2">Measurement-noise precision</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M300" altimg="si39.gif" display="inline" overflow="scroll">
                <mml:mi>σ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M301" altimg="si40.gif" display="inline" overflow="scroll">
                <mml:mi>σ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M302" altimg="si41.gif" display="inline" overflow="scroll">
                <mml:mi>σ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M303" altimg="si42.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M304" altimg="si43.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>5</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M305" altimg="si44.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="2">System-noise precision</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M306" altimg="si45.gif" display="inline" overflow="scroll">
                <mml:mi>α</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M307" altimg="si46.gif" display="inline" overflow="scroll">
                <mml:mi>α</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M308" altimg="si47.gif" display="inline" overflow="scroll">
                <mml:mi>α</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M309" altimg="si48.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M310" altimg="si49.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M311" altimg="si50.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="2">Evolution parameters</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M312" altimg="si51.gif" display="inline" overflow="scroll">
                <mml:mi>θ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>3</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>3</mml:mn>
                      <mml:mo>/</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>T</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M313" altimg="si52.gif" display="inline" overflow="scroll">
                <mml:mi>θ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>28</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>10</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>8</mml:mn>
                      <mml:mo>/</mml:mo>
                      <mml:mn>3</mml:mn>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>T</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M314" altimg="si53.gif" display="inline" overflow="scroll">
                <mml:mi>θ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M315" altimg="si54.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M316" altimg="si55.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>10</mml:mn>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M317" altimg="si56.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="2">Initial conditions</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M318" altimg="si57.gif" display="inline" overflow="scroll">
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mn>5</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="normal">
                        <mml:mi>T</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M319" altimg="si58.gif" display="inline" overflow="scroll">
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M320" altimg="si59.gif" display="inline" overflow="scroll">
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M321" altimg="si60.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mn>5</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>T</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M322" altimg="si61.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M323" altimg="si62.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="2">Observation function</td>
            <td align="left">b</td>
            <td align="left">0.5</td>
            <td align="left">0.2</td>
            <td align="left">5</td>
          </tr>
          <tr>
            <td align="left">
              <mml:math id="M324" altimg="si64.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>G</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">50</td>
            <td align="left">50</td>
            <td align="left">50</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="tbl3">
      <label>Table 3</label>
      <caption>
        <p>Monte Carlo average log-SEL for the VB-Laplace, EKF1 and EKF2 approaches for three different stochastic systems.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left"/>
            <th align="left">Double-Well</th>
            <th align="left">Lorenz</th>
            <th align="left">van der Pol</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">VB-Laplace</td>
            <td align="left">3.32</td>
            <td align="left">4.24</td>
            <td align="left">4.02</td>
          </tr>
          <tr>
            <td align="left">EKF1</td>
            <td align="left">8.80 <xref rid="tblfn3.a" ref-type="table-fn">a</xref></td>
            <td align="left">8.58 <xref rid="tblfn3.a" ref-type="table-fn">a</xref></td>
            <td align="left">13.9 <xref rid="tblfn3.a" ref-type="table-fn">a</xref></td>
          </tr>
          <tr>
            <td align="left">EKF2</td>
            <td align="left">3.35</td>
            <td align="left">4.19 <xref rid="tblfn3.a" ref-type="table-fn">a</xref></td>
            <td align="left">4.39 <xref rid="tblfn3.a" ref-type="table-fn">a</xref></td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn3.a">
          <label>a</label>
          <p>Indicates a significant difference relative to the corresponding VB-Laplace SEL score (one-sample paired t-test, 5% confidence level, df=49). The grey cells of the table indicate which of the three approaches (VB-Laplace, EKF1 or EKF2) were best, in terms of efficiency.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap position="float" id="tbl4">
      <label>Table 4</label>
      <caption>
        <p>Prior density over the evolution parameters for the “generic” model for the three dynamical systems.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left"/>
            <th align="left">Double-well</th>
            <th align="left">Lorenz</th>
            <th align="left">van der Pol</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">Evolution parameters prior pdf</td>
            <td align="left">
              <mml:math id="M325" altimg="si66.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M326" altimg="si67.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>27</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>10</mml:mn>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>27</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M327" altimg="si68.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>10</mml:mn>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <table-wrap position="float" id="tbl5">
      <label>Table 5</label>
      <caption>
        <p>Monte Carlo averages of model accuracy indices: free-energy, goodness-of-fit (SSE) and estimation loss (SEL) as functions of the class stochastic systems.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left"/>
            <th align="left"/>
            <th align="left">Double-well</th>
            <th align="left">Lorenz</th>
            <th align="left">van der Pol</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="2">Free-energy</td>
            <td align="left">Native model</td>
            <td align="left">−1.98×10<sup>3</sup><xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
            <td align="left">1.04×10<sup>6</sup></td>
            <td align="left">−5.55× 10<sup>2</sup><xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
          </tr>
          <tr>
            <td align="left">Generic model</td>
            <td align="left">−3.04×10<sup>3</sup></td>
            <td align="left">1.05×10<sup>6</sup><xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
            <td align="left">−8.83× 10<sup>2</sup></td>
          </tr>
          <tr>
            <td align="left" rowspan="2">log SSE</td>
            <td align="left">Native model</td>
            <td align="left">0.53 <xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
            <td align="left">0.37 <xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
            <td align="left">3.58</td>
          </tr>
          <tr>
            <td align="left">Generic model</td>
            <td align="left">0.60</td>
            <td align="left">0.72</td>
            <td align="left">2.93 <xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
          </tr>
          <tr>
            <td align="left" rowspan="2">log-SEL</td>
            <td align="left">Native model</td>
            <td align="left">3.32 <xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
            <td align="left">4.24 <xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
            <td align="left">4.00 <xref rid="tblfn5.a" ref-type="table-fn">a</xref></td>
          </tr>
          <tr>
            <td align="left">Generic model</td>
            <td align="left">6.29</td>
            <td align="left">6.98</td>
            <td align="left">5.01</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn5.a">
          <label>a</label>
          <p>Indicates a significant difference between the true and generic models (one-sample paired t-test, 5% confidence level, df=49). Grey cells indicate which of the two models (true or generic) are best with respect to the three indices.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap position="float" id="tbl6">
      <label>Table 6</label>
      <caption>
        <p>Parameters of the generative model for the three dynamical systems.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left"/>
            <th align="left"/>
            <th align="left">Double-well</th>
            <th align="left">Lorenz</th>
            <th align="left">van der Pol</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="2">Measurement-noise precision</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M328" altimg="si70.gif" display="inline" overflow="scroll">
                <mml:mi>σ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M329" altimg="si71.gif" display="inline" overflow="scroll">
                <mml:mi>σ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M330" altimg="si72.gif" display="inline" overflow="scroll">
                <mml:mi>σ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M331" altimg="si73.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M332" altimg="si74.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M333" altimg="si75.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="2">System-noise precision</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M334" altimg="si76.gif" display="inline" overflow="scroll">
                <mml:mi>α</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M335" altimg="si77.gif" display="inline" overflow="scroll">
                <mml:mi>α</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M336" altimg="si78.gif" display="inline" overflow="scroll">
                <mml:mi>α</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M337" altimg="si79.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M338" altimg="si80.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M339" altimg="si81.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="2">Evolution parameters</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M340" altimg="si82.gif" display="inline" overflow="scroll">
                <mml:mi>θ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>3</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>3</mml:mn>
                      <mml:mo>/</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>T</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M341" altimg="si83.gif" display="inline" overflow="scroll">
                <mml:mi>θ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>28</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>10</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>8</mml:mn>
                      <mml:mo>/</mml:mo>
                      <mml:mn>3</mml:mn>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>T</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M342" altimg="si84.gif" display="inline" overflow="scroll">
                <mml:mi>θ</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M343" altimg="si85.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>10</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M344" altimg="si86.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>10</mml:mn>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M345" altimg="si87.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>10</mml:mn>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="2">Initial conditions</td>
            <td align="left">Simulated</td>
            <td align="left">
              <mml:math id="M346" altimg="si88.gif" display="inline" overflow="scroll">
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mn>5</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="normal">
                        <mml:mi>T</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M347" altimg="si89.gif" display="inline" overflow="scroll">
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M348" altimg="si90.gif" display="inline" overflow="scroll">
                <mml:mo>∼</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mn>10</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:math>
            </td>
          </tr>
          <tr>
            <td align="left">Prior pdf</td>
            <td align="left">
              <mml:math id="M349" altimg="si91.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mn>5</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>T</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M350" altimg="si92.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
            <td align="left">
              <mml:math id="M351" altimg="si93.gif" display="inline" overflow="scroll">
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ς</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>υ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
            </td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </floats-wrap>
</article>