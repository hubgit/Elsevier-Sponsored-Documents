<article xmlns="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle http://dtd.nlm.nih.gov/2.0/xsd/archivearticle.xsd" article-type="research-article">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Epilepsy Behav</journal-id>
      <journal-title-group>
        <journal-title>Epilepsy &amp; Behavior</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1525-5050</issn>
      <issn pub-type="epub">1525-5069</issn>
      <publisher>
        <publisher-name>Academic Press</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmc">3280702</article-id>
      <article-id pub-id-type="pmid">22078519</article-id>
      <article-id pub-id-type="publisher-id">YEBEH2822</article-id>
      <article-id pub-id-type="doi">10.1016/j.yebeh.2011.08.041</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Quickest detection of drug-resistant seizures: An optimal control approach</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Santaniello</surname>
            <given-names>Sabato</given-names>
          </name>
          <xref rid="af0005" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Burns</surname>
            <given-names>Samuel P.</given-names>
          </name>
          <xref rid="af0005" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Golby</surname>
            <given-names>Alexandra J.</given-names>
          </name>
          <xref rid="af0010" ref-type="aff">b</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Singer</surname>
            <given-names>Jedediah M.</given-names>
          </name>
          <xref rid="af0015" ref-type="aff">c</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>William S.</given-names>
          </name>
          <xref rid="af0020" ref-type="aff">d</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Sarma</surname>
            <given-names>Sridevi V.</given-names>
          </name>
          <email>ssarma2@jhu.edu</email>
          <xref rid="af0005" ref-type="aff">a</xref>
          <xref rid="cr0005" ref-type="corresp">⁎</xref>
        </contrib>
      </contrib-group>
      <aff id="af0005"><label>a</label>Department of Biomedical Engineering, Johns Hopkins University, Baltimore, MD, USA</aff>
      <aff id="af0010"><label>b</label>Department of Neurosurgery and Department of Radiology, Brigham and Women's Hospital, Boston, MA, USA</aff>
      <aff id="af0015"><label>c</label>Department of Ophthalmology and Neurology, Children's Hospital, Boston, MA, USA</aff>
      <aff id="af0020"><label>d</label>Department of Neurosurgery, Johns Hopkins Hospital, Baltimore, MD, USA</aff>
      <author-notes>
        <corresp id="cr0005"><label>⁎</label>Corresponding author at: Institute for Computational Medicine, Johns Hopkins University, Hackerman Hall 316c, Baltimore, MD 21218–2686, USA. Fax: + 1 410 516 5294. <email>ssarma2@jhu.edu</email></corresp>
      </author-notes>
      <pub-date pub-type="pmc-release">
        <month>12</month>
        <year>2011</year>
      </pub-date>
      <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="ppub"/>. -->
      <pub-date pub-type="ppub">
        <month>12</month>
        <year>2011</year>
      </pub-date>
      <volume>22</volume>
      <issue>7-5</issue>
      <fpage>S49</fpage>
      <lpage>S60</lpage>
      <history>
        <date date-type="rev-recd">
          <day>22</day>
          <month>8</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>29</day>
          <month>8</month>
          <year>2011</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2011 Elsevier Inc.</copyright-statement>
        <copyright-year>2011</copyright-year>
        <copyright-holder>Elsevier Inc.</copyright-holder>
        <license>
          <license-p>This document may be redistributed and reused, subject to <ext-link ext-link-type="uri" xlink:href="http://www.elsevier.com/wps/find/authorsview.authors/supplementalterms1.0">certain conditions</ext-link>.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Epilepsy affects 50 million people worldwide, and seizures in 30% of the cases remain drug resistant. This has increased interest in responsive neurostimulation, which is most effective when administered during seizure onset. We propose a novel framework for seizure onset detection that involves (i) constructing statistics from multichannel intracranial EEG (iEEG) to distinguish nonictal versus ictal states; (ii) modeling the dynamics of these statistics in each state and the state transitions; you can remove this word if there is no room. (iii) developing an optimal control-based “quickest detection” (QD) strategy to estimate the transition times from nonictal to ictal states from sequential iEEG measurements. The QD strategy minimizes a cost function of detection delay and false positive probability. The solution is a threshold that non-monotonically decreases over time and avoids responding to rare events that normally trigger false positives. We applied QD to four drug resistant epileptic patients (168 hour continuous recordings, 26–44 electrodes, 33 seizures) and achieved 100% sensitivity with low false positive rates (0.16 false positive/hour). This article is part of a Supplemental Special Issue entitled The Future of Automated Seizure Detection and Prediction.</p>
      </abstract>
      <abstract abstract-type="graphical">
        <title>Highlights</title>
        <p>► A control-theoretical framework for automatic online seizure detection is proposed. ► This framework combines iEEGs, network-based statistics, and optimization tools. ► The detection algorithm minimizes detection delays and probability of false alarms. ► Reported results show 100% sensitivity and low false positive rates.</p>
      </abstract>
      <kwd-group>
        <title>Keywords</title>
        <kwd>Quickest detection</kwd>
        <kwd>Bayesian estimation</kwd>
        <kwd>Multivariate analysis</kwd>
        <kwd>Intracranial electroencephalogram</kwd>
        <kwd>Optimal control</kwd>
        <kwd>Hidden Markov model</kwd>
        <kwd>Dynamic programming</kwd>
        <kwd>Networks</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="s0005">
      <label>1</label>
      <title>Introduction</title>
      <p>Automatic online seizure detection (AOSD) in intractable epilepsy has generated great interest in the last 20 years and is a fundamental step toward the development of neurostimulation-based responsive antiepileptic therapies <xref rid="bb0005 bb0010 bb0015" ref-type="bibr">[1–3]</xref>. Pioneering works in the late 1970s and early 1980s by Gotman et al. <xref rid="bb0020 bb0025" ref-type="bibr">[4,5]</xref> showed that seizures can be automatically separated from interictal activity, and since then, several approaches to AOSD have been proposed by exploiting either scalp or intracranial EEG recordings, single or multichannel analysis, linear or nonlinear features.</p>
      <p>Osorio et al. <xref rid="bb0030 bb0035 bb0040 bb0045" ref-type="bibr">[6–9]</xref> used a wavelet-based decomposition of selected intracranial EEG recordings (iEEGs) to (i) separate the seizure-related component from the background noise, (ii) track the ratio between these components in the time–frequency domain, and (iii) detect a seizure when such a ratio crosses a fixed threshold for a sufficiently long time. Parameters of the detection method (e.g., threshold, duration of the suprathreshold condition, etc.) can be either fixed <xref rid="bb0030" ref-type="bibr">[6]</xref> or adaptive <xref rid="bb0035 bb0040" ref-type="bibr">[7,8]</xref>. Fixed threshold-based approaches were also proposed in <xref rid="bb0050 bb0055 bb0060" ref-type="bibr">[10–12]</xref>, where the threshold was applied to linear spectral features of the iEEGs.</p>
      <p>Gotman et al. <xref rid="bb0065 bb0070 bb0075" ref-type="bibr">[13–15]</xref> proposed a probabilistic framework for seizure detection using both scalp EEGs <xref rid="bb0075" ref-type="bibr">[15]</xref> and iEEGs <xref rid="bb0065 bb0070" ref-type="bibr">[13,14]</xref>. In this framework, amplitude and energy measures in multiple frequency bands are computed for each channel via wavelet decomposition and the corresponding sampled probability distribution function is estimated. Then, the probability of a seizure is conditioned to the value of such measures and estimated via Bayes’ rule. A patient-specific threshold is finally applied on this conditional probability of seizure to decide, for each channel, whether a seizure is likely or not, and a seizure is detected when that threshold is passed in a sufficient number of channels.</p>
      <p>In all the studies mentioned above, the AOSD was solved by (i) introducing a relevant statistic that is computed from the available measurements and that captures changes in brain activity at the seizure onset, and (ii) a rule that, based on this statistic, determines whether a seizure has occurred or not.</p>
      <p>More recently, AOSD has been implemented using sophisticated classification tools. In particular, EEG channels (either scalp or intracortical) have been processed individually to extract multiple univariate or bivariate features in time, frequency, or wavelet domain <xref rid="bb0080 bb0085 bb0090 bb0095 bb0100 bb0105 bb0110 bb0115 bb0120 bb0125 bb0130 bb0135 bb0140 bb0145 bb0150 bb0155 bb0160" ref-type="bibr">[16–32]</xref>. Then, for each channel, the available features have been combined into vectors and classified via support vector machines (SVM) <xref rid="bb0105 bb0115 bb0125 bb0145" ref-type="bibr">[21,23,25,29]</xref>, principal component analysis (PCA) <xref rid="bb0135 bb0140" ref-type="bibr">[27,28]</xref>, artificial neural networks (ANN) <xref rid="bb0080 bb0090 bb0095 bb0100 bb0120 bb0150 bb0155 bb0160" ref-type="bibr">[16,18–20,24,30–32]</xref>, fuzzy logics <xref rid="bb0110" ref-type="bibr">[22]</xref>, or pattern recognition tools <xref rid="bb0085" ref-type="bibr">[17]</xref>. Finally, decisions made for different channels have been combined or ranked to ultimately determine whether a seizure has occurred or not. As a variation to this paradigm, <xref rid="bb0130 bb0165" ref-type="bibr">[26,33]</xref> merged features extracted from different channels into one vector and applied the classification rule to this vector.</p>
      <p>Although many of the aforementioned methods have sensitivity well above 90%, results generally show lower specificity (i.e., higher number of false positives) when applied to test data, and a comparative study by Lee et al. <xref rid="bb0170" ref-type="bibr">[34]</xref> reported performance varying from patient to patient. This may not be surprising considering that (i) several parameters in these methods are patient specific and tuned heuristically; and (ii) these methods do not explicitly minimize relevant detection performance criteria (e.g., delay or probability of false positives). The latter drawback reflects the important fact that current detection paradigms develop algorithms first which then define and limit the performances. We believe that performance specifications should be stated up front in a cost function to be minimized (e.g., delay length, false positive rate, etc.) which then defines the algorithm.</p>
      <p>We propose a novel computational framework for AOSD that involves (a) constructing network-based statistics from multichannel neural data to distinguish nonictal from ictal states; (b) modeling the evolution of such statistics in nonictal and ictal states and their transition probabilities; and (c) developing an optimal model-based strategy that detects the transitions from nonictal to ictal states by using sequential multichannel measurements. The combination of (a) and (b) results in a <italic>dynamic detector,</italic> which, unlike a standard classifier, evolves over time based on current and past measurements, thus automatically adapting to brain dynamics.</p>
      <p>In our formulation, AOSD is posed as a change-point detection problem and solved by minimizing a cost function of the average distance between actual and estimated seizure onset, the probability of false positives and the probability of delayed detection. This formulation is a variation of the “Quickest Detection” (QD) <xref rid="bb0175 bb0180" ref-type="bibr">[35,36]</xref>, whose theory we extended to allow for different cost functions and, more importantly, for dependent measurements, which is more applicable to neural data <xref rid="bb0185" ref-type="bibr">[37]</xref>.</p>
      <p>We applied our framework to four subjects with drug-resistant seizures (168 hours [h] of continuous recordings from 26–44 iEEG electrodes, 33 seizures), which resulted in 100% sensitivity on both training and validation data, low false-positive rate (min: 0.16 false positive/hour [FP/h]; max: 2.95 FP/h; mean: 1.39 FP/h), and an average detection delay of 9.6 seconds. Compared with a standard Bayesian and a heuristic threshold detector (i.e., non-optimal policies for which no explicit cost function is minimized), our approach showed lower false-positive rates and higher sensitivity.</p>
    </sec>
    <sec sec-type="methods" id="s0010">
      <label>2</label>
      <title>Methods</title>
      <sec id="s0015">
        <label>2.1</label>
        <title>Clinical data</title>
        <p>Four subjects with intractable epilepsy were surgically implanted with subdural grid and strip electrodes (26–75 channels, Ad-Tech® Medical Instrument Corp., Racine, WI, USA) for approximately 1 week before surgical resection of the focal region and monitored by clinicians for seizures and interictal epileptic activity. Electrodes are 4 mm diameter platinum contacts embedded in a silicone sheet with 2.3 mm exposed. Data were digitized and stored using an XLTEK® EMU128FS system (Natus Medical Incorporated, San Carlos, CA, USA) with 250 to 500 Hz sampling frequency. <xref rid="t0005" ref-type="table">Table 1</xref> and <xref rid="f0005" ref-type="fig">Fig. 1</xref> report patient-specific information, number of electrodes included in this study, and electrode position.</p>
        <p>Board-certified electroencephalographers (up to three) marked, by consensus, the unequivocal electrographic onset (UEO) <xref rid="bb0190" ref-type="bibr">[38]</xref> of each seizure and the period between seizure onset and termination. The time of seizure onset was indicated by a variety of stereotypical electrographic features, which could include, but were not limited to, the onset of fast rhythmic activity, an isolated spike or spike–wave complex followed by rhythmic activity, or an electrodecremental response. These features were typically present in one to a few channels at ictal onset. At all times, concurrent changes in the patient's behavior were sought from the video segment of a video-EEG recording. UEOs were used as the “gold standard” for evaluating the performance of the detection algorithm. Electrode recordings (iEEG in the following) included in this study were made available to the authors with the written consent of the patients, in accordance with the protocol approved by the institutional review boards at Brigham and Women's Hospital and Children's Hospital, Boston, MA, USA. Recordings included in this study cover a period of two consecutive days per patient (days with seizures).</p>
      </sec>
      <sec id="s0020">
        <label>2.2</label>
        <title>Multichannel analysis</title>
        <p>Recent studies have introduced schemes that analyze all the available electrode channels simultaneously <xref rid="bb0195 bb0300 bb0305 bb0310 bb0315 bb0320 bb0200 bb0325 bb0330 bb0205" ref-type="bibr">[39–48]</xref>. In these schemes, each electrode is treated as a node in a graph, and any two nodes are considered <italic>connected</italic> (i.e., an edge exists between them) if the activities at these sites are dependent. The connectivity (topology) of the graph can then be described by a matrix. Statistics computed from this matrix (which is referred to as “connectivity” or “adjacency” matrix <xref rid="bb0210" ref-type="bibr">[49]</xref>) can show if the topology changes significantly from nonictal to ictal states or vice versa, and significant changes in these statistics can be used to detect a seizure onset.</p>
        <p>In order to capture potential linear dependencies between all of the recording sites, we computed the connectivity matrix, <italic>A</italic>, as the cross-power in a chosen frequency band (theta, alpha, etc.) between the available iEEG channels. That is, for each pair of channels (<italic>i</italic>, <italic>j</italic>) the corresponding element of the connectivity matrix, <italic>A</italic><sub><italic>ij</italic></sub>, was<disp-formula id="fo0005"><label>(1)</label><mml:math id="M1" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≜</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mi>ω</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>ω</mml:mi><mml:mspace width="0.5em"/></mml:mrow></mml:math></disp-formula>where <italic>P</italic><sub><italic>ij</italic></sub>(<italic>ω</italic>) is the cross-power spectral density of channels <italic>i</italic> and <italic>j</italic> at frequency <italic>ω</italic>
<xref rid="bb0215" ref-type="bibr">[50]</xref>. The frequency band [<italic>lb</italic>, <italic>ub</italic>] in (1) was patient specific and chosen among theta (4–7 Hz), alpha (8–13 Hz), and beta (14–30 Hz) bands (see <xref rid="t0005" ref-type="table">Table 1</xref> for the selection criteria) in our data set. Finally, the matrix <italic>A</italic> was computed over a 5-second-long sliding window (1-second [s] slide), resulting in a sequence of matrices {<italic>A</italic>(<italic>k</italic>)}, one for each time second <italic>k</italic>.</p>
        <sec id="s0025">
          <label>2.2.1</label>
          <title>Singular value decomposition</title>
          <p>It has been reported that the brain enters a more organized, lower-complexity state prior to a seizure <xref rid="bb0220 bb0225" ref-type="bibr">[51,52]</xref>. As the brain becomes more organized and nodes become more connected, the <italic>rank</italic> (number of linearly independent rows or columns) of the connectivity matrix drops. The singular value decomposition (SVD) of a matrix highlights the rank of a matrix and also generates a weighted set of vectors that span the range space and null space of the matrix <xref rid="bb0230" ref-type="bibr">[53]</xref>. We therefore used SVD to measure the time-varying complexity of the brain by tracking the rank and its associated subspaces as a means to characterize nonictal versus ictal states.</p>
          <p>The SVD of a generic <italic>m</italic> × <italic>n</italic> connectivity matrix <italic>A</italic> is defined as <disp-formula id="fo0010"><label>(2)</label><inline-graphic xlink:href="fx1.gif"/></disp-formula>where <italic>U</italic> is an <italic>m</italic> × <italic>m</italic> unitary (<italic>UU</italic>* = <italic>I</italic>) matrix whose columns, <bold><italic>u</italic></bold><sub><italic>i</italic></sub>, are the eigenvectors of the matrix <italic>AA</italic>*, <italic>V</italic> is an <italic>n</italic> × <italic>n</italic> unitary matrix whose columns, <bold><italic>v</italic></bold><sub><italic>i</italic></sub>, are the eigenvectors of the matrix <italic>A</italic>*<italic>A</italic>, and * denotes the complex conjugate transpose operator. <italic>S</italic> is an <italic>m</italic> × <italic>n</italic> matrix whose first <italic>r</italic> diagonal entries <italic>σ</italic><sub>1</sub> ≥ <italic>σ</italic><sub>2</sub> ≥ … ≥ <italic>σ</italic><sub><italic>r</italic></sub> are the nonzero singular values of <italic>A</italic>, with <italic>r</italic> being the rank of <italic>A</italic>
<xref rid="bb0230" ref-type="bibr">[53]</xref>. The first <italic>r</italic> columns of <italic>U</italic> span the column space of <italic>A</italic> and the first <italic>r</italic> rows of <italic>V</italic> span the row space of <italic>A</italic>. When <italic>m</italic> = <italic>n</italic> and <italic>A</italic> is symmetric, the SVD reduces to the conventional eigenvalue decomposition, where the singular values are the square of the eigenvalues of <italic>A, U = V</italic><sup>− 1</sup>, and the columns of <italic>U</italic> and <italic>V</italic> are the eigenvectors of <italic>A</italic>
<xref rid="bb0230" ref-type="bibr">[53]</xref>.</p>
          <p>An example is shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>. Here, two three-node graphs are analyzed. In <xref rid="f0010" ref-type="fig">Fig. 2</xref>A all the nodes have similar weak connections (strength ≤ 1). The SVD of the corresponding connectivity matrix, <italic>A</italic>, reveals that the matrix of this graph has full rank (three non-zeros and comparable singular values). More physically, full rank here indicates that the activity in the three nodes spans a three-dimensional space, or has 3 degrees of freedom.</p>
          <p>If one of the connections is strengthened, as is the case between nodes 1 and 2 (<xref rid="f0010" ref-type="fig">Fig. 2</xref>B)<italic>,</italic> one of the singular values of the corresponding connectivity matrix, <italic>B</italic>, becomes small in comparison to the other two, indicating that the rank of matrix has approximately dropped to 2. This means that with the addition of one strong connection, the activity of the graph collapses to two dimensions and become more “ordered”. The singular vectors of graphs in <xref rid="f0010" ref-type="fig">Figs. 2</xref>A and B are plotted in <xref rid="f0010" ref-type="fig">Fig. 2</xref>C and indicate that the dominant direction of the vectors has rotated and the average amplification of the connectivity matrix has increased when the strong connection is added. We investigate the first (i.e., maximum) singular value, <italic>σ</italic><sub>1</sub>(<italic>k</italic>), from each connectivity matrix <italic>A</italic>(<italic>k</italic>) computed in (1) and apply QD on this statistic.</p>
        </sec>
      </sec>
      <sec id="s0030">
        <label>2.3</label>
        <title>Quickest detection of seizure onsets</title>
        <sec id="s0035">
          <label>2.3.1</label>
          <title>Hidden Markov model estimation</title>
          <p>For any given patient, we assume that the maximum singular value computed at each second (observations), <italic>z</italic><sub><italic>k</italic></sub> ≜ <italic>σ</italic><sub>1</sub>(<italic>k</italic>), <italic>k</italic> = 1, 2, …, is generated by a hidden Markov model (HMM) <xref rid="bb0235" ref-type="bibr">[54]</xref>. At each stage <italic>k</italic> ≥ 0, the brain is in one of <italic>m</italic> states, that is, <italic>x</italic><sub><italic>k</italic></sub> ∈ {0, 1, …, <italic>m</italic>− 1}, which follows a Markov chain <xref rid="bb0235" ref-type="bibr">[54]</xref>,<disp-formula id="fo0015"><alternatives><textual-form specific-use="jats-markup">Pr(<italic>x</italic><sub><italic>k</italic> + 1</sub> = <italic>j</italic>|<italic>x</italic><sub><italic>k</italic></sub> = <italic>i</italic>, <italic>x</italic><sub><italic>k</italic> − 1</sub>, …, <italic>x</italic><sub>0</sub>) = Pr(<italic>x</italic><sub><italic>k</italic> + 1</sub> = <italic>j</italic>|<italic>x</italic><sub><italic>k</italic></sub> = <italic>i</italic>) ≜ <italic>p</italic><sub><italic>ij</italic></sub>, </textual-form><mml:math id="M2" altimg="si2.gif" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Pr</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>≜</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula><disp-formula id="fo0020"><label>(3)</label><mml:math id="M3" altimg="si3.gif" overflow="scroll"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="italic">ih</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.5em"/><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>,</mml:mtext></mml:mrow></mml:math></disp-formula>for all <italic>i</italic>,<italic>j</italic> = 0,1,2,..., <italic>m</italic>−1, where <inline-formula><alternatives><textual-form specific-use="jats-markup"> 𝓅<sub><italic>i</italic></sub> ≜ Pr(<italic>x</italic><sub>0</sub> = <italic>i</italic>), <italic>i</italic> = 0, 1, …, <italic>m</italic> − 1</textual-form><mml:math id="M4" altimg="si4.gif" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≜</mml:mo><mml:mi mathvariant="normal">Pr</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext><mml:mspace width="0.5em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, is the probability of starting in state <italic>i</italic>. For a fixed state <italic>i</italic>, the observations <italic>z</italic><sub><italic>k</italic></sub> are generated according to a known history-dependent probability law <italic>q</italic><sub><italic>i</italic></sub>(<italic>z</italic>|<italic>H</italic><sub><italic>k</italic></sub>) ≜ Pr(<italic>z</italic><sub><italic>k</italic></sub> = <italic>z</italic>|<italic>x</italic><sub><italic>k</italic></sub> = <italic>i</italic>, <italic>H</italic><sub><italic>k</italic></sub>), where <italic>H</italic><sub><italic>k</italic></sub> ≜ {<italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>k</italic>− 1</sub>} denotes the sequence of past observations. Note that the dependency of <italic>z</italic><sub><italic>k</italic></sub> on previous observations is introduced to account for temporal dependencies that exist in neural data. The HMM is uniquely defined by the triple <inline-formula><alternatives><textual-form specific-use="jats-markup">{𝒫, <italic>Σ</italic>, <italic>q</italic>}</textual-form><mml:math id="M5" altimg="si5.gif" overflow="scroll"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi>Σ</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, with<inline-formula><alternatives><textual-form specific-use="jats-markup"> 𝒫 ≜ [𝓅<sub>0</sub>𝓅<sub>1</sub>…𝓅<sub><italic>m</italic> − 1</sub>],</textual-form><mml:math id="M6" altimg="si6.gif" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="script">P</mml:mi><mml:mo>≜</mml:mo><mml:mfenced open="[" close="]"><mml:mrow><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula><italic>Σ</italic><sub><italic>ij</italic></sub> ≜ <italic>p</italic><sub><italic>ij</italic></sub>, <italic>i</italic>, <italic>j</italic> = 0, 1, …, <italic>m</italic>− 1, and <italic>q</italic> ≜ [<italic>q</italic><sub>0</sub> … <italic>q</italic><sub><italic>m</italic>− 1</sub>]. See <xref rid="f0015" ref-type="fig">Fig. 3</xref>A for a schematic of a <italic>m</italic> = 2 state HMM. For our QD framework, we fitted a <italic>m</italic> = 2 state HMM on each patient, with state <italic>x</italic> = 0 and <italic>x</italic> = 1 denoting the nonictal and ictal conditions, respectively (<xref rid="f0015" ref-type="fig">Fig. 3</xref>B). The ictal state begins and ends with the unequivocal ictal onset and offset determined by clinicians. Early ictal or preictal conditions were subsumed in the nonictal state as they may not exist in all patients.</p>
          <p>Because we begin monitoring a patient in the nonictal state 0, we set <inline-formula><alternatives><textual-form specific-use="jats-markup"> 𝒫 = [1 0]</textual-form><mml:math id="M7" altimg="si7.gif" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="[" close="]"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.5em"/><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></inline-formula>. We also assume that the state transition probability matrix is<disp-formula id="fo0025"><label>(4)</label><mml:math id="M8" altimg="si8.gif" overflow="scroll"><mml:mrow><mml:mtext>Σ</mml:mtext><mml:mo>=</mml:mo><mml:mfenced open="[" close="]"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="italic">ρ</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="italic">ρ</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:math></disp-formula>where <italic>ρ</italic> was estimated from training data via maximum likelihood estimation <xref rid="bb0240" ref-type="bibr">[55]</xref>. The output probability law <italic>q</italic><sub><italic>x</italic></sub>(<italic>z</italic>|<italic>H</italic><sub><italic>k</italic></sub>), <italic>x</italic> = 0, 1 was computed by combining generalized linear models (GLMs) <xref rid="bb0245" ref-type="bibr">[56]</xref> and maximum likelihood estimation. Observations were first quantized and mapped to integer nonnegative numbers in order to have a discrete observation domain, i.e., <inline-formula><alternatives><textual-form specific-use="jats-markup"> 𝒬([<italic>z</italic><sub><italic>k</italic></sub>]) ≜ <italic>n</italic><sub><italic>k</italic></sub></textual-form><mml:math id="M9" altimg="si9.gif" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="script">Q</mml:mi><mml:mfenced open="(" close=")"><mml:mfenced open="[" close="]"><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mfenced><mml:mo>≜</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula><mml:math id="M10" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="script">Z</mml:mi><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, for all <italic>k</italic>. Then, we assumed that the probability mass function of the sequence <italic>n</italic><sub><italic>k</italic></sub> follows the Poisson law,<disp-formula id="fo0030"><label>(5)</label><mml:math id="M11" altimg="si11.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>z</mml:mi><mml:mtext>|</mml:mtext><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>≅</mml:mo><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="script">Q</mml:mi><mml:mfenced open="(" close=")"><mml:mfenced open="[" close="]"><mml:mi>z</mml:mi></mml:mfenced></mml:mfenced><mml:mtext>|</mml:mtext><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mo>≜</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mfenced open="(" close=")"><mml:mfenced open="[" close="]"><mml:mi>z</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="script">Q</mml:mi><mml:mfenced open="(" close=")"><mml:mfenced open="[" close="]"><mml:mi>z</mml:mi></mml:mfenced></mml:mfenced><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/></mml:mrow></mml:math></disp-formula>where the instantaneous rate <italic>λ</italic><sub><italic>x</italic>,<italic>k</italic></sub> depends on the current state <italic>x</italic>, stage <italic>k</italic>, and history <italic>H</italic><sub><italic>k</italic></sub>. Finally, we assumed <italic>λ</italic><sub><italic>x</italic>,<italic>k</italic></sub> is given by the GLM<disp-formula id="fo0035"><label>(6)</label><mml:math id="M12" altimg="si12.gif" overflow="scroll"><mml:mrow><mml:mo>log</mml:mo><mml:msub><mml:mi mathvariant="italic">λ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="italic">α</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="italic">β</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>where Θ<sub><italic>x</italic></sub> ≜ {<italic>α</italic><sub><italic>x</italic></sub>, <italic>β</italic><sub><italic>x</italic>, 1</sub>, …, <italic>β</italic><sub><italic>x</italic>, <italic>L</italic></sub>} is a vector of parameters to be fitted on the data via maximum likelihood estimation. The number <italic>L</italic> = 15 of past observations to be used in (6) determines the number of parameters in Θ<sub><italic>x</italic></sub> and was chosen by minimizing the Akaike's information criterion (AIC) <xref rid="bb0250" ref-type="bibr">[57]</xref> over a set of candidate models. For each patient, the parameter vector Θ<sub><italic>x</italic></sub> was estimated separately for state <italic>x</italic> = 0 and <italic>x</italic> = 1 on training data. Such data included 3 h of continuous interictal recordings well before seizure (min 3 h, max 12 h before the seizure) and 1 (patients 1–3) or 2 (patient 4) hand-annotated ictal periods.</p>
        </sec>
        <sec id="s0040">
          <label>2.3.2</label>
          <title>HMM state evolution and QD policy</title>
          <p>Because the state of a HMM is hidden, we introduce the Bayesian <italic>information state variable π</italic><sub><italic>k</italic></sub> ≜ Pr(<italic>x</italic><sub><italic>k</italic></sub> = 1|<italic>z</italic><sub><italic>k</italic></sub>,<italic>H</italic><sub><italic>k</italic></sub>) <xref rid="bb0185 bb0255" ref-type="bibr">[37,58]</xref> in order to estimate how likely the transition from the nonictal to ictal state is at each stage <italic>k</italic>. Note that <italic>π</italic><sub><italic>k</italic></sub> is the <italic>a posteriori</italic> probability of being in state 1 at stage <italic>k</italic> and depends on the observations up to and including stage <italic>k</italic>. The evolution equation of <italic>π</italic><sub><italic>k</italic></sub> is recursive and given by<disp-formula id="fo0040"><label>(7)</label><mml:math id="M13" altimg="si13.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="[" close="]"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="[" close="]"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>≜</mml:mo><mml:msub><mml:mtext>Φ</mml:mtext><mml:mi>k</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:math></disp-formula>with initial condition<disp-formula id="fo0045"><mml:math id="M14" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <italic>q</italic><sub><italic>x</italic></sub>(<italic>z</italic><sub>0</sub>) is the probability of observing <italic>z</italic><sub>0</sub> in state <bold><italic>x</italic></bold> at time <italic>k</italic> = 0, <italic>p</italic><sub>01</sub> = <italic>ρ</italic> because of (4), and <disp-formula id="fo0050"><mml:math id="M15" altimg="si15.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≜</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>is the likelihood ratio. See Appendix for details.</p>
          <p>The Quickest Detection (QD) problem is an <italic>online</italic> decision problem, where at each stage <italic>k</italic> we test the hypothesis <inline-formula><alternatives><textual-form specific-use="jats-markup">ℋ ≜ {<italic>a</italic>
<italic>s</italic><italic>e</italic><italic>i</italic><italic>z</italic><italic>u</italic><italic>r</italic><italic>e</italic>
<italic>o</italic><italic>n</italic><italic>s</italic><italic>e</italic><italic>t</italic>
<italic>h</italic><italic>a</italic><italic>s</italic>
<italic>o</italic><italic>c</italic><italic>c</italic><italic>u</italic><italic>r</italic><italic>r</italic><italic>e</italic><italic>d</italic>}</textual-form><mml:math id="M16" altimg="si16.gif" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">H</mml:mi><mml:mo>≜</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mi>a</mml:mi><mml:mspace width="0.25em"/><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mspace width="0.25em"/><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> conditioned on the observations (<italic>H</italic><sub><italic>k</italic></sub>, <italic>z</italic><sub><italic>k</italic></sub>). We introduce the decision variable <italic>u</italic><sub><italic>k</italic></sub> ∈ {0, 1}, where <italic>u</italic><sub><italic>k</italic></sub> = 0 (<italic>u</italic><sub><italic>k</italic></sub> = 1) denotes that the hypothesis ℋ is rejected (accepted) at stage <italic>k</italic>. In this way,<disp-formula id="fo0055"><label>(8)</label><mml:math id="M17" altimg="si18.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>≜</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mtext>Φ</mml:mtext><mml:mi>k</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mrow><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>&amp;</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where the “<italic>terminate &amp; restart</italic>” state implies that we restart the detection algorithm after a seizure has been detected. With this setup, the detection problem boils down to <italic>deciding when</italic> to switch from <italic>u</italic><sub><italic>k</italic></sub> = 0 to <italic>u</italic><sub><italic>k</italic></sub> = 1 and claiming that a seizure has occurred.</p>
          <p>We designed a decision strategy that minimizes the following cost function, which weighs the average detection delay and the probability of a false positive:<disp-formula id="fo0060"><label>(9)</label><alternatives><textual-form specific-use="jats-markup">𝒥<sub>0</sub> ≜ (1 − <italic>γ</italic>)<italic>E</italic><sub><italic>T</italic><sub>|<italic>T</italic><sub><italic>QD</italic></sub> &lt; <italic>T</italic></sub></sub>{<italic>T</italic> − <italic>T</italic><sub><italic>QD</italic></sub>} + <italic>γ</italic>
<italic>E</italic><sub><italic>T</italic><sub>|<italic>T</italic><sub><italic>QD</italic></sub> &gt; <italic>T</italic></sub></sub>{(<italic>T</italic><sub><italic>QD</italic></sub> − <italic>T</italic>)<sup>2</sup>}</textual-form><mml:math id="M18" altimg="si19.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≜</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">QD</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mfenced open="{" close="}"><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">QD</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>E</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">QD</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mfenced open="{" close="}"><mml:msup><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">QD</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>where <italic>T</italic> and <italic>T</italic><sub><italic>QD</italic></sub> denote the actual and estimated seizure onsets, respectively. <italic>T</italic> is a random variable whose distribution is defined by the HMM transition probabilities, i.e., <italic>P</italic>(<italic>T</italic> = <italic>k</italic>) = (1−<italic>ρ</italic>)<sup><italic>k</italic>− 1</sup><italic>ρ</italic>. It is important to note that a time-varying HMM would determine that <inline-formula><mml:math id="M19" altimg="si20.gif" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mi>i</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
          <p><italic>E</italic><sub><italic>T</italic><sub>|<italic>T</italic><sub><italic>QD</italic></sub> &lt; <italic>T</italic></sub></sub>{∙} and <italic>E</italic><sub><italic>T</italic><sub>|<italic>T</italic><sub><italic>QD</italic></sub> &gt; <italic>T</italic></sub></sub>{∙} denote the expected value of the distance between <italic>T</italic><sub><italic>QD</italic></sub> and <italic>T</italic> in case of false positive (<italic>T</italic><sub><italic>QD</italic></sub> &lt; <italic>T</italic>) and delayed detection (<italic>T</italic><sub><italic>QD</italic></sub> &gt; <italic>T</italic>), respectively. Finally, the parameter <italic>γ</italic> ∈ [0,1] allows one to trade off false-positive and delayed detection, while the expected value <italic>E</italic><sub><italic>T</italic></sub>{∙} accounts for the average temporal distance between actual and estimated seizure onset. Note that the distance <italic>T</italic><sub><italic>QD</italic></sub> − <italic>T</italic> is squared in (9) for <italic>T</italic><sub><italic>QD</italic></sub> &gt; <italic>T</italic> as we intend to penalize more situations where <italic>T</italic><sub><italic>QD</italic></sub> &gt;&gt; <italic>T</italic>, which account for very late detections.</p>
          <p>To construct our QD policy, we constructed the cost (9) as a function of the information state <italic>π</italic><sub><italic>k</italic></sub>. To do so, we first defined a cost-per-stage, <italic>G</italic><sub><italic>k</italic></sub>(<italic>π</italic><sub><italic>k</italic></sub>, <italic>u</italic><sub><italic>k</italic></sub>), that penalizes both rejecting ℋ after the state transition has occurred (i.e., delay, <italic>k</italic> ≥ <italic>T</italic>) and accepting ℋ before the actual state transition has occurred (i.e., false positive, <italic>k</italic> &lt; <italic>T</italic>), and is 0 otherwise:<disp-formula id="fo0065"><mml:math id="M20" altimg="si23.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="italic">u</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>≜</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="italic">γ</mml:mi><mml:msub><mml:mi mathvariant="italic">E</mml:mi><mml:mrow><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi mathvariant="italic">k</mml:mi><mml:mo>&gt;</mml:mo><mml:mi mathvariant="italic">T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">T</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo><mml:mo>∙</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:msub><mml:mi mathvariant="italic">E</mml:mi><mml:mrow><mml:mi mathvariant="italic">T</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi mathvariant="italic">k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="italic">T</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="italic">k</mml:mi><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mo>∙</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="italic">u</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="italic">o</mml:mi><mml:mi mathvariant="italic">t</mml:mi><mml:mi mathvariant="italic">h</mml:mi><mml:mi mathvariant="italic">e</mml:mi><mml:mi mathvariant="italic">r</mml:mi><mml:mi mathvariant="italic">w</mml:mi><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">s</mml:mi><mml:mi mathvariant="italic">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
          <p>Then, the decision deals with choosing the stage <italic>T</italic><sub><italic>QD</italic></sub> &gt; 0 such that the policy (<italic>u</italic><sub>1</sub> = 0, <italic>u</italic><sub>2</sub> = 0, …, <italic>u</italic><sub><italic>T</italic><sub><italic>QD</italic></sub>− 1</sub> = 0, <italic>u</italic><sub><italic>T</italic><sub><italic>QD</italic></sub></sub> = 1) minimizes the overall cost<disp-formula id="fo0070"><label>(10)</label><mml:math id="M21" altimg="si24.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≜</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mfenced open="[" close="]"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow></mml:math></disp-formula>where <italic>G</italic><sub><italic>M</italic></sub>(<italic>π</italic><sub><italic>M</italic></sub>) is the final stage cost for rejecting hypothesis ℋ. <italic>M</italic> is the horizon over which a seizure must be detected, and we set <italic>M</italic> for each patient to be the value of the average inter-seizure interval. It is fairly straightforward to show that (10) is equivalent to (9) <xref rid="bb0260" ref-type="bibr">[59]</xref>. One can interpret the minimization of (10) with respect to the variable <italic>u</italic><sub><italic>k</italic></sub> given the evolution model (8), as an optimal feedback control problem where <italic>u</italic><sub><italic>k</italic></sub> is the control variable (<xref rid="f0015" ref-type="fig">Fig. 3</xref>C). As a control problem, this formulation can be solved recursively via dynamic programming <xref rid="bb0260" ref-type="bibr">[59]</xref>, and leads to the optimal QD policy<disp-formula id="fo0075"><alternatives><textual-form specific-use="jats-markup"><italic>T</italic><sub><italic>QD</italic></sub> = <italic>m</italic><italic>i</italic><italic>n</italic>{0 &lt; <italic>k</italic> &lt; <italic>M</italic>|<italic>π</italic><sub><italic>k</italic></sub> &gt; <italic>F</italic><sub><italic>k</italic></sub>(<italic>π</italic><sub><italic>k</italic></sub>, <italic>z</italic><sub><italic>k</italic></sub>, <italic>H</italic><sub><italic>k</italic></sub>)}</textual-form><mml:math id="M22" altimg="si26.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">QD</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced open="{" close="}"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula>where <italic>F</italic><sub><italic>k</italic></sub>(<italic>π</italic><sub><italic>k</italic></sub>,<italic>z</italic><sub><italic>k</italic></sub>,<italic>H</italic><sub><italic>k</italic></sub>) is an adaptive threshold that depends on the current observation, history, and information state variable. There is no simple closed form expression for <italic>F</italic><sub><italic>k</italic></sub>(∙) which is computed recursively and decreases over time non-monotonically as discussed below. Details on the derivation of <italic>F</italic><sub><italic>k</italic></sub>(∙) can be obtained in <xref rid="bb0185" ref-type="bibr">[37]</xref>.</p>
        </sec>
        <sec id="s0045">
          <label>2.3.3</label>
          <title>Significance and performance tests</title>
          <p>For each patient, we compared the QD policy with a classic Bayesian estimator (BE) <xref rid="bb0255" ref-type="bibr">[58]</xref>, which is widely used in the field of change-point detection <xref rid="bb0175 bb0255" ref-type="bibr">[35,58]</xref>. We also compared the QD policy versus a threshold-based detector (HT), where the threshold is chosen heuristically. The formula for the estimated seizure onset with each of these predictors is<disp-formula id="fo0080"><alternatives><textual-form specific-use="jats-markup"><italic>B</italic><italic>E</italic>:<italic>T</italic><sub><italic>BE</italic></sub> ≜ <italic>m</italic><italic>i</italic><italic>n</italic>{<italic>k</italic> &gt; 0|<italic>π</italic><sub><italic>k</italic></sub> &gt; 0.5}</textual-form><mml:math id="M23" altimg="si27.gif" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mi>E</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">BE</mml:mi></mml:msub><mml:mo>≜</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced open="{" close="}"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula><disp-formula id="fo0085"><mml:math id="M24" altimg="si28.gif" overflow="scroll"><mml:mrow><mml:mi>H</mml:mi><mml:mi>T</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="italic">HT</mml:mi></mml:msub><mml:mo>≜</mml:mo><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mfenced open="{" close="}"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:math></disp-formula>where the threshold <inline-formula><mml:math id="M25" altimg="si29.gif" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is fixed. In particular, we chose <inline-formula><mml:math id="M26" altimg="si30.gif" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>≜</mml:mo><mml:msub><mml:mi mathvariant="italic">μ</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi mathvariant="italic">σ</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>μ</italic><sub><italic>z</italic></sub> and <italic>σ</italic><sub><italic>z</italic></sub> are the mean and standard deviation (SD) of <italic>z</italic><sub><italic>k</italic></sub> over the 3-h nonictal training data, respectively.</p>
          <p>For each detection policy, we measured the delay between each estimated seizure onset time and the correspondent UEO, the number of true positives (TP), false positives (FP), and false negatives (FN). Every detection was classified as TP or FP if an UEO occurred within 20 s from the detection time or not. This time was chosen to be comparable to <xref rid="bb0070" ref-type="bibr">[14]</xref>. Each UEO that was not detected was classified as FN. Results are summarized in <xref rid="t0010" ref-type="table">Tables 2</xref> and <xref rid="t0015" ref-type="table">Table 3</xref>.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s0050">
      <label>3</label>
      <title>Results</title>
      <sec id="s0055">
        <label>3.1</label>
        <title>Multichannel analysis</title>
        <p>The maximum singular value <italic>σ</italic><sub>1</sub> estimated at each stage <italic>k</italic> from the connectivity matrix (1) is plotted in <xref rid="f0020" ref-type="fig">Fig. 4</xref> (one ictal period per patient). The sequence of <italic>σ</italic><sub>1</sub> had a consistent pattern across the patients, with large values in nonictal state (pre- and post-seizure). The corresponding singular vector <bold><italic>v</italic></bold><sub>1</sub> shows a leading direction before the seizure onset, which depends on both the specific patient and the location of the foci. For example, components 8–10 in patient 1 (<xref rid="f0020" ref-type="fig">Fig. 4</xref>A) and 1–4 in patient 3 (<xref rid="f0020" ref-type="fig">Fig. 4</xref>C) correspond to the focal area (<xref rid="f0005" ref-type="fig">Figs. 1</xref>A, C) and have significantly higher values than the other components of <bold><italic>v</italic></bold><sub>1</sub> before the seizure.</p>
        <p>During a seizure, however, <italic>σ</italic><sub>1</sub> rapidly increases compared with the nonictal background activity in the previous minutes, reaches a local maximum approximately half of the ictal period (gray boxes, <xref rid="f0020" ref-type="fig">Figs. 4</xref>A–D), and then slowly decreases to smaller, nonictal values. The change in the dynamics of <italic>σ</italic><sub>1</sub> was observed almost at the beginning of the hand-annotated seizure onset while the return to the nonictal condition was usually slower and may last longer than the hand-annotated end time of the seizure. Interestingly, after every seizure, <italic>σ</italic><sub>1</sub> decreased below the average value achieved before the seizure and, then, increased to the preictal values with a long drift (at least 2 hours, data not reported), which may be consistent with the definition of a postictal state given in <xref rid="bb0220 bb0225" ref-type="bibr">[51,52]</xref>. The stereotypical dynamics of <italic>σ</italic><sub>1</sub> were associated with a sudden change in the direction of the singular vector <bold><italic>v</italic></bold><sub>1</sub>: the components with the largest values during the nonictal period decreased during the seizure while the remaining components increased. As a consequence, the distance between the largest and smallest components consistently decreased during a seizure (more than 30%), indicating a rotation of <bold><italic>v</italic></bold><sub>1</sub> toward a new direction which varies with the specific seizure.</p>
        <p>Modulo a scaling factor, the dynamics of σ1 and <bold><italic>v</italic></bold><sub>1</sub> were similar in patients 1, 2, and 4 (<xref rid="f0020" ref-type="fig">Figs. 4</xref>A, B, D), independently of the type/origin of the seizure and the connectivity matrix (<italic>σ</italic><sub>1</sub> and <bold><italic>v</italic></bold><sub>1</sub> were computed from connectivity matrices of cross-power in different frequency bands, see <xref rid="t0005" ref-type="table">Table 1</xref>). These dynamics were less clear in patient 3, where <italic>σ</italic><sub>1</sub> showed slow oscillations independently of the seizure occurrence (<xref rid="f0020" ref-type="fig">Fig. 4</xref>C, top). However, at the seizure onset, the value of <italic>σ</italic><sub>1</sub> first decreased, then rapidly rose to a local maximum, and finally drifted toward the baseline value, as did occur in the other patients. This indicates that, modulo a scaling factor, the same dynamics occurred in patient 3 as well as patients 1, 2, and 4. Interestingly, in <xref rid="f0020" ref-type="fig">Fig. 4</xref>C (top), <italic>σ</italic><sub>1</sub> achieves a peak value ~ 50 s after termination of the seizure. However, this peak is shorter than the pattern during the previous seizure, is not followed by a recovery phase, and is not associated with a rotation of <bold><italic>v</italic></bold><sub>1</sub>. The leading components of <bold><italic>v</italic></bold><sub>1</sub>, indeed, do not change when this second peak occurs and are the same as in the preictal phase (<xref rid="f0020" ref-type="fig">Fig. 4</xref>C, bottom). These facts indicate that, although the absolute value of <italic>σ</italic><sub>1</sub> may be higher after the seizure, the specific pattern is different from the ictal one.</p>
        <p>Overall, the clear modulation of <italic>σ</italic><sub>1</sub> at the seizure onset and its specific pattern during the ictal state may capture the overall change in complexity of the brain. This is possible because <italic>σ</italic><sub>1</sub> exploits information recorded from multiple sites simultaneously and combines linear dependencies between all the possible pairs of electrodes in the beta (patients 1, 3, 4) and theta (patient 2) frequency bands.</p>
      </sec>
      <sec id="s0060">
        <label>3.2</label>
        <title>HMM estimation</title>
        <p><xref rid="f0015" ref-type="fig">Figs. 3</xref>B and <xref rid="f0025" ref-type="fig">5</xref> show results for the HMM estimation. Although the mean value and the variance of <italic>σ</italic><sub>1</sub> were different in the ictal versus nonictal states, the sampling probability distribution functions had some overlap (<xref rid="f0015" ref-type="fig">Fig. 3</xref>B), which means that several of the same values of <italic>σ</italic><sub>1</sub> were likely to be achieved in both ictal and nonictal states.</p>
        <p>In order to better characterize the distribution of <italic>σ</italic><sub>1</sub> in each state, we introduced a history-dependent representation of the probability distribution of <italic>σ</italic><sub>1</sub> (<xref rid="f0025" ref-type="fig">Fig. 5</xref>). At each stage <italic>k</italic>, the model (5)–(6) modulates the probability that the observation <italic>σ</italic><sub>1</sub>(<italic>k</italic>) has been emitted while in the ictal or nonictal state based on the values of <italic>σ</italic><sub>1</sub> in the last 15 s. The dynamics of the instantaneous rate <italic>λ</italic><sub><italic>x,k</italic></sub> are captured by parameters Θ<sub><italic>x</italic></sub> in (5) and (6), as Θ<sub><italic>x</italic></sub> were estimated from actual observations in both states. Parameters in <xref rid="f0025" ref-type="fig">Figs. 5</xref>A–D indicate that the transition from nonictal to ictal state is characterized by (i) a significant increase in parameter <italic>α</italic><sub><italic>x</italic></sub> (<xref rid="f0025" ref-type="fig">Figs. 5</xref>A, B), which is a scaling factor and accounts for the average value of <italic>σ</italic><sub>1</sub> in state <italic>x</italic>, and (ii) larger 95% confidence bounds for parameters <italic>β</italic><sub><italic>x</italic>, <italic>j</italic></sub> (<xref rid="f0025" ref-type="fig">Figs. 5</xref>C, D), which accounts for larger differences between consecutive observations of <italic>σ</italic><sub>1</sub>.</p>
        <p>The different model parameters Θ<sub><italic>x</italic></sub> resulted in distinct functions <italic>q</italic><sub>0</sub>, <italic>q</italic><sub>1</sub>, which (i) varied the probability of any given observation <italic>σ</italic><sub>1</sub> at each stage <italic>k</italic> depending on the past observations, and (ii) had opposite dynamics in the ictal and nonictal states (<xref rid="f0025" ref-type="fig">Fig. 5</xref>E). In particular, for the computed sequence of <italic>σ</italic><sub>1</sub> in each patient, <italic>q</italic><sub>1</sub>(∙) was consistently larger than <italic>q</italic><sub>0</sub>(∙) during the ictal periods, but decreased during the nonictal periods and was almost zero during the postictal phase, while <italic>q</italic><sub>0</sub>(∙) was generally high (and almost always larger than <italic>q</italic><sub>1</sub>(∙)) during the nonictal periods. In each patient, <italic>q</italic><sub>0</sub> and <italic>q</italic><sub>1</sub> were almost zero after every seizure independently of the model parameters, thus suggesting that the postictal period is characterized by a resetting of the brain activity, as argued in <xref rid="bb0220 bb0225" ref-type="bibr">[51,52]</xref>.</p>
      </sec>
      <sec id="s0065">
        <label>3.3</label>
        <title>Quickest detection policy</title>
        <p><xref rid="t0010 t0015" ref-type="table">Tables 2 and 3</xref> and <xref rid="f0030 f0035" ref-type="fig">Figs. 6 and 7</xref> report the results for the QD policy versus the Bayesian estimator (BE) and the heuristic threshold-based detector (HT) described under Methods.</p>
        <p>The QD policy was derived by penalizing the probability of false positives more than the delay (i.e., γ &lt; 0.5 in the cost function (9)). In this way, QD guaranteed 100% sensitivity (i.e., all the seizures were correctly detected) on both training and validation data (<xref rid="t0010" ref-type="table">Table 2</xref>) and delays were generally small (average across patients: 9.6 ± 10.5 s, mean ± SD). Detection occurred earlier than the UEO (anticipation) in 5 of 28 seizures on validation data (<xref rid="t0015" ref-type="table">Table 3</xref>), with a lag ranging from 4 to 7 s. The number of false positives, instead, varied with the patient (<xref rid="t0010" ref-type="table">Table 2</xref>) and determined an average FPR value of 1.39 ± 1.45 FP/h across four patients.</p>
        <p>A comparison between QD, BE, and HT indicates that the non-optimal policies BE and HT can achieve shorter delays, but the number of false positives rapidly increases, which may make these methods unsuitable for clinical application. While the average delay was 5.32 ± 11.78 s and 1.68 ± 7.55 s for BE and HT, respectively, the FPR was 3.0 ± 3.46 and 3.0 ±3.99 FP/h, respectively. Also, the performance of the HT was influenced by the noise in the sequence of <italic>σ</italic><sub>1</sub> values, resulting in 0% sensitivity in one patient (i.e., no seizure was correctly detected) and an average value of 82.5% across the whole population.</p>
        <p>These results depend on the performance goals imposed by the cost (9). By increasing the penalty for detection delay in (9) (i.e., increasing <italic>γ</italic>), the QD was able to reduce the delay to the values achieved via BE (16 s, <xref rid="f0030" ref-type="fig">Fig. 6</xref>B, black dash-dot line), while keeping a lower number of FPs (7 vs. 11). By decreasing <italic>γ</italic>, instead, we achieved higher robustness to early modulations of <italic>π</italic><sub><italic>k</italic></sub>, which can be due to abrupt spikes in the sequence of <italic>σ</italic><sub>1</sub>, and were able to decrease the number of FPs and detect a seizure with less anticipation than the other methods (<xref rid="f0035" ref-type="fig">Figs. 7</xref>A, B).</p>
        <p>A sensitivity analysis of the QD policy to variations in the parameter <italic>γ</italic> is reported in <xref rid="f0040" ref-type="fig">Fig. 8</xref>. The policy was implemented for several values of <italic>γ</italic> in [0, 1], and for each value, the average delay and FPR per patient were estimated on the validation data. Results indicate that delays are quite insensitive to modulations in <italic>γ</italic> in patients 1 and 2, and low FPR values (&lt; 0.17 FP/h) can be achieved while keeping the delay to the minimum value. However, in patient 4, delays were generally small (&lt; 10 seconds) for FPRs below 2 FP/h, and further reductions in delay rapidly increase the FPR. Finally, performances for patient 3 was similar to that for BE and HT in terms of FPRs, presumably because of the less significant modulation of <italic>σ</italic><sub>1</sub> in the ictal versus nonictal state (<xref rid="f0020" ref-type="fig">Fig. 4</xref>).</p>
      </sec>
    </sec>
    <sec id="s0070">
      <label>4</label>
      <title>Discussion</title>
      <p>In this study, we propose a multichannel statistic that measures linear dependencies among all recorded sites of the epileptic brain simultaneously by combining power spectrum analysis and matrix theory. This statistic (the maximum singular value <italic>σ</italic><sub>1</sub> of the cross-power-based connectivity matrix) summarizes the change in topology that occurs in the brain network at the seizure onset and shows significantly different dynamics in ictal versus nonictal periods.</p>
      <p>Using this statistic, we developed a computational framework for the AOSD. This framework combines Bayesian estimation (we use the a posteriori probability <italic>π</italic><sub><italic>k</italic></sub>) with optimal control (we minimize the cost function <inline-formula><alternatives><textual-form specific-use="jats-markup">𝒥<sub>0</sub></textual-form><mml:math id="M27" altimg="si31.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">J</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in (10)) and provides a threshold-based detection policy, where the threshold varies with time based on the dynamics of <italic>σ</italic><sub>1</sub> and <italic>π</italic><sub><italic>k</italic></sub>.</p>
      <sec id="s0075">
        <label>4.1</label>
        <title>Multichannel versus single-channel statistics</title>
        <p>Several statistics, both single channel and multichannel, have been computed from iEEG signals in the last 20 years to capture changes occurring in the brain network at seizure onset <xref rid="bb0030 bb0035 bb0040 bb0045 bb0050 bb0055 bb0060 bb0065 bb0070 bb0075 bb0080 bb0085 bb0090 bb0095 bb0100 bb0105 bb0110 bb0115 bb0120 bb0125 bb0130 bb0135 bb0140 bb0145 bb0150 bb0155 bb0160 bb0165" ref-type="bibr">[6–33]</xref>. Although these statistics show some modulation between different nonictal and ictal states, they have a few drawbacks: (i) The statistics are usually computed on single channels <xref rid="bb0030 bb0035 bb0040 bb0045 bb0055 bb0140 bb0150 bb0155 bb0160 bb0165" ref-type="bibr">[6–9,11,28,30–33]</xref> or a small subset of channels <xref rid="bb0050 bb0145" ref-type="bibr">[10,29]</xref> from the focal area, which means that the foci must be known a priori with reasonable accuracy (i.e., localization and detection are correlated problems). This is less stringent with the multichannel statistics, where the only requirement is that the electrode grid is large enough to include the focal areas. (ii) The nonlinear multichannel statistics usually outperform linear single-channel and two-channel measures <xref rid="bb0265" ref-type="bibr">[60]</xref>, but require larger amounts of data and computation. (iii) The modulation of these statistics around the seizure onset may vary with the subject or during the sleep/wake cycle <xref rid="bb0270" ref-type="bibr">[61]</xref>, resulting in less predictable patterns.</p>
        <p>These limitations can be (at least) in part addressed by increasing the number of combined channels and computing simple measures off of large enough matrices (on the order of hundreds of channels). Such a combination can provide more information about the brain network (albeit still incomplete) and exploits both spatial and temporal features, while the computation of the maximum singular value <italic>σ</italic><sub>1</sub> captures the overall degree of (linear) dependency among different brain sites and the sampled network topology. These dynamics were similar in all the patients in our data set, with clear differences during ictal and nonictal periods (<xref rid="f0020" ref-type="fig">Fig. 4</xref>) and a postictal resetting pattern that may last several minutes to a few hours.</p>
        <p>These results positively affected the dynamics of the Bayesian a posteriori probability of an ictal state (<italic>π</italic><sub><italic>k</italic></sub>). This probability evolves recursively with (7) and is used as a marker of the actual brain condition in the QD policy. Depending on the evolution of the maximum singular value, this probability clearly separates the ictal and nonictal periods, contributing to the success of the QD policy (<xref rid="f0025" ref-type="fig">Fig. 5</xref>). As indicated in <xref rid="f0030 f0035" ref-type="fig">Figs. 6 and 7</xref>, this a posteriori probability selectively increases at the seizure onset and remains high during the ictal period, before finally decreasing to zero. <italic>π</italic><sub><italic>k</italic></sub> rises to 1 (i.e., its maximum value) quickly at the seizure onset and usually has minor modulations outside the ictal period (<xref rid="f0030 f0035" ref-type="fig">Figs. 6 and 7</xref>). For this reason, the detection delay with QD is comparable to that achieved via BE, although the FPR is significantly lower in each patient with QD. The FPR is larger in BE because of the occurrence of abrupt spikes in the sequence of <italic>π</italic><sub><italic>k</italic></sub> that trigger false positives. These abrupt spikes in <italic>π</italic><sub><italic>k</italic></sub> may be caused by fluctuations or noise in the measure of the maximum singular value <italic>σ</italic><sub>1</sub>. In this case, an adaptive threshold allows increasing the performance by selectively avoiding these peaks (see below).</p>
      </sec>
      <sec id="s0080">
        <label>4.2</label>
        <title>Quickest detection policy</title>
        <p>The proposed QD policy combines several well-known topics in abrupt change-point detection theory (e.g., quickest detection <xref rid="bb0175 bb0180" ref-type="bibr">[35,36]</xref>, bayesian estimation with loss function <xref rid="bb0255" ref-type="bibr">[58]</xref>, dynamic programming <xref rid="bb0260" ref-type="bibr">[59]</xref>, HMM <xref rid="bb0235" ref-type="bibr">[54]</xref>), generalizes the framework to the case of history-dependent sequential observations (which may be relevant for neural data and iEEG recordings <xref rid="bb0185" ref-type="bibr">[37]</xref>, etc.), generalizes the framework to the case of history-dependent sequential observations (which may be relevant for neural data and iEEG recordings [37]), and results in an adaptive, unsupervised, threshold-based detection strategy that can potentially be implemented online.</p>
        <p>Differently from current AOSD paradigms, our QD policy constructs the threshold by explicitly minimizing a cost function of the desired detection performance goals. Many current detectors track the modulation of a statistic computed from iEEG recordings over time, and then set a threshold on the statistic to estimate the ictal onset time <xref rid="bb0030 bb0050 bb0055 bb0060 bb0065 bb0070 bb0075" ref-type="bibr">[6,10–15]</xref>. The choice of the threshold is <italic>supervised</italic> and usually dependent on the fluctuations of the statistic, the specific patient, or the electrode position, and may require long training sessions to be more accurate. In our approach, instead, an <italic>unsupervised</italic> adaptive threshold falls out of the methodology and adapts according to the cost function, the model of the multichannel statistic (HMM), and current and past measurements.</p>
        <p>More recent detection schemes that exploit classifiers (e.g., <xref rid="bb0080 bb0085 bb0090 bb0095 bb0100 bb0105 bb0110 bb0115 bb0120 bb0125 bb0130 bb0135 bb0140 bb0145 bb0150 bb0155 bb0160 bb0165" ref-type="bibr">[16–33]</xref>), based on either ANN, SVM, or PCA, also generate unsupervised criteria that separate the feature space (statistic space) into dominant ictal and nonictal regions. Although optimization methods are used for separating ictal and nonictal data, the clustering procedure exploits the distance (in a specific high-dimensional geometric feature space) between the data, but does not encompass penalties for specific performance goals (e.g., minimize FPR).</p>
        <p>In summary, the detection approaches proposed thus far follow a “bottom-up” flow, i.e., they determine criteria that most likely separate ictal and nonictal data, and then apply such criteria on sequential neural measurements and evaluate detection performance. Our QD policy, instead, follows a “top-down” approach, i.e., it requires a cost function that explicitly accounts for different performance goals (e.g., low probability of false positives, low distance between actual and detected seizure onset time, low probability of late detection, etc.) and then defines the detection strategy to minimize the cost function. Depending on the specific application (e.g., online detection of a clinical seizure, offline investigation of the electrographic onset of a known clinical seizure, etc.), the QD can be tuned to achieve a specific goal and reach the required level of sensitivity and specificity (<xref rid="f0040" ref-type="fig">Fig. 8</xref>).</p>
        <p>Our QD policy also exploits a model-based control approach to seizure detection. Here, the QD formulation was derived for a two-state HMM representation of brain activity in ictal versus nonictal state. HMMs have been successfully used in several fields in statistics and engineering (for an overview, see <xref rid="bb0235" ref-type="bibr">[54]</xref>), and recently introduced for modeling neural data in sensitive tasks and neural prosthetics (e.g., <xref rid="bb0275 bb0280" ref-type="bibr">[62,63]</xref>). In the case of seizure detection, the transition from a nonictal to an ictal state can be suitably treated as a hidden state transition, where the hidden state is the actual brain condition, which is unknown and partially sampled with electrodes. According to this interpretation, an epileptic brain can sequentially transition into <italic>m</italic> &gt; 2 states, depending on the actual physiological conditions (e.g., the patient is awake or sleeping), the type of epilepsy, or the type of seizure occurring. The number of HMM states is generally patient specific and may vary with the available data. However, the framework outlined in (1)–(10) is general and can be extended to the case of HMMs with <italic>m</italic> &gt; 2 states (e.g., imagine a separate <italic>m</italic>-state HMM for the nonictal periods and an <italic>n</italic>-state HMM for the ictal periods).</p>
        <p>It is interesting that for AOSD, a minimal HMM with two states appears to be enough and led to low FPRs (&lt; 0.2 FP/h) in two of the four patients in our data set. This may stem from the clear patterned dynamics of the maximum singular values in ictal versus nonictal periods, which is captured by the GLM structure in (5) and (6) (<xref rid="f0025" ref-type="fig">Fig. 5</xref>). GLM and maximum likelihood methods have been widely used before in the analysis and simulation of neuronal spike train analysis for several types of neural disorders <xref rid="bb0240 bb0285 bb0290" ref-type="bibr">[55,64,65]</xref> and provide a flexible framework for both stationary and nonstationary analyses. In our case, the GLM parameters are able to accurately capture changes that occur in the maximum singular value as soon as the seizure starts, and require a minimal set of training data to be estimated (only one seizure and 3 hours of nonictal data) in both conditions.</p>
        <p>We are aware, however, that in the remaining two patients the FPR was quite high (&gt; 2 FP/h). In this case, it is possible that the training data was not enough for modeling additional (slower) rhythms in the maximum singular value during the interictal state. Such additional dynamics presumably depend on the location of the focal region, which is not temporal in Patient 3-4, and the specific type of seizures. Indeed, while Patient 1 and 2 had distinct and large complex partial and tonic-clonic seizures, respectively, Patient 3-4 had short complex partial seizures with minor clinical evidence and simple partial seizures, respectively (<xref rid="t0005" ref-type="table">Table 1</xref>). Another possible reason could be the spectral selectivity of our model, i.e., the fact that we consider only one frequency band per patient. Finally, a possible reason could be the limited number of states in our HMM, which could not be enough for these patients. These reasons led to a lack of model accuracy in patient 3 and 4, which presumably caused an increased fluctuation of the state variable <italic>π</italic><sub><italic>k</italic></sub> with frequent erroneous peaks and ultimately decreased the QD performance. Better results could be achieved by improving the HMM–GLM model framework with further information about the type of epilepsy and patient behavior.</p>
        <p>Another aspect of the QD results in <xref rid="t0010 t0015" ref-type="table">Tables 2 and 3</xref> that needs to be addressed is the excessive detection delay (&gt; 10 s) for a few seizures, which would not be useful for clinical application. Also, we note that the delay with QD was longer than with the HT and BE detector for several seizures, although the FPR was significantly lower.</p>
        <p>The results of QD versus those of BE and HT are a consequence of the specific cost function that we defined, which penalizes the probability of false positives and very late detections more severely than detection delays in the order of 10–20 s. Our choice was motivated by the limited duration of the available recordings (less than 2 days per patient) and definitively resulted in a conservative policy, i.e.,the threshold <italic>F</italic><sub><italic>k</italic></sub>(∙) ≫ 0, and, therefore, a seizure was detected only when the state variable <italic>π</italic><sub><italic>k</italic></sub> ≫ 0 (<xref rid="f0030" ref-type="fig">Figs. 6</xref>B, <xref rid="f0035" ref-type="fig">7</xref>).</p>
        <p>The issue of excessive delay may also be due to the spectral selectivity of the adopted connectivity. This can be a limitation as the seizures are characterized by several features (e.g., fast rhythmic activity, electrodecremental activity, isolated spikes, etc.), which may occur across multiple frequency bands. In this case, observations in a single frequency band would lead the multichannel statistic to late modulation and therefore a delayed detection.</p>
        <p>A possible solution to this issue could be combining multichannel statistics across several frequency bands by combining maximum singular values of connectivity matrices computed in different frequency bands. Another solution to be explored is the use of nonlinear functions of the detection delay <italic>T</italic><sub><italic>QD</italic></sub>− <italic>T</italic> in the cost function (9). In the current formulation, the penalty for delay in (9) grows quadratically with delay. We could allow this penalty to grow exponentially in delay (<italic>e</italic><sup>(<italic>T</italic><sub><italic>QD</italic></sub>− <italic>T</italic>)</sup> ), and as long as the function is a non-decreasing function of the delay, the QD method will hold.</p>
        <p>Future work entails validating our preliminary findings on larger data sets and reducing the detection delays so that they may be actionable for clinical intervention. We will also make direct comparisons with current AOSD approaches on the same set of statistics so that we may understand the degree of performance improvement we achieve with the QD methodology.</p>
      </sec>
    </sec>
    <sec id="s0085">
      <title>Conflict of interest statement</title>
      <p>The authors declare that there are no conflicts of interest.</p>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="bb0005">
        <label>1</label>
        <element-citation publication-type="journal" id="rf0005">
          <person-group person-group-type="author">
            <name>
              <surname>Jiruska</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Powell</surname>
              <given-names>A.D.</given-names>
            </name>
            <name>
              <surname>Deans</surname>
              <given-names>J.K.</given-names>
            </name>
            <name>
              <surname>Jefferys</surname>
              <given-names>J.G.</given-names>
            </name>
          </person-group>
          <article-title>Effects of direct brain stimulation depend on seizure dynamics</article-title>
          <source>Epilepsia</source>
          <volume>51</volume>
          <year>2010</year>
          <fpage>S93</fpage>
          <lpage>S97</lpage>
        </element-citation>
      </ref>
      <ref id="bb0010">
        <label>2</label>
        <element-citation publication-type="journal" id="rf0010">
          <person-group person-group-type="author">
            <name>
              <surname>Jobst</surname>
              <given-names>B.C.</given-names>
            </name>
            <name>
              <surname>Darcey</surname>
              <given-names>T.M.</given-names>
            </name>
            <name>
              <surname>Thadani</surname>
              <given-names>V.M.</given-names>
            </name>
            <name>
              <surname>Roberts</surname>
              <given-names>D.W.</given-names>
            </name>
          </person-group>
          <article-title>Brain stimulation for the treatment of epilepsy</article-title>
          <source>Epilepsia</source>
          <volume>51</volume>
          <year>2010</year>
          <fpage>S88</fpage>
          <lpage>S92</lpage>
        </element-citation>
      </ref>
      <ref id="bb0015">
        <label>3</label>
        <element-citation publication-type="journal" id="rf0015">
          <person-group person-group-type="author">
            <name>
              <surname>Morrell</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Brain stimulation for epilepsy: can scheduled or responsive neurostimulation stop seizures?</article-title>
          <source>Curr Opin Neurol</source>
          <volume>19</volume>
          <year>2006</year>
          <fpage>164</fpage>
          <lpage>168</lpage>
          <pub-id pub-id-type="pmid">16538091</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0020">
        <label>4</label>
        <element-citation publication-type="journal" id="rf0020">
          <person-group person-group-type="author">
            <name>
              <surname>Gotman</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Gloor</surname>
              <given-names>P.</given-names>
            </name>
          </person-group>
          <article-title>Automatic recognition and quantification of interictal epileptic activity in the human scalp EEG</article-title>
          <source>Electroencephalogr Clin Neurophysiol</source>
          <volume>41</volume>
          <year>1976</year>
          <fpage>513</fpage>
          <lpage>529</lpage>
          <pub-id pub-id-type="pmid">61855</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0025">
        <label>5</label>
        <element-citation publication-type="journal" id="rf0025">
          <person-group person-group-type="author">
            <name>
              <surname>Gotman</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Automatic recognition of epileptic seizures in the EEG</article-title>
          <source>Electroencephalogr Clin Neurophysiol</source>
          <volume>54</volume>
          <year>1982</year>
          <fpage>530</fpage>
          <lpage>540</lpage>
          <pub-id pub-id-type="pmid">6181976</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0030">
        <label>6</label>
        <element-citation publication-type="journal" id="rf0030">
          <person-group person-group-type="author">
            <name>
              <surname>Osorio</surname>
              <given-names>I.</given-names>
            </name>
            <name>
              <surname>Frei</surname>
              <given-names>M.G.</given-names>
            </name>
            <name>
              <surname>Wilkinson</surname>
              <given-names>S.B.</given-names>
            </name>
          </person-group>
          <article-title>Real-time automated detection and quantitative analysis of seizures and short-term prediction of clinical onset</article-title>
          <source>Epilepsia</source>
          <volume>39</volume>
          <year>1998</year>
          <fpage>615</fpage>
          <lpage>627</lpage>
          <pub-id pub-id-type="pmid">9637604</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0035">
        <label>7</label>
        <element-citation publication-type="journal" id="rf0035">
          <person-group person-group-type="author">
            <name>
              <surname>Osorio</surname>
              <given-names>I.</given-names>
            </name>
            <name>
              <surname>Frei</surname>
              <given-names>M.G.</given-names>
            </name>
            <name>
              <surname>Giftakis</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Performance reassessment of a real-time seizure-detection algorithm on long ECoG series</article-title>
          <source>Epilepsia</source>
          <volume>43</volume>
          <year>2002</year>
          <fpage>1522</fpage>
          <lpage>1535</lpage>
          <pub-id pub-id-type="pmid">12460255</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0040">
        <label>8</label>
        <element-citation publication-type="journal" id="rf0040">
          <person-group person-group-type="author">
            <name>
              <surname>Haas</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Frei</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Osorio</surname>
              <given-names>I.</given-names>
            </name>
          </person-group>
          <article-title>Strategies for adapting automated seizure detection algorithms</article-title>
          <source>Med Eng Phys</source>
          <volume>29</volume>
          <year>2007</year>
          <fpage>895</fpage>
          <lpage>909</lpage>
          <pub-id pub-id-type="pmid">17097325</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0045">
        <label>9</label>
        <element-citation publication-type="journal" id="rf0045">
          <person-group person-group-type="author">
            <name>
              <surname>Osorio</surname>
              <given-names>I.</given-names>
            </name>
            <name>
              <surname>Frei</surname>
              <given-names>M.G.</given-names>
            </name>
          </person-group>
          <article-title>Real-time detection, quantification, warning, and control of epileptic seizures: the foundations for a scientific epileptology</article-title>
          <source>Epilepsy Behav</source>
          <volume>16</volume>
          <year>2009</year>
          <fpage>391</fpage>
          <lpage>396</lpage>
          <pub-id pub-id-type="pmid">19783218</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0050">
        <label>10</label>
        <element-citation publication-type="journal" id="rf0050">
          <person-group person-group-type="author">
            <name>
              <surname>Jerger</surname>
              <given-names>K.K.</given-names>
            </name>
            <name>
              <surname>Netoff</surname>
              <given-names>T.I.</given-names>
            </name>
            <name>
              <surname>Francis</surname>
              <given-names>J.T.</given-names>
            </name>
          </person-group>
          <article-title>Early seizure detection</article-title>
          <source>J Clin Neurophysiol</source>
          <volume>18</volume>
          <year>2001</year>
          <fpage>259</fpage>
          <lpage>268</lpage>
          <pub-id pub-id-type="pmid">11528297</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0055">
        <label>11</label>
        <element-citation publication-type="journal" id="rf0055">
          <person-group person-group-type="author">
            <name>
              <surname>Esteller</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Echauz</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>D'Alessandro</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Continuous energy variation during the seizure cycle: towards an on-line accumulated energy</article-title>
          <source>Clin Neurophysiol</source>
          <volume>116</volume>
          <year>2005</year>
          <fpage>517</fpage>
          <lpage>526</lpage>
          <pub-id pub-id-type="pmid">15721065</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0060">
        <label>12</label>
        <element-citation publication-type="journal" id="rf0060">
          <person-group person-group-type="author">
            <name>
              <surname>Gardner</surname>
              <given-names>A.B.</given-names>
            </name>
            <name>
              <surname>Worrell</surname>
              <given-names>G.A.</given-names>
            </name>
            <name>
              <surname>Marsh</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Dlugos</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Litt</surname>
              <given-names>B.</given-names>
            </name>
          </person-group>
          <article-title>Human and automated detection of high-frequency oscillations in clinical intracranial EEG recordings</article-title>
          <source>Clin Neurophysiol</source>
          <volume>118</volume>
          <year>2007</year>
          <fpage>1134</fpage>
          <lpage>1143</lpage>
          <pub-id pub-id-type="pmid">17382583</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0065">
        <label>13</label>
        <element-citation publication-type="journal" id="rf0065">
          <person-group person-group-type="author">
            <name>
              <surname>Khan</surname>
              <given-names>Y.U.</given-names>
            </name>
            <name>
              <surname>Gotman</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Wavelet based automatic seizure detection in intracerebral electroencephalogram</article-title>
          <source>Clin Neurophysiol</source>
          <volume>114</volume>
          <year>2003</year>
          <fpage>898</fpage>
          <lpage>908</lpage>
          <pub-id pub-id-type="pmid">12738437</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0070">
        <label>14</label>
        <element-citation publication-type="journal" id="rf0070">
          <person-group person-group-type="author">
            <name>
              <surname>Grewal</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Gotman</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>An automatic warning system for epileptic seizures recorded on intracerebral EEGs</article-title>
          <source>Clin Neurophysiol</source>
          <volume>116</volume>
          <year>2005</year>
          <fpage>2460</fpage>
          <lpage>2472</lpage>
          <pub-id pub-id-type="pmid">16125459</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0075">
        <label>15</label>
        <element-citation publication-type="journal" id="rf0075">
          <person-group person-group-type="author">
            <name>
              <surname>Saab</surname>
              <given-names>M.E.</given-names>
            </name>
            <name>
              <surname>Gotman</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>A system to detect the onset of epileptic seizures in scalp EEG</article-title>
          <source>Clin Neurophysiol</source>
          <volume>116</volume>
          <year>2005</year>
          <fpage>427</fpage>
          <lpage>442</lpage>
          <pub-id pub-id-type="pmid">15661120</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0080">
        <label>16</label>
        <element-citation publication-type="journal" id="rf0080">
          <person-group person-group-type="author">
            <name>
              <surname>Alkan</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Koklukaya</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Subasi</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Automatic seizure detection in EEG using logistic regression and artificial neural network</article-title>
          <source>J Neurosci Methods</source>
          <volume>148</volume>
          <year>2005</year>
          <fpage>167</fpage>
          <lpage>176</lpage>
          <pub-id pub-id-type="pmid">16023730</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0085">
        <label>17</label>
        <element-citation publication-type="journal" id="rf0085">
          <person-group person-group-type="author">
            <name>
              <surname>Van Putten</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Kind</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Visser</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Lagerburg</surname>
              <given-names>V.</given-names>
            </name>
          </person-group>
          <article-title>Detecting temporal lobe seizures from scalp EEG recordings: a comparison of various features</article-title>
          <source>Clin Neurophysiol</source>
          <volume>116</volume>
          <year>2005</year>
          <fpage>2480</fpage>
          <lpage>2489</lpage>
          <pub-id pub-id-type="pmid">16099210</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0090">
        <label>18</label>
        <element-citation publication-type="journal" id="rf0090">
          <person-group person-group-type="author">
            <name>
              <surname>Wilson</surname>
              <given-names>S.B.</given-names>
            </name>
          </person-group>
          <article-title>A neural network method for automatic and incremental learning applied to patient-dependent seizure detection</article-title>
          <source>Clin Neurophysiol</source>
          <volume>116</volume>
          <year>2005</year>
          <fpage>1785</fpage>
          <lpage>1795</lpage>
          <pub-id pub-id-type="pmid">16005680</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0095">
        <label>19</label>
        <element-citation publication-type="journal" id="rf0095">
          <person-group person-group-type="author">
            <name>
              <surname>Wilson</surname>
              <given-names>S.B.</given-names>
            </name>
          </person-group>
          <article-title>Algorithm architectures for patient dependent seizure detection</article-title>
          <source>Clin Neurophysiol</source>
          <volume>117</volume>
          <year>2006</year>
          <fpage>1204</fpage>
          <lpage>1216</lpage>
          <pub-id pub-id-type="pmid">16600676</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0100">
        <label>20</label>
        <element-citation publication-type="journal" id="rf0100">
          <person-group person-group-type="author">
            <name>
              <surname>Srinivasan</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>Eswaran</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Sriraam</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Approximate entropy-based epileptic EEG detection using artificial neural networks</article-title>
          <source>IEEE Trans Inf Technol Biomed</source>
          <volume>11</volume>
          <year>2007</year>
          <fpage>288</fpage>
          <lpage>295</lpage>
          <pub-id pub-id-type="pmid">17521078</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0105">
        <label>21</label>
        <element-citation publication-type="journal" id="rf0105">
          <person-group person-group-type="author">
            <name>
              <surname>Chan</surname>
              <given-names>A.M.</given-names>
            </name>
            <name>
              <surname>Sun</surname>
              <given-names>F.T.</given-names>
            </name>
            <name>
              <surname>Boto</surname>
              <given-names>E.H.</given-names>
            </name>
            <name>
              <surname>Wingeier</surname>
              <given-names>B.M.</given-names>
            </name>
          </person-group>
          <article-title>Automated seizure onset detection for accurate onset time determination in intracranial EEG</article-title>
          <source>Clin Neurophysiol</source>
          <volume>119</volume>
          <year>2008</year>
          <fpage>2687</fpage>
          <lpage>2696</lpage>
          <pub-id pub-id-type="pmid">18993113</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0110">
        <label>22</label>
        <element-citation publication-type="journal" id="rf0110">
          <person-group person-group-type="author">
            <name>
              <surname>Aarabi</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Fazel-Rezai</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Aghakhani</surname>
              <given-names>Y.</given-names>
            </name>
          </person-group>
          <article-title>A fuzzy rule-based system for epileptic seizure detection in intracranial EEG</article-title>
          <source>Clin Neurophysiol</source>
          <volume>120</volume>
          <year>2009</year>
          <fpage>1648</fpage>
          <lpage>1657</lpage>
          <pub-id pub-id-type="pmid">19632891</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0115">
        <label>23</label>
        <element-citation publication-type="journal" id="rf0115">
          <person-group person-group-type="author">
            <name>
              <surname>Tito</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Cabrerizo</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Ayala</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Jayakar</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Adjouadi</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Seizure detection: an assessment of time- and frequency-based features in a unified two-dimensional decisional space using nonlinear decision functions</article-title>
          <source>J Clin Neurophysiol</source>
          <volume>26</volume>
          <year>2009</year>
          <fpage>381</fpage>
          <lpage>391</lpage>
          <pub-id pub-id-type="pmid">19952562</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0120">
        <label>24</label>
        <element-citation publication-type="journal" id="rf0120">
          <person-group person-group-type="author">
            <name>
              <surname>Minasyan</surname>
              <given-names>G.R.</given-names>
            </name>
            <name>
              <surname>Chatten</surname>
              <given-names>J.B.</given-names>
            </name>
            <name>
              <surname>Chatten</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Harner</surname>
              <given-names>R.N.</given-names>
            </name>
          </person-group>
          <article-title>Patient-specific early seizure detection from scalp electroencephalogram</article-title>
          <source>J Clin Neurophysiol</source>
          <volume>27</volume>
          <year>2010</year>
          <fpage>163</fpage>
          <lpage>178</lpage>
          <pub-id pub-id-type="pmid">20461014</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0125">
        <label>25</label>
        <element-citation publication-type="journal" id="rf0125">
          <person-group person-group-type="author">
            <name>
              <surname>Temko</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Thomas</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Marnane</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Lightbody</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Boylan</surname>
              <given-names>G.</given-names>
            </name>
          </person-group>
          <article-title>EEG-based neonatal seizure detection with support vector machines</article-title>
          <source>Clin Neurophysiol</source>
          <volume>122</volume>
          <year>2011</year>
          <fpage>464</fpage>
          <lpage>473</lpage>
          <pub-id pub-id-type="pmid">20713314</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0130">
        <label>26</label>
        <element-citation publication-type="journal" id="rf0130">
          <person-group person-group-type="author">
            <name>
              <surname>Shoeb</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Edwards</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Connolly</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Bourgeois</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Treves</surname>
              <given-names>S.T.</given-names>
            </name>
            <name>
              <surname>Guttag</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Patient-specific seizure onset detection</article-title>
          <source>Epilepsy Behav</source>
          <volume>5</volume>
          <year>2004</year>
          <fpage>483</fpage>
          <lpage>498</lpage>
          <pub-id pub-id-type="pmid">15256184</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0135">
        <label>27</label>
        <element-citation publication-type="journal" id="rf0135">
          <person-group person-group-type="author">
            <name>
              <surname>Ghosh-Dastidar</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Adeli</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Dadmehr</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Mixed-band wavelet-chaos-neural network methodology for epilepsy and epileptic seizure detection</article-title>
          <source>IEEE Trans Biomed Eng</source>
          <volume>54</volume>
          <year>2007</year>
          <fpage>1545</fpage>
          <lpage>1551</lpage>
          <pub-id pub-id-type="pmid">17867346</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0140">
        <label>28</label>
        <element-citation publication-type="journal" id="rf0140">
          <person-group person-group-type="author">
            <name>
              <surname>Ghosh-Dastidar</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Adeli</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Dadmehr</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Principal component analysis-enhanced cosine radial basis function neural network for robust epilepsy and seizure detection</article-title>
          <source>IEEE Trans Biomed Eng</source>
          <volume>55</volume>
          <year>2008</year>
          <fpage>512</fpage>
          <lpage>518</lpage>
          <pub-id pub-id-type="pmid">18269986</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0145">
        <label>29</label>
        <element-citation publication-type="journal" id="rf0145">
          <person-group person-group-type="author">
            <name>
              <surname>Meier</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Dittrich</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Schulze-Bonhage</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Aertsen</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Detecting epileptic seizures in long-term human EEG: a new approach to automatic online and real-time detection and classification of polymorphic seizure patterns</article-title>
          <source>J Clin Neurophysiol</source>
          <volume>25</volume>
          <year>2008</year>
          <fpage>119</fpage>
          <lpage>131</lpage>
          <pub-id pub-id-type="pmid">18469727</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0150">
        <label>30</label>
        <element-citation publication-type="journal" id="rf0150">
          <person-group person-group-type="author">
            <name>
              <surname>Abibullaev</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>M.S.</given-names>
            </name>
            <name>
              <surname>Seo</surname>
              <given-names>H.D.</given-names>
            </name>
          </person-group>
          <article-title>Seizure detection in temporal lobe epileptic EEGs using the best basis wavelet functions</article-title>
          <source>J Med Syst</source>
          <volume>34</volume>
          <year>2010</year>
          <fpage>755</fpage>
          <lpage>765</lpage>
          <pub-id pub-id-type="pmid">20703931</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0155">
        <label>31</label>
        <element-citation publication-type="journal" id="rf0155">
          <person-group person-group-type="author">
            <name>
              <surname>Guo</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Rivero</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Dorado</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Rabuñal</surname>
              <given-names>J.R.</given-names>
            </name>
            <name>
              <surname>Pazos</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Automatic epileptic seizure detection in EEGs based on line length feature and artificial neural networks</article-title>
          <source>J Neurosci Methods</source>
          <volume>191</volume>
          <year>2010</year>
          <fpage>101</fpage>
          <lpage>109</lpage>
          <pub-id pub-id-type="pmid">20595035</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0160">
        <label>32</label>
        <element-citation publication-type="journal" id="rf0160">
          <person-group person-group-type="author">
            <name>
              <surname>Guo</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Rivero</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Pazos</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Epileptic seizure detection using multiwavelet transform based approximate entropy and artificial neural networks</article-title>
          <source>J Neurosci Methods</source>
          <volume>193</volume>
          <year>2010</year>
          <fpage>156</fpage>
          <lpage>163</lpage>
          <pub-id pub-id-type="pmid">20817036</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0165">
        <label>33</label>
        <element-citation publication-type="journal" id="rf0165">
          <person-group person-group-type="author">
            <name>
              <surname>Shoeb</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Pang</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Guttag</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Schachter</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <article-title>Non-invasive computerized system for automatically initiating vagus nerve stimulation following patient-specific detection of seizures or epileptiform discharges</article-title>
          <source>Int J Neural Syst</source>
          <volume>19</volume>
          <year>2009</year>
          <fpage>157</fpage>
          <lpage>172</lpage>
          <pub-id pub-id-type="pmid">19575506</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0170">
        <label>34</label>
        <element-citation publication-type="journal" id="rf0170">
          <person-group person-group-type="author">
            <name>
              <surname>Lee</surname>
              <given-names>H.C.</given-names>
            </name>
            <name>
              <surname>van Drongelen</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>McGee</surname>
              <given-names>A.B.</given-names>
            </name>
            <name>
              <surname>Frim</surname>
              <given-names>D.M.</given-names>
            </name>
            <name>
              <surname>Kohrman</surname>
              <given-names>M.H.</given-names>
            </name>
          </person-group>
          <article-title>Comparison of seizure detection algorithms in continuously monitored pediatric patients</article-title>
          <source>J Clin Neurophysiol</source>
          <volume>24</volume>
          <year>2007</year>
          <fpage>137</fpage>
          <lpage>146</lpage>
          <pub-id pub-id-type="pmid">17414969</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0175">
        <label>35</label>
        <element-citation publication-type="journal" id="rf0175">
          <person-group person-group-type="author">
            <name>
              <surname>Shiryaev</surname>
              <given-names>A.N.</given-names>
            </name>
          </person-group>
          <article-title>On optimum methods in quickest detection problems</article-title>
          <source>Theory Probab Appl</source>
          <volume>8</volume>
          <year>1963</year>
          <fpage>22</fpage>
          <lpage>46</lpage>
        </element-citation>
      </ref>
      <ref id="bb0180">
        <label>36</label>
        <element-citation publication-type="book" id="rf0180">
          <person-group person-group-type="author">
            <name>
              <surname>Poor</surname>
              <given-names>H.V.</given-names>
            </name>
            <name>
              <surname>Hadjiliadis</surname>
              <given-names>O.</given-names>
            </name>
          </person-group>
          <chapter-title>Quickest detection</chapter-title>
          <year>2008</year>
          <publisher-name>Cambridge Univ. Press</publisher-name>
          <publisher-loc>Cambridge, UK</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0185">
        <label>37</label>
        <element-citation publication-type="book" id="rf0185">
          <person-group person-group-type="author">
            <name>
              <surname>Sarma</surname>
              <given-names>S.V.</given-names>
            </name>
            <name>
              <surname>Santaniello</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <chapter-title>Quickest detection of state-transition in point processes: application to neuronal activity</chapter-title>
          <series>Proceedings, 18th IFAC World Conference; Milan, Italy</series>
          <volume>18</volume>
          <year>August 29–September 2 2011</year>
          <fpage>10021</fpage>
          <lpage>10026</lpage>
        </element-citation>
      </ref>
      <ref id="bb0190">
        <label>38</label>
        <element-citation publication-type="journal" id="rf0190">
          <person-group person-group-type="author">
            <name>
              <surname>Risinger</surname>
              <given-names>M.V.</given-names>
            </name>
            <name>
              <surname>Engel</surname>
              <given-names>J.J.</given-names>
            </name>
            <name>
              <surname>Van Ness</surname>
              <given-names>P.C.</given-names>
            </name>
            <name>
              <surname>Henry</surname>
              <given-names>T.R.</given-names>
            </name>
            <name>
              <surname>Crandall</surname>
              <given-names>P.H.</given-names>
            </name>
          </person-group>
          <article-title>Ictal localization of temporal seizures with scalp-sphenoidal recordings</article-title>
          <source>Neurology</source>
          <volume>39</volume>
          <year>1989</year>
          <fpage>1288</fpage>
          <lpage>1293</lpage>
          <pub-id pub-id-type="pmid">2797451</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0195">
        <label>39</label>
        <element-citation publication-type="journal" id="rf0195">
          <person-group person-group-type="author">
            <name>
              <surname>Bernhardt</surname>
              <given-names>B.C.</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>He</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Evans</surname>
              <given-names>A.C.</given-names>
            </name>
            <name>
              <surname>Bernasconi</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Graph-theoretical analysis reveals disrupted small-world organization of cortical thickness correlation networks in temporal lobe epilepsy</article-title>
          <source>Cereb Cortex</source>
          <volume>21</volume>
          <year>2011</year>
          <fpage>2147</fpage>
          <lpage>2157</lpage>
          <pub-id pub-id-type="pmid">21330467</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0300">
        <label>40</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Müller</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Baier</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Galka</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Stephani</surname>
              <given-names>U.</given-names>
            </name>
            <name>
              <surname>Muhle</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>Detection and characterization of changes of the correlation structure in multivariate time series</article-title>
          <source>Phys Rev E</source>
          <volume>71</volume>
          <year>2005</year>
          <fpage>046116</fpage>
        </element-citation>
      </ref>
      <ref id="bb0305">
        <label>41</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rummel</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Baier</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Müller</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>The influence of static correlations on multivariate correlation analysis of the EEG</article-title>
          <source>J Neurosci Methods</source>
          <volume>166</volume>
          <year>2007</year>
          <fpage>138</fpage>
          <lpage>157</lpage>
          <pub-id pub-id-type="pmid">17692927</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0310">
        <label>42</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rummel</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Müller</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Baier</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Amor</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Schindler</surname>
              <given-names>K.</given-names>
            </name>
          </person-group>
          <article-title>Analyzing spatio-temporal patterns of genuine cross-correlations</article-title>
          <source>J Neurosci Methods</source>
          <volume>191</volume>
          <year>2010</year>
          <fpage>94</fpage>
          <lpage>100</lpage>
          <pub-id pub-id-type="pmid">20566351</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0315">
        <label>43</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rummel</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Abela</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Müller</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Uniform approach to linear and nonlinear interrelation patterns in multivariate time series</article-title>
          <source>Phys Rev E</source>
          <volume>83</volume>
          <year>2011</year>
          <fpage>066215</fpage>
        </element-citation>
      </ref>
      <ref id="bb0320">
        <label>44</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Schindler</surname>
              <given-names>K.A.</given-names>
            </name>
            <name>
              <surname>Leung</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Elger</surname>
              <given-names>C.E.</given-names>
            </name>
            <name>
              <surname>Lehnertz</surname>
              <given-names>K.</given-names>
            </name>
          </person-group>
          <article-title>Assessing seizure dynamics by analyzing the correlation structure of multichannel intracranial EEG</article-title>
          <source>Brain</source>
          <volume>130</volume>
          <year>2007</year>
          <fpage>65</fpage>
          <lpage>77</lpage>
          <pub-id pub-id-type="pmid">17082199</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0200">
        <label>45</label>
        <element-citation publication-type="journal" id="rf0200">
          <person-group person-group-type="author">
            <name>
              <surname>Schindler</surname>
              <given-names>K.A.</given-names>
            </name>
            <name>
              <surname>Bialonski</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Horstmann</surname>
              <given-names>M.T.</given-names>
            </name>
            <name>
              <surname>Elger</surname>
              <given-names>C.E.</given-names>
            </name>
            <name>
              <surname>Lehnertz</surname>
              <given-names>K.</given-names>
            </name>
          </person-group>
          <article-title>Evolving functional network properties and synchronizability during human epileptic seizures</article-title>
          <source>Chaos</source>
          <volume>18</volume>
          <year>2008</year>
          <fpage>033119</fpage>
          <pub-id pub-id-type="pmid">19045457</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0325">
        <label>46</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Schindler</surname>
              <given-names>K.A.</given-names>
            </name>
            <name>
              <surname>Amor</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Gast</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>Peri-ictal correlation dynamics of high-frequency (80–200 Hz) intracranial EEG</article-title>
          <source>Epilepsy Res</source>
          <volume>89</volume>
          <year>2010</year>
          <fpage>72</fpage>
          <lpage>81</lpage>
          <pub-id pub-id-type="pmid">20004556</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0330">
        <label>47</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wilke</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Worrell</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>He</surname>
              <given-names>B.</given-names>
            </name>
          </person-group>
          <article-title>Graph analysis of epileptogenic networks in human partial epilepsy</article-title>
          <source>Epilepsia</source>
          <volume>52</volume>
          <year>2011</year>
          <fpage>84</fpage>
          <lpage>93</lpage>
          <pub-id pub-id-type="pmid">21126244</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0205">
        <label>48</label>
        <element-citation publication-type="journal" id="rf0205">
          <person-group person-group-type="author">
            <name>
              <surname>Kramer</surname>
              <given-names>M.A.</given-names>
            </name>
            <name>
              <surname>Kolaczyk</surname>
              <given-names>E.D.</given-names>
            </name>
            <name>
              <surname>Kirsh</surname>
              <given-names>H.E.</given-names>
            </name>
          </person-group>
          <article-title>Emergent network topology at seizure onset in humans</article-title>
          <source>Epilepsy Res</source>
          <volume>79</volume>
          <year>2008</year>
          <fpage>173</fpage>
          <lpage>186</lpage>
          <pub-id pub-id-type="pmid">18359200</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0210">
        <label>49</label>
        <element-citation publication-type="book" id="rf0210">
          <person-group person-group-type="author">
            <name>
              <surname>Newman</surname>
              <given-names>M.E.J.</given-names>
            </name>
          </person-group>
          <chapter-title>Networks: an introduction</chapter-title>
          <year>2010</year>
          <publisher-name>Oxford Univ. Press</publisher-name>
          <publisher-loc>Cambridge, UK</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0215">
        <label>50</label>
        <element-citation publication-type="book" id="rf0215">
          <person-group person-group-type="author">
            <name>
              <surname>Oppenheim</surname>
              <given-names>A.V.</given-names>
            </name>
            <name>
              <surname>Schafer</surname>
              <given-names>R.W.</given-names>
            </name>
          </person-group>
          <chapter-title>Discrete-time signal processing</chapter-title>
          <year>1999</year>
          <publisher-name>Prentice–Hall</publisher-name>
          <publisher-loc>Upper Saddle River, NJ</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0220">
        <label>51</label>
        <element-citation publication-type="journal" id="rf0220">
          <person-group person-group-type="author">
            <name>
              <surname>Iasemidis</surname>
              <given-names>L.D.</given-names>
            </name>
            <name>
              <surname>Shiau</surname>
              <given-names>D.-S.</given-names>
            </name>
            <name>
              <surname>Sackellares</surname>
              <given-names>J.C.</given-names>
            </name>
            <name>
              <surname>Pardalos</surname>
              <given-names>P.M.</given-names>
            </name>
            <name>
              <surname>Prasad</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Dynamical resetting of the human brain at epileptic seizures: application of nonlinear dynamics and global optimization techniques</article-title>
          <source>IEEE Trans Biomed Eng</source>
          <volume>51</volume>
          <year>2004</year>
          <fpage>493</fpage>
          <lpage>506</lpage>
          <pub-id pub-id-type="pmid">15000380</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0225">
        <label>52</label>
        <element-citation publication-type="journal" id="rf0225">
          <person-group person-group-type="author">
            <name>
              <surname>Liu</surname>
              <given-names>C.C.</given-names>
            </name>
            <name>
              <surname>Pardalos</surname>
              <given-names>P.M.</given-names>
            </name>
            <name>
              <surname>Chaovalitwongse</surname>
              <given-names>W.A.</given-names>
            </name>
          </person-group>
          <article-title>Quantitative complexity analysis in multi-channel intracranial EEG recordings form epilepsy brains</article-title>
          <source>J Comb Optim</source>
          <volume>15</volume>
          <year>2008</year>
          <fpage>276</fpage>
          <lpage>286</lpage>
          <pub-id pub-id-type="pmid">19079790</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0230">
        <label>53</label>
        <element-citation publication-type="book" id="rf0230">
          <person-group person-group-type="author">
            <name>
              <surname>Golub</surname>
              <given-names>H.G.</given-names>
            </name>
            <name>
              <surname>Van Loan</surname>
              <given-names>C.F.</given-names>
            </name>
          </person-group>
          <chapter-title>Matrix computations</chapter-title>
          <edition>3rd ed.</edition>
          <year>1996</year>
          <publisher-name>Johns Hopkins Univ. Press</publisher-name>
          <publisher-loc>Baltimore, MD</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0235">
        <label>54</label>
        <element-citation publication-type="book" id="rf0235">
          <person-group person-group-type="author">
            <name>
              <surname>Elliott</surname>
              <given-names>R.J.</given-names>
            </name>
            <name>
              <surname>Aggoun</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Moore</surname>
              <given-names>J.B.</given-names>
            </name>
          </person-group>
          <chapter-title>Hidden Markov models: estimation and control</chapter-title>
          <year>1995</year>
          <publisher-name>Springer</publisher-name>
          <publisher-loc>New York, NY</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0240">
        <label>55</label>
        <element-citation publication-type="book" id="rf0240">
          <person-group person-group-type="author">
            <name>
              <surname>Brown</surname>
              <given-names>E.N.</given-names>
            </name>
            <name>
              <surname>Barbieri</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Eden</surname>
              <given-names>U.T.</given-names>
            </name>
            <name>
              <surname>Frank</surname>
              <given-names>L.M.</given-names>
            </name>
          </person-group>
          <chapter-title>Likelihood methods for neural data analysis</chapter-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Feng</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <source>Computational neuroscience: a comprehensive approach</source>
          <year>2003</year>
          <publisher-name>CRC Press</publisher-name>
          <publisher-loc>London, UK</publisher-loc>
          <fpage>253</fpage>
          <lpage>286</lpage>
        </element-citation>
      </ref>
      <ref id="bb0245">
        <label>56</label>
        <element-citation publication-type="book" id="rf0245">
          <person-group person-group-type="author">
            <name>
              <surname>McCullagh</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Nelder</surname>
              <given-names>J.A.</given-names>
            </name>
          </person-group>
          <chapter-title>Generalized linear models</chapter-title>
          <edition>2nd ed.</edition>
          <year>1990</year>
          <publisher-name>CRC Press</publisher-name>
          <publisher-loc>Boca Raton, FL</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0250">
        <label>57</label>
        <element-citation publication-type="journal" id="rf0250">
          <person-group person-group-type="author">
            <name>
              <surname>Akaike</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>A new look at the statistical model identification</article-title>
          <source>IEEE Trans Autom Control</source>
          <volume>19</volume>
          <year>1974</year>
          <fpage>716</fpage>
          <lpage>723</lpage>
        </element-citation>
      </ref>
      <ref id="bb0255">
        <label>58</label>
        <element-citation publication-type="book" id="rf0255">
          <person-group person-group-type="author">
            <name>
              <surname>Berger</surname>
              <given-names>J.O.</given-names>
            </name>
          </person-group>
          <chapter-title>Statistical decision theory and Bayesian analysis</chapter-title>
          <edition>2nd ed.</edition>
          <year>1985</year>
          <publisher-name>Springer</publisher-name>
          <publisher-loc>New York, NY</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0260">
        <label>59</label>
        <element-citation publication-type="book" id="rf0260">
          <person-group person-group-type="author">
            <name>
              <surname>Bertsekas</surname>
              <given-names>D.P.</given-names>
            </name>
          </person-group>
          <chapter-title>Dynamic programming and optimal control. 3rd ed.</chapter-title>
          <year>2005</year>
          <publisher-name>Athena Scientific</publisher-name>
          <publisher-loc>Belmont, MA</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0265">
        <label>60</label>
        <element-citation publication-type="journal" id="rf0265">
          <person-group person-group-type="author">
            <name>
              <surname>Li</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Zhou</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Drury</surname>
              <given-names>I.</given-names>
            </name>
            <name>
              <surname>Savit</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Linear and nonlinear measures and seizure anticipation in temporal lobe epilepsy</article-title>
          <source>J Comput Neurosci</source>
          <volume>15</volume>
          <year>2003</year>
          <fpage>335</fpage>
          <lpage>345</lpage>
          <pub-id pub-id-type="pmid">14618068</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0270">
        <label>61</label>
        <element-citation publication-type="journal" id="rf0270">
          <person-group person-group-type="author">
            <name>
              <surname>Allen</surname>
              <given-names>C.N.</given-names>
            </name>
          </person-group>
          <article-title>Circadian rhythms, diet, and neuronal excitability</article-title>
          <source>Epilepsia</source>
          <volume>49</volume>
          <issue>Suppl. 8</issue>
          <year>2008</year>
          <fpage>124</fpage>
          <lpage>126</lpage>
          <pub-id pub-id-type="pmid">19049609</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0275">
        <label>62</label>
        <element-citation publication-type="journal" id="rf0275">
          <person-group person-group-type="author">
            <name>
              <surname>Miller</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Katz</surname>
              <given-names>D.B.</given-names>
            </name>
          </person-group>
          <article-title>Stochastic transitions between neural states in taste processing and decision-making</article-title>
          <source>J Neurosci</source>
          <volume>30</volume>
          <year>2010</year>
          <fpage>2559</fpage>
          <lpage>2570</lpage>
          <pub-id pub-id-type="pmid">20164341</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0280">
        <label>63</label>
        <element-citation publication-type="journal" id="rf0280">
          <person-group person-group-type="author">
            <name>
              <surname>Kemere</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Santhanam</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Yu</surname>
              <given-names>B.M.</given-names>
            </name>
          </person-group>
          <article-title>Detecting neural-state transitions using hidden Markov models for motor cortical prostheses</article-title>
          <source>J Neurophysiol</source>
          <volume>100</volume>
          <year>2008</year>
          <fpage>2441</fpage>
          <lpage>2452</lpage>
          <pub-id pub-id-type="pmid">18614757</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0285">
        <label>64</label>
        <element-citation publication-type="journal" id="rf0285">
          <person-group person-group-type="author">
            <name>
              <surname>Coleman</surname>
              <given-names>T.P.</given-names>
            </name>
            <name>
              <surname>Sarma</surname>
              <given-names>S.V.</given-names>
            </name>
          </person-group>
          <article-title>A computationally efficient method for nonparametric modeling neural spiking activity with point processes</article-title>
          <source>Neural Comp</source>
          <volume>22</volume>
          <year>2010</year>
          <fpage>2002</fpage>
          <lpage>2030</lpage>
        </element-citation>
      </ref>
      <ref id="bb0290">
        <label>65</label>
        <element-citation publication-type="journal" id="rf0290">
          <person-group person-group-type="author">
            <name>
              <surname>Sarma</surname>
              <given-names>S.V.</given-names>
            </name>
            <name>
              <surname>Eden</surname>
              <given-names>U.T.</given-names>
            </name>
            <name>
              <surname>Cheng</surname>
              <given-names>M.L.</given-names>
            </name>
            <name>
              <surname>Williams</surname>
              <given-names>Z.M.</given-names>
            </name>
            <name>
              <surname>Hu</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Eskandar</surname>
              <given-names>E.N.</given-names>
            </name>
            <name>
              <surname>Brown</surname>
              <given-names>E.N.</given-names>
            </name>
          </person-group>
          <article-title>Using point process models to compare neuronal activity in subthalamic nucleus of Parkinson's patients and a healthy primate</article-title>
          <source>IEEE Trans Biomed Eng</source>
          <volume>57</volume>
          <year>2010</year>
          <fpage>1297</fpage>
          <lpage>1305</lpage>
          <pub-id pub-id-type="pmid">20172804</pub-id>
        </element-citation>
      </ref>
    </ref-list>
    <sec id="s0090">
      <label>Appendix</label>
      <title>Recursion of <italic>π</italic><sub><italic>k</italic></sub></title>
      <p>Let us find the recursion equation for <italic>π</italic><sub><italic>k</italic></sub> as a function of <italic>π</italic><sub><italic>k</italic>− 1</sub> in a <italic>m</italic> = 2 HMM. We start with stage 0:<disp-formula id="fo0090"><alternatives><textual-form specific-use="jats-markup"><italic>π</italic><sub>0</sub> = Pr(<italic>x</italic><sub>0</sub>, = ,1,|,<italic>z</italic><sub>0</sub>) = Pr(<italic>x</italic><sub>0</sub>, = ,1,,,<italic>z</italic><sub>0</sub>) / Pr(<italic>z</italic><sub>0</sub>) = 𝓅<sub>1</sub><italic>q</italic><sub>1</sub>(<italic>z</italic><sub>0</sub>) / (𝓅<sub>1</sub><italic>q</italic><sub>1</sub>(<italic>z</italic><sub>0</sub>) + (1 − 𝓅<sub>1</sub>)<italic>q</italic><sub>0</sub>(<italic>z</italic><sub>0</sub>)).</textual-form><mml:math id="M28" altimg="si32.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>,</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="script">p</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula><disp-formula id="fo0095"><alternatives><textual-form specific-use="jats-markup"><italic>π</italic><sub>1</sub> = Pr(<italic>T</italic> ≤ 1 |<italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>) = Pr(<italic>T</italic> ≤ 1, <italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>) / Pr(<italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>) = Pr(<italic>T</italic> ≤ 0, <italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>
<italic>o</italic><italic>r</italic>
<italic>T</italic> = 1, <italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>) / Pr(<italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>) </textual-form><mml:math id="M29" altimg="si33.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mtext>Pr(</mml:mtext><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mspace width="0.75em"/><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.75em"/><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mspace width="0.25em"/></mml:mrow></mml:math></alternatives></disp-formula><disp-formula id="fo0100"><mml:math id="M30" altimg="si34.gif" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:mi mathvariant="italic">T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="italic">z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:mi mathvariant="italic">T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="italic">z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi mathvariant="italic">z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/></mml:mrow></mml:math></disp-formula><disp-formula id="fo0105"><mml:math id="M31" altimg="si35.gif" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>Pr</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mtext>Pr</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="fo0110"><alternatives><textual-form specific-use="jats-markup"> = Pr(<italic>z</italic><sub>1</sub>|<italic>T</italic> ≤ 0, <italic>z</italic><sub>0</sub>)Pr(<italic>z</italic><sub>0</sub>|<italic>T</italic> ≤ 0) / Pr(<italic>z</italic><sub>1</sub>|<italic>z</italic><sub>0</sub>) + Pr(<italic>z</italic><sub>1</sub>|<italic>T</italic> = 1, <italic>z</italic><sub>0</sub>)Pr(<italic>z</italic><sub>0</sub>|<italic>T</italic> = 1)Pr(<italic>T</italic> = 1) / Pr(<italic>z</italic><sub>1</sub>|<italic>z</italic><sub>0</sub>)</textual-form><mml:math id="M32" altimg="si36.gif" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mtext>Pr</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mtext>Pr</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula><disp-formula id="fo0115"><mml:math id="M33" altimg="si37.gif" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mtext>,</mml:mtext><mml:mspace width="0.25em"/><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/></mml:mrow><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mtext>Pr</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="fo0120"><mml:math id="M34" altimg="si38.gif" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula></p>
      <p>Define the likelihood ratio<disp-formula id="fo0125"><mml:math id="M35" altimg="si39.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≜</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>|</mml:mtext><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext></mml:mrow></mml:math></disp-formula>then<disp-formula id="fo0130"><mml:math id="M36" altimg="si40.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:msub><mml:mi mathvariant="italic">L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi mathvariant="italic">π</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi mathvariant="italic">p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">[</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi mathvariant="italic">p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo stretchy="true">]</mml:mo><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">p</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
      <p>Similarly, it is straightforward to show that for<disp-formula id="fo0135"><mml:math id="M37" altimg="si41.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≜</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext></mml:mrow></mml:math></disp-formula>where <italic>H</italic><sub><italic>k</italic></sub> = {<italic>z</italic><sub>0</sub>, <italic>z</italic><sub>1</sub>, …, <italic>z</italic><sub><italic>k</italic>− 1</sub>}, then<disp-formula id="fo0140"><mml:math id="M38" altimg="si42.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:msub><mml:mi mathvariant="italic">L</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi mathvariant="italic">π</mml:mi><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="italic">L</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mfenced open="[" close="]"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi mathvariant="italic">p</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>≜</mml:mo><mml:mtext>Φ</mml:mtext><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mi mathvariant="italic">π</mml:mi><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">z</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">H</mml:mi><mml:mi mathvariant="italic">k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <ack>
      <title>Acknowledgments</title>
      <p>Support was provided by Burroughs Wellcome Fund CASI to S.V.S. We would also like to thank Ivan Osorio for providing expertise in this field and helpful comments which led us to improve the article significantly.</p>
    </ack>
  </back>
  <floats-group>
    <fig id="f0005">
      <label>Fig. 1</label>
      <caption>
        <p>Three-dimensional reconstructions of the brain for patients 1 (A), 2 (B), 3 (C), and 4 (D) with the electrode grids superimposed. Red-squared boxes denote the hand-annotated seizure foci. In (A) to (D), yellow circles are electrodes visible in their proper location on the cortex; green circles are electrodes that would be visible where the underlying cortex rendered properly; cyan circles are electrodes occluded by cortex (rendered or not) because they wrap around underneath or behind the temporal lobe. In patient 2, recordings from electrodes 1, 4, 6, 23, and 33–37 were not included in this study. In patient 3, recordings from electrode 34–64 were not included in this study. Electrodes not included in this study showed neglegible modulation during the ictal periods.</p>
      </caption>
      <graphic xlink:href="gr1"/>
    </fig>
    <fig id="f0010">
      <label>Fig. 2</label>
      <caption>
        <p>(A) Three nodes in a network are loosely connected and the correspondent connectivity matrix <italic>A</italic> is close to identity with full rank. (B) Two of three nodes are strongly connected and the connectivity matrix <italic>B</italic> is close to losing rank. (C) Average direction and amplification of the first singular vectors corresponding to matrices <italic>A</italic> and <italic>B</italic>.</p>
      </caption>
      <graphic xlink:href="gr2"/>
    </fig>
    <fig id="f0015">
      <label>Fig. 3</label>
      <caption>
        <p>(A) Schematic of an <italic>m</italic> = 2 state HMM. (B) Sampling probability distribution function of the observations <italic>z</italic><sub><italic>k</italic></sub> in state <italic>x</italic><sub><italic>k</italic></sub> = 0 (nonictal) and <italic>x</italic><sub><italic>k</italic></sub> = 1 (ictal). Data collected from patient 2. (C) Seizure onset detection formulated as a feedback control problem.</p>
      </caption>
      <graphic xlink:href="gr3"/>
    </fig>
    <fig id="f0020">
      <label>Fig. 4</label>
      <caption>
        <p>Sequence of first singular values <italic>σ</italic><sub>1</sub> and correspondent first singular vectors <italic>v</italic><sub>1</sub> around an ictal period (gray background) in patient 1 (seizure s<sub>1</sub>, A), 2 (s<sub>1</sub>, B), 3 (s<sub>3</sub>, C), and 4 (s<sub>3</sub>, D).</p>
      </caption>
      <graphic xlink:href="gr4"/>
    </fig>
    <fig id="f0025">
      <label>Fig. 5</label>
      <caption>
        <p>(A–D) Maximum likelihood estimate of parameters <italic>Θ</italic><sub><italic>x</italic></sub> (black line) in (6) with 95% confidence bounds (gray background) for nonictal (A, C) and ictal (B, D) state. (E) History-dependent estimate of the probability <italic>q</italic><sub>0</sub>(<italic>z</italic><sub><italic>k</italic></sub>|<italic>H</italic><sub><italic>k</italic></sub>) (black line) and <italic>q</italic><sub>1</sub>(<italic>z</italic><sub><italic>k</italic></sub>|<italic>H</italic><sub><italic>k</italic></sub>) (gray dotted line) around a specific hand-annotated seizure (gray background). Plots refer to patient 2. Probabilities in (E) refer to seizure <italic>s</italic><sub>3</sub> (validation data).</p>
      </caption>
      <graphic xlink:href="gr5"/>
    </fig>
    <fig id="f0030">
      <label>Fig. 6</label>
      <caption>
        <p>QD on validation data. The electrographic onset (dashed vertical black line), the correspondent QD estimation (circles), and threshold <italic>F</italic><sub><italic>k</italic></sub> (gray and dash-dot black lines) for patients 1 (A) and 2 (B). For patient 2, two QD estimations are computed for different values of parameter γ (black circle γ = 0.52; gray circle γ = 0.01). Plots refer to seizures <italic>s</italic><sub>1</sub> (patient 1) and <italic>s</italic><sub>3</sub> (patient 2), respectively. In (B) (bottom plot) the horizontal dashed black line denotes the threshold for the BE detector.</p>
      </caption>
      <graphic xlink:href="gr6"/>
    </fig>
    <fig id="f0035">
      <label>Fig. 7</label>
      <caption>
        <p>QD on validation data. The electrographic onset (dashed vertical black line), the correspondent QD estimation (circles), and threshold <italic>F</italic><sub><italic>k</italic></sub> (gray and dash-dot black lines) for patients 3 (A) and 4 (B). For each patient, two QD estimations are computed (gray and dash-dot black) for different values of parameter <italic>γ</italic>. Plots refer to seizures <italic>s</italic><sub>3</sub> (patient 3) and <italic>s</italic><sub>3</sub> (patient 4), respectively. In (A) and (B) (bottom plot) the horizontal dashed black line denotes the threshold for the BE detector.</p>
      </caption>
      <graphic xlink:href="gr7"/>
    </fig>
    <fig id="f0040">
      <label>Fig. 8</label>
      <caption>
        <p>Sensitivity analysis. The average detection delay and false-positive rate for patients 1 and 2 (A), 3 and 4 (B) are computed for γ ranging from 0.01 to 0.999 on the validation data. Gray circles denote the average performance achieved with the value of γ used in <xref rid="t0010" ref-type="table">Tables 2</xref> and <xref rid="t0015" ref-type="table">Table 3</xref>.</p>
      </caption>
      <graphic xlink:href="gr8"/>
    </fig>
    <table-wrap id="t0005" position="float">
      <label>Table 1</label>
      <caption>
        <p>Seizure origin, number of channels, duration of recordings, sampling frequency, and frequency band used for estimation of the connectivity matrix.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left">Patient</th>
            <th align="left">Sex</th>
            <th align="left">Seizure origin</th>
            <th align="left">Types of seizures</th>
            <th align="left"># iEEG channels</th>
            <th align="left">Hours of recordings</th>
            <th align="left">Sampling frequency (Hz)</th>
            <th align="left">Frequency band for σ<sub>1</sub></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">1</td>
            <td align="left">Male</td>
            <td align="left">T</td>
            <td align="left">CP</td>
            <td align="left">34</td>
            <td align="left">40</td>
            <td align="left">500</td>
            <td align="left">13–30</td>
          </tr>
          <tr>
            <td align="left">2</td>
            <td align="left">Female</td>
            <td align="left">T</td>
            <td align="left">TC</td>
            <td align="left">28</td>
            <td align="left">47</td>
            <td align="left">500</td>
            <td align="left">4–7</td>
          </tr>
          <tr>
            <td align="left">3</td>
            <td align="left">Male</td>
            <td align="left">F</td>
            <td align="left">CP</td>
            <td align="left">44</td>
            <td align="left">47</td>
            <td align="left">250</td>
            <td align="left">13–30</td>
          </tr>
          <tr>
            <td align="left">4</td>
            <td align="left">Male</td>
            <td align="left">O</td>
            <td align="left">SP</td>
            <td align="left">26</td>
            <td align="left">34</td>
            <td align="left">500</td>
            <td align="left">13–30</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn>
          <p><italic>Note</italic>. For each patient, the frequency band was chosen by maximizing the distance between ictal and nonictal generalized linear models (GLM) parameters (training data only).</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="t0010" position="float">
      <label>Table 2</label>
      <caption>
        <p>Performance analysis.</p>
      </caption>
      <graphic xlink:href="fx2"/>
      <table-wrap-foot>
        <fn>
          <p><italic>Note</italic>. FP, false positive; TP, true positive; FN, false negative; FPR, false positive rate.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="t0015" position="float">
      <label>Table 3</label>
      <caption>
        <p>Detection delay on validation data.</p>
      </caption>
      <graphic xlink:href="fx3"/>
      <table-wrap-foot>
        <fn>
          <p><italic>Note.</italic> Positive and negative values denote delay and anticipation, respectively.</p>
          <p><sup>a</sup>Mean of the absolute values of delays and anticipations.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </floats-group>
</article>