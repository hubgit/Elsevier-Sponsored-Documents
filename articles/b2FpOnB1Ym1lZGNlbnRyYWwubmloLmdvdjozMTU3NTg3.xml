<article xmlns="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle http://dtd.nlm.nih.gov/2.0/xsd/archivearticle.xsd" article-type="research-article">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">J Mol Biol</journal-id>
      <journal-title-group>
        <journal-title>Journal of Molecular Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">0022-2836</issn>
      <issn pub-type="epub">1089-8638</issn>
      <publisher>
        <publisher-name>Elsevier</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmc">3157587</article-id>
      <article-id pub-id-type="pmid">21718704</article-id>
      <article-id pub-id-type="publisher-id">YJMBI63105</article-id>
      <article-id pub-id-type="doi">10.1016/j.jmb.2011.06.005</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Markovian and Non-Markovian Protein Sequence Evolution: Aggregated Markov Process Models</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Kosiol</surname>
            <given-names>Carolin</given-names>
          </name>
          <email>carolin.kosiol@vetmeduni.ac.at</email>
          <xref rid="af0005" ref-type="aff">1</xref>
          <xref rid="cr0005" ref-type="corresp">⁎</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Goldman</surname>
            <given-names>Nick</given-names>
          </name>
          <xref rid="af0010" ref-type="aff">2</xref>
        </contrib>
      </contrib-group>
      <aff id="af0005"><label>1</label>Institut für Populationsgenetik, Vetmeduni Vienna, Veterinärplatz 1, A-1210 Wien, Austria</aff>
      <aff id="af0010"><label>2</label>European Bioinformatics Institute, EMBL Outstation-Hinxton, Wellcome Trust Genome Campus, Hinxton, Cambridge CB10 1SD, UK</aff>
      <author-notes>
        <corresp id="cr0005"><label>⁎</label>Corresponding author. <email>carolin.kosiol@vetmeduni.ac.at</email></corresp>
      </author-notes>
      <pub-date pub-type="pmc-release">
        <day>26</day>
        <month>8</month>
        <year>2011</year>
      </pub-date>
      <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="ppub"/>. -->
      <pub-date pub-type="ppub">
        <day>26</day>
        <month>8</month>
        <year>2011</year>
      </pub-date>
      <volume>411</volume>
      <issue>4-6</issue>
      <fpage>910</fpage>
      <lpage>923</lpage>
      <history>
        <date date-type="received">
          <day>14</day>
          <month>9</month>
          <year>2010</year>
        </date>
        <date date-type="rev-recd">
          <day>28</day>
          <month>5</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>3</day>
          <month>6</month>
          <year>2011</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2011 Elsevier Ltd.</copyright-statement>
        <copyright-year>2011</copyright-year>
        <copyright-holder>Elsevier Ltd</copyright-holder>
        <license>
          <license-p>This document may be redistributed and reused, subject to <ext-link ext-link-type="uri" xlink:href="http://www.elsevier.com/wps/find/authorsview.authors/supplementalterms1.0">certain conditions</ext-link>.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Over the years, there have been claims that evolution proceeds according to systematically different processes over different timescales and that protein evolution behaves in a non-Markovian manner. On the other hand, Markov models are fundamental to many applications in evolutionary studies. Apparent non-Markovian or time-dependent behavior has been attributed to influence of the genetic code at short timescales and dominance of physicochemical properties of the amino acids at long timescales. However, any long time period is simply the accumulation of many short time periods, and it remains unclear why evolution should appear to act systematically differently across the range of timescales studied. We show that the observed time-dependent behavior can be explained qualitatively by modeling protein sequence evolution as an aggregated Markov process (AMP): a time-homogeneous Markovian substitution model observed only at the level of the amino acids encoded by the protein-coding DNA sequence. The study of AMPs sheds new light on the relationship between amino acid-level and codon-level models of sequence evolution, and our results suggest that protein evolution should be modeled at the codon level rather than using amino acid substitution models.</p>
      </abstract>
      <abstract abstract-type="graphical">
        <title>Highlights</title>
        <p>► Markov models are essential to many applications in evolutionary studies of proteins. ► We introduce AMPs to model protein sequence evolution. ► We use AMPs to study the relationship between codon and amino acid evolutions. ► Our results explain previous claims of non-Markovian behavior of protein sequences. ► We suggest that codon models may be preferred to amino acid models.</p>
      </abstract>
      <kwd-group>
        <title>
          <bold>Keywords</bold>
        </title>
        <kwd>protein evolution</kwd>
        <kwd>amino acid substitution models</kwd>
        <kwd>codon models</kwd>
        <kwd>aggregated Markov models</kwd>
        <kwd>rate heterogeneity</kwd>
      </kwd-group>
      <kwd-group>
        <title>Abbreviations</title>
        <kwd>AMP, aggregated Markov process</kwd>
        <kwd>MRCA, most recent common ancestor</kwd>
        <kwd>HMM, dden Markov model</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="s0005">
      <title>Introduction</title>
      <p>In 1968, Dayhoff <italic>et al.</italic> introduced a first model of protein sequence evolution, resulting in the development of the widely used amino acid replacement matrices known as the PAM matrices.<xref rid="bb0005" ref-type="bibr"><sup>1</sup></xref> Since Dayhoff's PAM matrices, there have been increasingly good descriptions of the average patterns and processes of evolution of large collections of protein sequences, as well as more and more specialized matrices considering functional and structural properties of proteins.<xref rid="bb0010 bb0015 bb0020 bb0025" ref-type="bibr"><sup>2–5</sup></xref> Such models are widely used in comparative sequence analyses.<xref rid="bb0030 bb0035" ref-type="bibr"><sup>6,7</sup></xref></p>
      <p>Mathematically speaking, all these models are time-homogenous Markov models defined by the assumption that each amino acid evolves independently of time and of its past history. The instantaneous rate matrix, which represents the patterns of the substitution process and specifies the model completely, is the same at any time in a time-homogenous model.<xref rid="bb0030" ref-type="bibr"><sup>6</sup></xref> In fact, if the rate matrix can be written as the product of a scalar function of time and a constant matrix, that is, <italic>Q</italic>(<italic>t</italic>) = <italic>r</italic>(<italic>t</italic>)<italic>Q</italic>, then <italic>r</italic>(<italic>t</italic>) can be interpreted as an overall rate of evolution varying over time and <italic>Q</italic> can be interpreted as a constant pattern of amino acid replacements. In this case, the overall evolutionary rate and time are confounded,<xref rid="bb0040 bb0045" ref-type="bibr"><sup>8,9</sup></xref> and over any time period [<italic>t</italic><sub>0</sub>,<italic>t</italic><sub>1</sub>], the process so defined cannot be distinguished from that defined by the time-homogenous <inline-formula><mml:math id="M1" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>―</mml:mo></mml:mover><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M2" altimg="si2.gif" overflow="scroll"><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>―</mml:mo></mml:mover></mml:math></inline-formula> is the mean rate in that period, equal to <inline-formula><mml:math id="M3" altimg="si3.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, if it is only observed at <italic>t</italic><sub>0</sub> and <italic>t</italic><sub>1</sub>.<xref rid="bb0050" ref-type="bibr"><sup>10</sup></xref> In this paper, we refer to Markov processes defined by instantaneous rate matrices that can be written in the form <italic>r</italic>(<italic>t</italic>)<italic>Q</italic> as time-homogeneous. While not precisely accurate, it is a convenient shorthand for a class of Markov processes that cannot be distinguished from time-homogeneous ones using the available data.</p>
      <p>For sequence evolution on a phylogenetic tree, imagine that, after a speciation (or gene duplication) event, a pair of sequences evolves from their common ancestor according to a time-homogeneous Markov model. After some time, we may measure the differences and the divergence level between the two sequences, and because the model is time homogeneous, the sequences will continue to evolve according to the same process, leading to more differences and higher divergence levels. This model implies that the patterns of substitutions taking place are the same at low and high sequence divergences. Even if the overall rate of evolution varies between lineages (i.e., the instantaneous rate matrix varies by a constant multiplicative factor) or over time within lineages, a properly implemented inference procedure is able to infer the constant patterns of evolutionary changes.<xref rid="bb0055" ref-type="bibr"><sup>11</sup></xref> However, while most work in phylogenetic modeling has concentrated on devising improved Markov models, some criticisms have been directed at the models' time-homogeneous and Markov natures themselves.</p>
      <p>Henikoff and Henikoff derived a series of BLOSUM matrices, which are probability matrices but are not based on a Markov model.<xref rid="bb0060" ref-type="bibr"><sup>12</sup></xref> They counted all the amino acid replacements between conserved subblocks of aligned protein sequences from many different protein families in the BLOCKS database. The subblocks were made by single-linkage clustering about a percentage identity threshold, and different matrices were obtained by varying this threshold. The matrices of the BLOSUM series are identified by a number after the matrix (e.g., BLOSUM62), which refers to the percentage identity of the subblocks of multiple aligned amino acids used to construct the matrix. Although these percentages indicate different divergence levels between the aligned proteins that give rise to each matrix, there is no assumption of common patterns of amino acid change over evolutionary time: the BLOSUM matrices are not based on an evolutionary model, and it is not possible to generate the BLOSUM matrix series simply by interpolating or extrapolating.</p>
      <p>BLOSUM matrices often perform better than PAM matrices for the purpose of amino acid sequence alignment or database searching.<xref rid="bb0060" ref-type="bibr"><sup>12</sup></xref> This may be because protein sequences behave in a non-time-homogeneous or non-Markov manner, a hypothesis that could have serious consequences for the fields of maximum likelihood and Bayesian phylogenetics, which are based on time-homogeneous Markov models.</p>
      <p>Mitchison and Durbin tried to find one global and constant instantaneous rate matrix <italic>Q</italic> that could generate, as an exponential family (see below), a series of protein replacement matrices they had estimated empirically (also from BLOCKS).<xref rid="bb0065" ref-type="bibr"><sup>13</sup></xref> This would have been a time-homogeneous Markov process explanation of their observations, but they could not find a <italic>Q</italic> that gave a good fit. Furthermore, Benner <italic>et al.</italic> (hereafter referred to as BCG) inferred protein replacement matrices from sets of sequences separated by different divergence levels and found qualitative differences in the substitution patterns.<xref rid="bb0070" ref-type="bibr"><sup>14</sup></xref> They concluded that the evolutionary process changed as a function of sequence divergence, that the assumption that high divergence can be modeled by extrapolating the patterns of low sequence divergence does not hold and that amino acid sequence evolution is non-Markovian.</p>
      <sec id="s0010">
        <title>Thought experiments that expose the fallacy that evolution is different depending on when it is observed</title>
        <p><xref rid="f0005" ref-type="fig">Figure 1</xref>a illustrates the assumption made by time-homogeneous Markov models. All patterns of change are constant over all evolutionary time, represented by one shade of red along the branches of the phylogenies that feature in any sequence comparison (colored branches are sampled; uncolored branches are not). The “eyes” on the right and the associated horizontal lines indicate what would be observed at two different time points (denoted <italic>t</italic><sub>0</sub> and <italic>t</italic><sub>1</sub>). For this simple model, the process observed back in time to the ancestor is the same from any time point (e.g., black eye at <italic>t</italic><sub>0</sub> cf. gray eye at <italic>t</italic><sub>1</sub>) and regardless of which sequences are compared (comparisons A–F). BCG's finding that amino acid evolutionary patterns appear different depending on the divergence level of proteins compared implies that such a simple time-homogeneous Markov assumption cannot be correct.</p>
        <p>BCG formulated perhaps the most detailed criticism of standard Markov models. Although they observed different patterns of replacement for different divergence levels, their explicit rejection of Markovian evolution<xref rid="bb0070" ref-type="bibr"><sup>14</sup></xref> is unfounded, as they did not explore the possibility of time-dependent Markov processes or the extension of the state space to recover the Markov property.<xref rid="bb0075" ref-type="bibr"><sup>15</sup></xref> Nevertheless, as so much current phylogenetic theory relies on time-homogeneous Markov processes, it is important to see if such models can be reconciled with BCG's and Mitchison and Durbin's observations.</p>
        <p>Invoking different evolutionary models for every different sequence is of little interest: it is only the general applicability of a particular model that makes it widely useful. <xref rid="f0005" ref-type="fig">Figure1</xref>b represents one simple possible explanation of replacement patterns being different for different divergence levels. This model is time-homogeneous Markov but has a different pattern of replacements according to the time of their most recent common ancestor (MRCA). This is illustrated using shades from blue to violet for high divergence levels (<xref rid="f0005" ref-type="fig">Fig. 1</xref>b; e.g., comparisons A and E), bright red for medium divergence levels (B and F) and pale-red shades for low divergence levels (C and D), as observed at the level of the black eye (<italic>t</italic><sub>0</sub>). The time axis is in effect linked with a color scale distinguishing different evolutionary processes for different divergence levels before the present. This interpretation is, however, problematic for two reasons. First, notice that the comparison labeled A observed at <italic>t</italic><sub>0</sub> represents a level of divergence that is different from that of comparison B observed at the same time, as indicated by their different colors, but imagine time elapsing until <italic>t</italic><sub>1</sub>, the level of the gray eye. Comparison B is now equivalent to the earlier observation A, yet the pattern of changes observed in A (relative to the black eye) and B (gray eye) do not match. This thought experiment regarding observation points that differ in time shows that this model cannot give rise to observed patterns of changes characterized by the time since sequences' evolutionary divergence. The same argument can be made by contrasting, for example, comparison B made at <italic>t</italic><sub>0</sub> and comparison D made at <italic>t</italic><sub>1</sub>.</p>
        <p>Second, still referring to <xref rid="f0005" ref-type="fig">Fig. 1</xref>b, we highlight the point that the evolutionary histories relating a pair of sequences do not correspond unambiguously to one divergence at a unique position in evolutionary time. Imagine that, in Fig. <xref rid="f0005" ref-type="fig">1b</xref>, the two trees represent the evolution of the same set of sequences, but with different pairwise comparisons highlighted. Different choices of comparisons (e.g., A and B in the left-hand tree and E in the right-hand tree) include sequences with common history yet different evolutionary pattern because the pairwise divergence is greater. This is inconsistent, further illustrating that sequences' evolutionary histories are not uniquely associated with one specific divergence level. The same point is made by considering comparisons F, C and D. BCG's observations cannot be consistent with evolutionary dynamics that are constant over time (<xref rid="f0005" ref-type="fig">Fig. 1</xref>a and b).</p>
        <p>A more sophisticated interpretation of BCG's conclusions can remove some of the inconsistencies highlighted in <xref rid="f0005" ref-type="fig">Fig. 1</xref>b by having the evolutionary process change over time. If all protein sequences evolved in a concerted fashion, each undergoing identical substitution dynamics at the same point in actual (clock) time and with those dynamics varying over time, then inferred patterns of change could be consistent with BCG's observations. Such a model could be Markov (though clearly not time-homogeneous), but this level of synchronization of evolutionary dynamics is, however, entirely unrealistic. A more plausible argument would be that patterns of change could alter at points in the tree where lineages split (e.g., duplication can create gene copies free from the same functional constraints as their ancestors).<xref rid="bb0080" ref-type="bibr"><sup>16</sup></xref> BCG's conclusion was that such a scenario, with protein evolution transitioning from domination by the genetic code soon after divergences to domination by amino acids' physicochemical properties at greater distances, could account for their observations. This hypothesis is represented in <xref rid="f0005" ref-type="fig">Fig. 1</xref>c as Markov evolution dependent on time since the last lineage split. If evolutionary patterns depend only on the time since the MRCA of the sequences compared (<xref rid="f0005" ref-type="fig">Fig. 1</xref>c, A–F), then evolutionary dynamics would seem different depending on the compared sequences' divergence levels. The time of observation (e.g., <italic>t</italic><sub>0</sub> or <italic>t</italic><sub>1</sub>) does not alter this finding or lead to any inconsistency.</p>
        <p>However, only a small proportion of BCG's pairwise comparisons will have gene duplication (as opposed to speciation) events as their MRCA. Only those few that do are likely to have altered evolutionary patterns,<xref rid="bb0085" ref-type="bibr"><sup>17</sup></xref> and even these will generally have been subject to these altered evolutionary patterns only for a short time near to the duplication event.<xref rid="bb0090" ref-type="bibr"><sup>18</sup></xref> Further, an explanation such as this also assumes duplications to occur only at the MRCA of each observed pairwise comparison. However, there is no guarantee that there have been no subsequent lineage splitting events after the MRCA of an observed pair of sequences. Indeed, this too is an unlikely scenario: often the case will be as illustrated by comparisons B–E in <xref rid="f0005" ref-type="fig">Fig. 1</xref>c, which contain multiple lineage splits that are not observed (for B and E, highlighted by asterisks in the “callout” region of the figure) in addition to the one at the MRCA that is. Consequently, it is not tenable to invoke an explanation of the observation of time-dependent protein evolution based on actual duplication/speciation events, since there is no distinction in BCG's data between sequence pairs that are true sister groups and those separated by intermediate (unanalyzed or simply unobserved) descendants of the same common ancestor.</p>
        <p>In contrast, <xref rid="f0005" ref-type="fig">Fig. 1</xref>d illustrates our understanding of the complexity of evolutionary dynamics assessed over a large collection of related and unrelated proteins. There are various different processes (colors) in different lineages; there are both gradual changes at different rates and abrupt changes, and these may or may not coincide with lineage splits. The position of changes in evolutionary process is largely random with respect to the position in the actual underlying or observed trees and is not coordinated from one lineage to another. In this case, the end result of observations taken at any time and of sequences of any level of divergence will be the mixture of many processes. While each may be Markov and time-homogeneous, the overall effect may be highly time-inhomogeneous on a per-lineage basis. However, estimated over large assemblages of protein examples, the average inferred evolutionary dynamics may remain the same, with no biases induced by what sequences are observed, which pairs are compared or when our experiment takes place.</p>
        <p>This series of thought experiments indicates that, contrary to BCG's suggestion, in the most realistic case, the “average” process should be time homogeneous and should be the same if estimated from enough sequences, irrespective of their divergence levels and irrespective of whether it is estimated in 1994, in 2011 or in one million or one hundred million years time. Long periods of evolution are no more than the accumulation of many short periods of evolution, unaware of when they will be observed.</p>
      </sec>
      <sec id="s0015">
        <title>Alternative explanations of experimental results</title>
        <p>The time-homogeneous approach is logically consistent where BCG's explanation is not, but the simple time-homogeneous models considered above are unable to explain the experimental results of Benner <italic>et al.</italic><xref rid="bb0070" ref-type="bibr"><sup>14</sup></xref> and Mitchison and Durbin<xref rid="bb0065" ref-type="bibr"><sup>13</sup></xref> and the success of the BLOSUM matrices.<xref rid="bb0060" ref-type="bibr"><sup>12</sup></xref> Explanations involving processes that are nonhomogeneous in time, relying (logically inconsistently) on specific (implausible) duplication and speciation events or invoking complex switches of substitution dynamics have also failed to explain BCG's observations. Accepting those observations but not necessarily their authors' conclusions, we investigate other factors that could have caused the differences in inferred evolutionary dynamics depending on observed divergence levels.</p>
        <p>Markov processes are very successful at modeling the average behavior of collections of chance events. Trying to retain a time-homogeneous Markov framework while performing this investigation, in this paper, we use aggregated Markov processes (AMPs)<xref rid="bb0095" ref-type="bibr"><sup>19</sup></xref> to model protein evolution as Markovian at the DNA (codon) level but observed (via the genetic code) only at the amino acid level. All previous studies of non-Markovian behavior were on the amino acid level only and often with inference techniques that are less advanced than those now available.<xref rid="bb0100" ref-type="bibr"><sup>20</sup></xref> Evolution, however, occurs at the DNA level. Furthermore, codon-level models have been tested and improved<xref rid="bb0105 bb0110" ref-type="bibr"><sup>21,22</sup></xref> so that we can hope that we have adequate codon models to base this study on. We show that many time-inhomogeneous findings for protein evolution can be explained by time-homogeneous Markov models of the evolution of codon sequences that are observed at the level of amino acids.</p>
      </sec>
    </sec>
    <sec id="s0020">
      <title>Theory</title>
      <sec id="s0025">
        <title>Time-homogeneous Markov models for sequence evolution</title>
        <p>The time-homogeneous Markov model asserts that one protein sequence is derived from another by a series of independent mutations, each changing one character in the ancestral sequence to another character in its descendant during evolution. We consider only models that assume independence of evolution at different sites. A continuous-time Markov process is defined by its <italic>N</italic> × <italic>N</italic> instantaneous rate matrix <italic>Q</italic> = (<italic>Q</italic><sub><italic>ij</italic></sub>)<sub><italic>i</italic></sub><sub>,<italic>j</italic> = 1,…<italic>N</italic></sub>, where <italic>N</italic> is the number of character states. Two types of character alphabets will be considered for protein evolution here: amino acids (<italic>N</italic> = 20) and codons (<italic>N</italic> = 61, if stop codons are discarded). For <italic>i</italic> ≠ <italic>j</italic>, the matrix entry <italic>Q</italic><sub><italic>ij</italic></sub> represents the instantaneous rate of change from state <italic>i</italic> to state <italic>j</italic>, independently at each site. Our assumption of time-homogeneity means that <italic>Q</italic><sub><italic>ij</italic></sub> are constant in time (or that any time dependence is through a scalar rate factor is described in <xref rid="s0005" ref-type="sec">Introduction</xref>).</p>
        <p>Changes at each site occur as a Poisson process with these given rates while waiting in a particular state. The total rate at which any change from that state occurs is the sum of all the rates of changes from that state, and this determines the waiting time in a given state before moving to another. The <italic>Q</italic><sub><italic>ii</italic></sub> entry of the matrix is set to be minus the sum of all other entries in that row, representing (− 1 times) the rate at which changes leave state <italic>i</italic>:<disp-formula id="fo0005"><mml:math id="M4" altimg="si4.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mtext/><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p>
        <p>Molecular sequence data consist of observed character states at some given time, and the quantity most commonly needed for calculations is the probability of observing a given character after evolutionary time <italic>t</italic> ≥ 0 has elapsed. We denote by <italic>P</italic><sub><italic>ij</italic></sub>(<italic>t</italic>) the probability of a site being in state <italic>j</italic> after time <italic>t</italic>, given that the process started in state <italic>i</italic> at that site at time 0. We can write the probabilities <italic>P</italic><sub><italic>ij</italic></sub>(<italic>t</italic>) as an <italic>N</italic> × <italic>N</italic> matrix that we denote <italic>P</italic>(<italic>t</italic>) and that is determined via the relationship<xref rid="bb0115" ref-type="bibr"><sup>23</sup></xref><disp-formula id="fo0010"><label>(1)</label><alternatives><textual-form specific-use="jats-markup"><italic>P</italic>(<italic>t</italic>) = e<sup><italic>t</italic><italic>Q</italic></sup></textual-form><mml:math id="M5" altimg="si5.gif" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>where the exponential of a matrix is defined by the following power series, with <italic>I</italic> being the appropriate identity matrix:<disp-formula id="fo0015"><label>(2)</label><mml:math id="M6" altimg="si6.gif" overflow="scroll"><mml:mrow><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mi>Q</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mi>Q</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>In practice, this power series is calculated numerically using standard linear algebra techniques.<xref rid="bb0120" ref-type="bibr"><sup>24</sup></xref> The most popular method in molecular phylogeny uses eigen-decomposition.<xref rid="bb0030" ref-type="bibr"><sup>6</sup></xref> A series <italic>P</italic>(<italic>t</italic><sub>1</sub>), <italic>P</italic>(<italic>t</italic><sub>2</sub>), … that can be derived in this way from the same instantaneous rate matrix <italic>Q</italic> is referred to as an exponential family of matrices.</p>
        <p>If a Markov process is left evolving for a long time, the probability of finding it in a given state converges to a value independent of the starting state; this distribution is known as the equilibrium distribution π = (π<sub>1</sub>,…,π<sub><italic>N</italic></sub>). The equilibrium distribution π can be found by solving π<italic>P</italic>(<italic>t</italic>) = π for any <italic>t</italic> &gt; 0 or equivalently<xref rid="bb0115" ref-type="bibr"><sup>23</sup></xref> π<italic>Q</italic> = 0.</p>
        <p>Time (<italic>t</italic>) and rate (<italic>Q</italic><sub><italic>ij</italic></sub>) are confounded, and without extrinsic information, only their product can be inferred.<xref rid="bb0040 bb0045" ref-type="bibr"><sup>8,9</sup></xref> Consequently, we can normalize the instantaneous rate matrix with any factor. Typically in phylogenetic applications, <italic>Q</italic> is normalized so that the mean rate of replacement at equilibrium (∑<sub><italic>i</italic></sub>∑<sub><italic>j</italic></sub><sub> ≠ <italic>i</italic></sub>π<italic><sub>i</sub>Q<sub>ij</sub></italic>) is 1, which means that times (evolutionary distances) are measured in units of expected substitutions per site.</p>
      </sec>
      <sec id="s0030">
        <title>Amino acid models</title>
        <p>For the amino acid substitution models in this paper, we assume that amino acid sites in an alignment evolve independently according to the same reversible Markov process defined by a 20 × 20 instantaneous rate matrix. Dayhoff <italic>et al.</italic> introduced the first amino acid model in the form of a substitution probability matrix. However, an instantaneous rate matrix <italic>Q</italic> can easily be calculated from such a probability matrix.<xref rid="bb0055" ref-type="bibr"><sup>11</sup></xref> In this study, we use the Dayhoff model provided in the phylogenetic software package PAML;<xref rid="bb0125" ref-type="bibr"><sup>25</sup></xref> other common models give qualitatively similar results. Following common practice, we often refer to the “PAM distance”. This effectively corresponds to 100× the expected number of amino acid replacements per amino acid site.<xref rid="bb0055" ref-type="bibr"><sup>11</sup></xref></p>
      </sec>
      <sec id="s0035">
        <title>Codon models</title>
        <p>Markov models of codon substitution were first proposed by Goldman and Yang<xref rid="bb0105" ref-type="bibr"><sup>21</sup></xref> and Muse and Gaut.<xref rid="bb0130" ref-type="bibr"><sup>26</sup></xref> In this paper, we mainly refer to the model M0 from Yang <italic>et al.</italic><xref rid="bb0110" ref-type="bibr"><sup>22</sup></xref> For this model, the elements of <italic>Q</italic> are defined as:<disp-formula id="fo0020"><label>(3)</label><mml:math id="M7" altimg="si7.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mtext>0</mml:mtext></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mi>i</mml:mi><mml:mtext> or </mml:mtext><mml:mi>j</mml:mi><mml:mtext> is a stop codon or</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>the change </mml:mtext><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi><mml:mtext> requires &gt; 1 nucleotide substitution</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi><mml:mtext> is a synonymous transversion</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi mathvariant="normal">κ</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi><mml:mtext> is a synonymous transition</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi mathvariant="normal">ω</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi><mml:mtext> is a nonsynonymous transversion</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi mathvariant="normal">κ</mml:mi><mml:mi mathvariant="normal">ω</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi><mml:mtext> is a nonsynonymous transition</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where the parameter κ is the transition/transversion rate ratio, ω is the nonsynonymous/synonymous rate ratio and π<sub><italic>j</italic></sub> is the equilibrium frequency for each codon <italic>j</italic>. Because of the interpretation of the parameter ω as a bias toward (ω &gt; 1) or away from (ω &lt; 1) nonsynonymous changes, this model and its variants are widely used in the detection of natural selection.<xref rid="bb0110 bb0135 bb0140" ref-type="bibr"><sup>22,27,28</sup></xref> For amino acid models and codon models, variation of rates among sites in proteins has been modeled. Often, a discretized Gamma distribution of rates is considered,<xref rid="bb0145" ref-type="bibr"><sup>29</sup></xref> and we use this and similar approaches below.</p>
        <p>As we often discuss amino acid-level and codon-level processes together, we help distinguish these contexts by using subscripts <italic>i</italic>, <italic>j</italic>,… for codons and <italic>x</italic>, <italic>y</italic>,… for amino acids.</p>
      </sec>
      <sec id="s0040">
        <title>Aggregated Markov processes</title>
        <p>Protein sequence evolution of amino acids, as well as of codons, has been modeled using Markov processes. However, the evidence found against time-homogeneous Markov models has all derived from amino acid-level analyses of protein sequences, whereas protein evolution occurs at the level of coding DNA. Here, we consider a model that is Markov on the underlying codon level, but which we interpret as its corresponding amino acids.</p>
        <p>Suppose, for example, that between times <italic>t</italic><sub><italic>k</italic></sub> and <italic>t</italic><sub><italic>k</italic></sub><sub> + </sub><sub>1</sub>, the following substitution has occurred in a coding region:<fig id="f0025"><graphic xlink:href="fx1"/></fig></p>
        <p>We assume that such substitutions are generated by a continuous-time time-homogeneous Markov process {<italic>X</italic>(<italic>t</italic>), <italic>t</italic> ≥ 0} on the codon level with state space <italic>C</italic> = {AAA,AAC,…,TTG,TTT} and equilibrium distribution π and probability matrices <italic>P</italic>(<italic>t</italic>) = e<sup><italic>Qt</italic></sup> as above. Further, we suppose that the codons are not directly observable but that a deterministic function of the underlying Markov process [i.e., <italic>Y</italic>(<italic>t</italic>) = <italic>f</italic>(<italic>X</italic>(<italic>t</italic>)), where <italic>f</italic> maps the state space <italic>C</italic> to the aggregate set <italic>A</italic> = {A,R,N,…,V}], can be observed. Clearly, we consider observing the amino acids encoded by the codons, with <italic>f</italic> defined by the universal genetic code. The observable process of amino acids {<italic>Y</italic>(<italic>t</italic>), <italic>t</italic> ≥ 0} is then called an AMP.<xref rid="bb0095" ref-type="bibr"><sup>19</sup></xref> The dependence structure for the site highlighted in the example above is represented by the following graph:<fig id="f0030"><graphic xlink:href="fx2"/></fig></p>
        <p>Given only the amino acid-level observations <italic>Y</italic>(<italic>t</italic>), it is impossible to tell whether the substitution of leucine (L) with proline (P) was caused by a substitution from CTT to CCT, from CTC to CCC, from CTA to CCA or from CTG to CCG. [We assume only single-nucleotide changes; a more general model might permit double- and triple-nucleotide changes instantaneously (e.g., CTT → CCA), which results in a larger set of codon substitutions compatible with each amino acid replacement.<xref rid="bb0150" ref-type="bibr"><sup>30</sup></xref>] Consequently, the probability of a change to proline (P) does depend not only on the present amino acid leucine (L) but also on the hidden state <italic>X</italic>(<italic>t</italic><sub><italic>k</italic></sub>). The stochastic process <italic>Y</italic>(<italic>t</italic>) describing the amino acid evolution is therefore non-Markovian.</p>
        <p>More formally, AMPs are a subclass of hidden Markov models (HMMs); HMMs also allow the observed <italic>Y</italic>(<italic>t</italic>) to be probabilistically determined given <italic>X</italic>(<italic>t</italic>). The theory of HMMs says that the stochastic process <italic>X</italic>(<italic>t</italic>) on the state space is Markov but that the observable process <italic>Y</italic>(<italic>t</italic>) is non-Markov.<xref rid="bb0155" ref-type="bibr"><sup>31</sup></xref> It is therefore clear that a Markov process of codon evolution will lead to non-Markovian observations of amino acid sequence evolution. Below, we ask whether this can explain the time-dependent observations that other authors have recorded.</p>
        <p>Yang <italic>et al.</italic> have described another way of deriving an amino acid substitution model from a codon model.<xref rid="bb0160" ref-type="bibr"><sup>32</sup></xref> However, they constrain the amino acid model to be Markovian, fixing the rates of amino acid changes equal to the total rates of all corresponding codon changes. Being Markovian by construction, such models cannot explain observations of non-Markovian amino acid substitution.</p>
      </sec>
      <sec id="s0045">
        <title>Log-odds matrices and BCG's experiments</title>
        <p>Rather than compare inferred instantaneous rate matrices <italic>Q</italic>, BCG illustrated their findings by discussing elements of the log-odds matrices (<italic>L</italic>) often used as scoring matrices in database search and alignment programs. Positive scores in a log-odds matrix designate a pair of residues that replace each other more often than expected by chance; negative scores designate pairs that replace each other less than would be expected by chance. Log-odds matrices are related to probability matrices <italic>P</italic>(<italic>t</italic>) (see below), and similar to them, they depend on an evolutionary distance or time <italic>t</italic>. To make meaningful comparisons of log-odds matrices derived from sequences with different divergence levels, one needs to carry out some normalization, and BCG achieved this by computing matrices standardized to <italic>t</italic> = 2.5 (250 PAM). Below, we adopt BCG's procedures to estimate probability matrices, calculate log-odds matrices and normalize them.</p>
        <p>BCG split 1.7 million pairwise aligned amino acid sequences from the MIPS database<xref rid="bb0165" ref-type="bibr"><sup>33</sup></xref> into 10 sets based on bands of divergence levels (4.7–6.4, 6.4–8.7, 8.7–11.8, 11.8–16, 16–22, 22–29, 29–40, 40–54, 54–74 and 74–100 PAMs). Denoting the average PAM distance in each set by <italic>t</italic><sub><italic>k</italic></sub> for <italic>k</italic> = 1,…,10, for each <italic>k</italic>, they compiled a matrix of counts <italic>T</italic>(<italic>t</italic><sub><italic>k</italic></sub>), where <italic>T</italic><sub><italic>xy</italic></sub>(<italic>t</italic><sub><italic>k</italic></sub>) is the number of substitutions from amino acid <italic>x</italic> to amino acid <italic>y</italic> observed in a given set of sequences, and a diagonal matrix <italic>N</italic>(<italic>t</italic><sub><italic>k</italic></sub>), with <italic>N</italic><sub><italic>xx</italic></sub>(<italic>t</italic><sub><italic>k</italic></sub>) the total observed number of amino acids of type <italic>x</italic>. Since, from a pairwise alignment, it is not possible to decide whether a substitution is from <italic>x</italic> to <italic>y</italic> or from <italic>y</italic> to <italic>x</italic>, half of each substitution is counted in one direction and half is counted in the other. For each of the PAM bands, BCG then estimated amino acid substitution matrices using the formula<disp-formula id="fo0025"><alternatives><textual-form specific-use="jats-markup"><italic>P</italic>(<italic>t</italic><sub><italic>k</italic></sub>) = <italic>T</italic>(<italic>t</italic><sub><italic>k</italic></sub>)×[<italic>N</italic>(<italic>t</italic><sub><italic>k</italic></sub>)]<sup>−1</sup></textual-form><mml:math id="M8" altimg="si8.gif" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>These matrices are each extrapolated to a divergence of 1 PAM (0.01 expected substitutions per site):<disp-formula id="fo0030"><label>(4)</label><alternatives><textual-form specific-use="jats-markup"><italic>P</italic>(1 PAM) = <italic>P</italic>(<italic>t</italic> = 0.01) = [<italic>P</italic>(<italic>t</italic><sub><italic>k</italic></sub>)]<sup>1 / <italic>t</italic><sub><italic>k</italic></sub></sup> = [<italic>T</italic>(<italic>t</italic><sub><italic>k</italic></sub>)×[<italic>N</italic>(<italic>t</italic><sub><italic>k</italic></sub>)]<sup>−1</sup>]<sup>1 / <italic>t</italic><sub><italic>k</italic></sub></sup></textual-form><mml:math id="M9" altimg="si9.gif" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mtext> PAM</mml:mtext><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula>and converted to a 250-PAM (<italic>t</italic> = 2.5) log-odds matrix:<disp-formula id="fo0035"><label>(5)</label><mml:math id="M10" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mn>250</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mn>2.50</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mn>0.01</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>250</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="1em" height="0.3ex"/><mml:mtext>for all </mml:mtext><mml:mi>x</mml:mi><mml:mo>≠</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></disp-formula>where <italic>f</italic><sub><italic>y</italic></sub> = <italic>N</italic><sub><italic>yy</italic></sub>(<italic>t</italic><sub><italic>k</italic></sub>)/∑<italic><sub>z</sub>N<sub>zz</sub></italic> (<italic>t</italic><sub><italic>k</italic></sub>) is the frequency of amino acid <italic>y</italic> in each data set.</p>
        <p>BCG illustrated their results by plotting values of <italic>L</italic><sub><italic>xy</italic></sub>(250) for various amino acids <italic>x</italic> and <italic>y</italic>. Their results are reproduced in <xref rid="f0010" ref-type="fig">Fig. 2</xref>a and b. These clearly indicate that certain elements of the log-odds matrices vary as a function of the PAM distance of the sequences from which they were estimated, behavior that is inconsistent with time-homogeneous Markovian evolution. Looking for a biological explanation for these findings, BCG proposed an interpretation that the genetic code influences protein evolution strongly at early stages of divergence, while physicochemical properties are dominant at later stages. For example, they inferred from the values of <italic>L</italic><sub>CW</sub>(250) (<xref rid="f0010" ref-type="fig">Fig. 2</xref>b) that substitutions from cysteine (C) to tryptophan (W) are frequent at small PAM distances because only a single base change is necessary (TGC or TGT to TGG), whereas at larger PAM distances, these substitutions are infrequent because the side chain of tryptophan (W) is large and hydrophobic while the side chain of cysteine (C) is small and can form disulfide bonds inaccessible to tryptophan (W). Similar arguments were made for other amino acid substitutions illustrated in <xref rid="f0010" ref-type="fig">Fig. 2</xref>a and b. However, as explained in our thought experiments above, it does not make sense to base such explanations on divergence levels or speciation events.</p>
      </sec>
      <sec id="s0050">
        <title>Exponential families and Mitchison and Durbin's experiments</title>
        <p>Mitchison and Durbin estimated amino acid substitution probability matrices from experimental data using maximum likelihood methods,<xref rid="bb0065" ref-type="bibr"><sup>13</sup></xref> inferring 10 matrices from multiple alignments taken from the same BLOCKS database used to derive the BLOSUM matrices.<xref rid="bb0060" ref-type="bibr"><sup>12</sup></xref> They then tried to identify an exponential family that would generate the series of matrices (i.e., explain their observations as a time-homogeneous Markov process) but were unable to do so. However, they provided interesting analysis and diagnostics giving insight into the reasons why their approach failed. In their diagnostics, they considered the proportion of amino acid changes that may be explained by a single-nucleotide change and the way this proportion changes over time. To compute this, they summed substitution probability matrix entries over all amino acid substitutions that can be achieved via a single-nucleotide change and took the ratio of this to the probability of any change:<disp-formula id="fo0040"><label>(6)</label><mml:math id="M11" altimg="si11.gif" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi>x</mml:mi><mml:mo>→</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mspace width="0.166em" height="0.3ex"/><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mspace width="0.166em" height="0.3ex"/><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>≠</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166em" height="0.3ex"/><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where Δ<sub>1</sub> is the set of amino acid changes requiring only a single-nucleotide change. This value is plotted in <xref rid="f0015" ref-type="fig">Fig. 3</xref>a (“Experimental”) and shows an initial rapid decline followed by a slower decline for more distant protein comparisons. This is suggestive of a change in evolutionary dynamics that is not consistent with the near-linear decrease observed for time-homogeneous Markovian amino acid sequence evolution (<xref rid="f0015" ref-type="fig">Fig. 3</xref>a, “SimpleMarkovProcess”; see also below). As with BCG, naïve interpretation of these results again suggests that different processes are observed at different timescales. Since our thought experiments indicate that sequence evolution cannot be different depending simply on when we make our observations, this finding is another that we hope to explain via AMPs.</p>
      </sec>
      <sec id="s0055">
        <title>Simulation methods</title>
        <p>Simulation of evolving sequences as a way of testing hypotheses and evaluating the idealized behavior of evolutionary models is well established.<xref rid="bb0170" ref-type="bibr"><sup>34</sup></xref> We use simulated codon data to investigate if aggregation (AMPs) can lead to observations similar to those of BCG and Mitchison and Durbin. Working at the codon level, we calculated <inline-formula><mml:math id="M12" altimg="si12.gif" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mtext>e</mml:mtext><mml:mrow><mml:mi>Q</mml:mi><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (see above) using values of <italic>t</italic><sub><italic>k</italic></sub><sup>⁎</sup> covering a range similar to that used by BCG. The frequency of observing codon <italic>i</italic> in one sequence and <italic>j</italic> in another is then given by π<italic><sub>i</sub>P<sub>ij</sub></italic>(<italic>t</italic><sub><italic>k</italic></sub><sup>⁎</sup>). Letting <italic>C</italic><sub><italic>x</italic></sub> and <italic>C</italic><sub><italic>y</italic></sub> represent the sets of codons that code for amino acids <italic>x</italic> and <italic>y</italic>, respectively, we simulate aggregated (amino acid level) data by noting that the frequency of observing amino acid <italic>x</italic> in one sequence and amino acid <italic>y</italic> in the other sequence is then<disp-formula id="fo0045"><label>(7)</label><mml:math id="M13" altimg="si13.gif" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="0.166em" height="0.3ex"/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="0.166em" height="0.3ex"/><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>To create AMP substitution matrices from this simulation data, we apply the methods of BCG to these idealized data and set<disp-formula id="fo0050"><mml:math id="M14" altimg="si14.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="0.166em" height="0.3ex"/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="0.166em" height="0.3ex"/><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mspace width="1em" height="0.3ex"/><mml:mtext>and</mml:mtext><mml:mspace width="1em" height="0.3ex"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>y</mml:mi></mml:munder><mml:mspace width="0.166em" height="0.3ex"/><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>k</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>The matrices <italic>T</italic>(<italic>t</italic><sub><italic>k</italic></sub><sup>⁎</sup>) and <italic>N</italic>(<italic>t</italic><sub><italic>k</italic></sub><sup>⁎</sup>) are subjected to the same analyses performed by BCG and Mitchison and Durbin in order to see if AMPs can give an explanation of those authors' observations.</p>
        <p>Furthermore, we do not use the prespecified codon times <italic>t</italic><sub><italic>k</italic></sub><sup>⁎</sup> to normalize the matrices to time <italic>t</italic> = 0.01 [Eq. (<xref rid="fo0030" ref-type="disp-formula">4</xref>)] but, instead, base this normalization on inferred amino acid times. BCG had to rely on PAM distances <italic>t</italic><sub><italic>k</italic></sub> estimated from observed amino acid sequences, and it is important that we mimic this because the amino acid time estimates <italic>t</italic><sub><italic>k</italic></sub> may be systematically and nonlinearly biased relative to the codon times <italic>t</italic><sub><italic>k</italic></sub><sup>⁎</sup> (see also below). PAML<xref rid="bb0125" ref-type="bibr"><sup>25</sup></xref> can perform this estimation based on frequencies such as those computed from Eq. (<xref rid="fo0045" ref-type="disp-formula">7</xref>). We used this method to estimate <italic>t</italic><sub><italic>k</italic></sub>, the divergence levels of the AMP amino acid data, for use in normalizing probability matrices according to Eq. (<xref rid="fo0030" ref-type="disp-formula">4</xref>).</p>
      </sec>
    </sec>
    <sec id="s0060">
      <title>Results</title>
      <sec id="s0065">
        <title>Understanding the behavior of AMPs: the Chapman–Kolmogorov equation</title>
        <p>The Chapman–Kolmogorov equation gives the method of combining probabilities from substitution patterns observed at intermediate time steps into longer-term probabilities when the underlying process is Markovian.<xref rid="bb0175" ref-type="bibr"><sup>35</sup></xref> Adherence to the Chapman–Kolmogorov equation is a necessary and sufficient condition for a process to be Markov and guarantees the ability to interpolate and extrapolate probabilities from observations at different time points.</p>
        <p>For example, suppose we are interested in <italic>P</italic>(<italic>Y</italic>(<italic>t</italic><sub>1</sub>) = M|<italic>Y</italic>(<italic>t</italic><sub>0</sub>) = C), the probability of a change from amino acid cysteine (C) at time <italic>t</italic><sub>0</sub> to methionine (M) at time <italic>t</italic><sub>1</sub>. (We concentrate on cysteine–methionine changes here for simplicity, but the same results hold generally for any amino acid pair.) However, imagine an experiment designed in such a way that we have three observation times (<italic>t</italic><sub>0</sub>, <italic>t</italic><sub>1</sub> and an intermediate time τ) and that the data allow us to determine the amino acid substitution probabilities for the period from <italic>t</italic><sub>0</sub> to <italic>t</italic><sub>1</sub> and also for the periods from <italic>t</italic><sub>0</sub> to τ and from τ to <italic>t</italic><sub>1</sub>.</p>
        <p>If the AMP were Markovian, we could relate the probabilities of the observations in the different time periods by applying the Chapman–Kolmogorov equation:<xref rid="bb0115" ref-type="bibr"><sup>23</sup></xref><disp-formula id="fo0055"><label>(8)</label><mml:math id="M15" altimg="si15.gif" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>M</mml:mtext><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>C</mml:mtext><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>x</mml:mi></mml:munder><mml:mspace width="0.166em" height="0.3ex"/><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>M</mml:mtext><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">τ</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">τ</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>C</mml:mtext><mml:mo stretchy="true">)</mml:mo><mml:mtext> for any </mml:mtext><mml:mi mathvariant="normal">τ</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="true">[</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math></disp-formula>where the summation is over all 20 amino acids that might be observed at intermediate time τ. Conversely, if the Chapman–Kolmogorov equation does not hold, we know that the examined process is behaving in a non-Markovian manner.<xref rid="bb0175" ref-type="bibr"><sup>35</sup></xref></p>
        <p>In the context of our earlier thought experiments, this corresponds to estimating probability matrices at intermediate times and using these to calculate the substitution probabilities at a later time. However, we now show that assuming Markovian behavior for observations (e.g., amino acid changes) generated by an AMP can lead to substantial error in the estimation of substitution probabilities. Interestingly, the time of observation does matter for the AMP, whereas it is irrelevant for a simple Markovian process. This begins to establish that AMPs may be able to explain some earlier authors' observations of non-Markovian protein evolution.</p>
        <p>For the AMP representing the case that we only observe amino acids, we calculate the right-hand side of the Chapman–Kolmogorov equation by using probabilities derived from Eq. (<xref rid="fo0045" ref-type="disp-formula">7</xref>) above.</p>
        <p>On the underlying codon level, the process is Markov by construction (see above). However, to confirm adherence to the Chapman–Kolmogorov equation and to compare codon results with amino acid results, for our codon model, we apply the following calculations. For <italic>Y</italic>(<italic>t</italic><sub>0</sub>), we use the equilibrium distribution for the codons of cysteine (C) defined by<disp-formula id="fo0060"><mml:math id="M16" altimg="si16.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mo>υ</mml:mo><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi mathvariant="normal">π</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>C</italic><sub>C</sub> is the set of codons coding for amino acid C. We consider a codon initially in a state described by this distribution and evolving (according to the Markov codon model) over time. For example, at time τ, the state distribution is υ<sub>0</sub><italic>P</italic>(τ − <italic>t</italic><sub>0</sub>) and the probability to be in amino acid state <italic>x</italic> at time τ is given by:<disp-formula id="fo0065"><label>(9)</label><mml:math id="M17" altimg="si17.gif" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">τ</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>C</mml:mtext><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mo>υ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">τ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mo>υ</mml:mo><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">τ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mo>υ</mml:mo><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">τ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mo>υ</mml:mo><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">τ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mtext>C</mml:mtext></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mo>υ</mml:mo><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mi mathvariant="normal">τ</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p>Using appropriate versions of Eq. (<xref rid="fo0065" ref-type="disp-formula">9</xref>), we have calculated the right-hand side of the Chapman–Kolmogorov Eq. (<xref rid="fo0055" ref-type="disp-formula">8</xref>) for <italic>t</italic><sub>0</sub> = 0, for <italic>t</italic><sub>1</sub> = 5 and for different intermediate times τ ∈ [0.0,5.0] for the purely Markov codon model and compare it to the simulated AMP results (only amino acids observed). We use a simple M0 model [Eq. (<xref rid="fo0020" ref-type="disp-formula">3</xref>)] with ω = 0.2 and κ = 2.5 and codon frequencies as specified in <xref rid="ec1" ref-type="supplementary-material">Supplementary Material</xref>. The results for the change from cysteine to methionine (C → M), as described above, and also for the change from cysteine to arginine (C → R) are shown in <xref rid="f0020" ref-type="fig">Fig. 4</xref>. Unlike the results from the Markovian codon process, the values derived from the AMP are not constant. In other words, the probabilities of amino acid substitution depend on the intermediate time τ when the amino acid sequences are observed. Considering similar plots for other amino acid substitutions (not shown), we note that this effect is particularly strong if the amino acids are distant in the genetic code (e.g., they are two- or three-nucleotide changes apart).</p>
        <p>This confirms, therefore, that although the AMP is a time-homogeneous Markov process on the codon level, it is non-Markovian (and time dependent) when observations are aggregated to the level of amino acids. Perhaps the AMP can provide a logically consistent model that can explain BCG's claim that the time at which the evolutionary process is observed is relevant for the estimation of the substitution process.</p>
      </sec>
      <sec id="s0070">
        <title>Comparison to BCG's results</title>
        <p>The extrapolated matrices <italic>L</italic>(250) obtained from BCG's 10 data sets of different divergence levels should be the same if the underlying process of amino acid sequence evolution were time homogeneous. To check this, we used Dayhoff's amino acid model to simulate perfectly time-homogeneous Markov data in the form of pairwise alignments at different divergent levels <italic>t</italic><sub><italic>k</italic></sub> and applied BCG's inference procedure, as described above, to calculate the <italic>L</italic>(250) log-odds matrices. For these data, we confirmed that the elements of the log-odds matrix are not dependent on the divergence levels <italic>t</italic><sub><italic>k</italic></sub> (see <xref rid="ec1" ref-type="supplementary-material">Supplementary Material Fig. S1a and b)</xref> and, thus, that BCG's observations (<xref rid="f0010" ref-type="fig">Fig. 2</xref>a and b) are not consistent with time-homogeneous Markovian amino acid substitution.</p>
        <p>Proteins often show variation in the rates of substitution at different protein sites. This can affect estimates of divergence levels<xref rid="bb0180" ref-type="bibr"><sup>36</sup></xref> and, thus, raises the question of whether rate heterogeneity at the amino acid level could have caused the time dependency effects BCG observed. Therefore, we also simulated data from a mixture process acting on amino acids, a methodology not available at the time of BCG's analysis, using a discretized Gamma distribution of rates of evolution over amino acid sites that is determined by the parameter α.<xref rid="bb0145" ref-type="bibr"><sup>29</sup></xref> To simulate a broad range of typical protein data, we used 182 values of α, representing an empirical distribution of values for typical globular proteins.<xref rid="bb0185" ref-type="bibr"><sup>37</sup></xref> However, although very slight changes in <italic>L</italic>(250) values could be observed, the effect was not as pronounced as that observed by Benner <italic>et al.</italic> (see <xref rid="ec1" ref-type="supplementary-material">Supplementary Material Fig. S1c and d)</xref>. We conclude that although combined data from a mixture of time-homogeneous Markovian amino acid models with different values of α can generate observations with slight time dependence, a realistic distribution of α values cannot explain BCG's observations. In summary, we were unable to recreate observations of Benner <italic>et al.</italic> using time-homogeneous amino acid Markov models.</p>
        <p>We next investigated whether simulations under AMP models could lead to observations similar to those of BCG. Initially, we used a simple M0 model (above), choosing realistic values of ω = 0.2 (moderate purifying selection), κ = 2.5 and codon frequencies as specified in <xref rid="ec1" ref-type="supplementary-material">Supplementary Material</xref>. The log-odds matrices showed some dependency on the PAM distance, but the magnitude of the effect on the log-odds elements did not reflect the strong variation of the log-odds of BCG's experimental data. Further trials with different parameter values led to qualitatively similar results (not shown).</p>
        <p>However, introducing a more realistic model for among-site rate variation by using a Gamma model<xref rid="bb0145" ref-type="bibr"><sup>29</sup></xref> clearly compared better with Benner's plots from experimental data (not shown). Finally, instead of determining rate variation by a Gamma distribution, we illustrate the effect using rate categories specified “by hand”. Excellent results were achieved by aggregation of simulated data from a codon model with among-site rate variation defined by 12 relative rate categories:<disp-formula id="fo0070"><label>(10)</label><mml:math id="M18" altimg="si18.gif" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.000001</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.00001</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>8.738889</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p>All categories were given the same probability (1/12), maintaining a mean rate of 1. While a Gamma distribution was not extreme enough, we note that our choice of distribution of evolutionary rates is still realistic. In particular, we needed very slowly evolving sites to explain the time dependence effect more than those given by a Gamma distribution; however, models allowing for a substantial proportion of invariant sites are widely used in phylogenetics.<xref rid="bb0190 bb0195" ref-type="bibr"><sup>38,39</sup></xref></p>
        <p>Results for this AMP model are shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>c and d and should be compared with Benner's results on experimental data in <xref rid="f0010" ref-type="fig">Fig. 2</xref>a and b. Similar to the graphs of the experimental data, the graphs of the simulated data show significant curvature. For the specific elements of the log-odds matrix that BCG plotted, the order and the trends of the graphs agree for the experimental and simulated AMP data. This shows that relatively complex but realistic time-homogeneous codon models can generate behavior similar to what BCG observed.</p>
        <p>However, some ranges of the experimental graphs are different (<xref rid="f0010" ref-type="fig">Fig. 2</xref>). We speculate that this may reflect the fact that the M0 codon model is not fully realistic, for example, treating all synonymous changes and all nonsynonymous changes equally and assigning the same level of selective pressure (ω) to all protein sites. AMPs based on more complex parametric codon models<xref rid="bb0110" ref-type="bibr"><sup>22</sup></xref> or on empirical codon models<xref rid="bb0110" ref-type="bibr"><sup>22</sup></xref> might give a picture of the ranges of <italic>L</italic>(250) matrix values more in accord with BCG's empirical results. Also, at high PAM distances, the simulated graphs converge to zero as predicted by theory. In contrast, BCG's experimental graphs actually often cross the zero line, which we attribute to problems such as difficulty of aligning divergent sequences, noise, small sample sizes, and so on.</p>
        <p>A final possibility not yet addressed is that BCG's experimental graphs could have the shapes they do not because of any systematic effect of molecular evolutionary processes but simply as a result of inferential noise. Our results from simulating data sets of approximately the sizes of those used by BCG indicate that the resulting levels of variability are not nearly sufficient to explain the difference in shapes between the curves shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref>a and b (BCG) and c and d (our results) (see <xref rid="ec1" ref-type="supplementary-material">Supplementary Material Fig. S2</xref> for details).</p>
      </sec>
      <sec id="s0075">
        <title>Comparison to Mitchison and Durbin's results</title>
        <p>We repeated Mitchison and Durbin's analysis using four simulations. We simulated data from Dayhoff's amino acid model as a simple time-homogeneous Markovian amino acid model and using a mixture of time-homogeneous Markovian amino acid models as described above, incorporating 182 rate heterogeneity (α) values.<xref rid="bb0185" ref-type="bibr"><sup>37</sup></xref> We also simulated data from an AMP based on the codon model described above, both without rate heterogeneity and with rate heterogeneity as given by the 12 rate categories in Eq. (<xref rid="fo0070" ref-type="disp-formula">10</xref>).</p>
        <p><xref rid="f0015" ref-type="fig">Figure 3</xref> compares the results from these four models to the experimental data of Mitchison and Durbin. <xref rid="f0015" ref-type="fig">Figure 3</xref>a confirms that a simple time-homogeneous Markov model on the amino acid level does not fit their observations. Although the mixture of time-homogeneous amino acid models gives results somewhat closer to experimental data, it still predicts the proportion of single base changes to decrease fairly linearly. Thus, it appears that time-homogeneous Markovian amino acid process models alone cannot explain the observations of Mitchison and Durbin.</p>
        <p><xref rid="f0015" ref-type="fig">Figure 3</xref>b shows similar poor agreement between Mitchison and Durbin's results and the results from our AMP with no rate heterogeneity. However, there is much better agreement for our AMP incorporating rate heterogeneity. Although this combination of time-homogeneous codon model, rate heterogeneity and aggregation does not reflect precisely the behavior of the experimental results for small times (PAM distances), it does capture much better the rapid and nonlinear decline of the proportion of single base changes. Again, apparent differences in protein evolution on different timescales can in fact be explained by an AMP.</p>
      </sec>
    </sec>
    <sec id="s0080">
      <title>Discussion</title>
      <p>Since the work of Dayhoff <italic>et al.</italic>, there have been increasingly good empirical models of the average patterns and processes of evolution of large collections of amino acid sequence, as well as more and more specialized matrices considering functional and structural properties of proteins. However, while most work in phylogenetic modeling is aimed at devising improved time-homogeneous Markov models, some criticisms have been directed at the time-homogeneity assumption and the models' Markov nature itself. Studies on experimental protein sequence data (e.g., by Benner <italic>et al.</italic><xref rid="bb0070" ref-type="bibr"><sup>14</sup></xref> and Mitchison and Durbin<xref rid="bb0065" ref-type="bibr"><sup>13</sup></xref>) have observed different substitution patterns at different levels of sequence divergence. These observations indicate that amino acid sequence evolution behaves in a time-dependent manner.</p>
      <p>While Benner <italic>et al.</italic> did not support their criticisms of the Markov nature of amino acid sequence evolution by consideration of time-dependent Markov processes, the claims that time-homogeneity was violated required further investigation.<xref rid="bb0070" ref-type="bibr"><sup>14</sup></xref> In a series of thought experiments, we have shown that past explanations (i.e., that the process of evolution is different for different divergence times) are irrational because the time of observation and the choice of sequences compared cannot have any influence on actual amino acid substitutions. However, time-homogeneous Markov models are fundamental to many applications in evolutionary studies, and we need to find some explanation for the observations.</p>
      <p>We emphasize that our criticism of Benner <italic>et al.</italic>' interpretation of their results should not be taken to mean that we are arguing against the importance of the genetic code or of amino acids' physiochemical properties in evolutionary models. However, we argue that these influence the average substitution patterns observed over collections of proteins at all evolutionary distances in the same way. Indeed, studies of genome variation data have suggested an influence of physicochemical properties at the population level<xref rid="bb0200 bb0205 bb0210" ref-type="bibr"><sup>40–42</sup></xref> and, thus, within a far-shorter period than the distances discussed in this paper.</p>
      <p>We have also shown that the time-dependent behavior described in the literature can be explained by modeling protein-coding DNA sequence evolution as an AMP that combines a time-homogeneous Markov model of codon evolution with rate heterogeneity among different codon sites of the protein and that evaluates what we would infer if we observed only encoded amino acid sequences at different divergence levels. This leads to a model that is non-Markovian on the observed amino acids, and we have focused on the consequences of non-Markovian behavior using the Chapman–Kolmogorov equation<xref rid="bb0175" ref-type="bibr"><sup>35</sup></xref> and comparisons to studies on experimental data by Benner <italic>et al.</italic><xref rid="bb0070" ref-type="bibr"><sup>14</sup></xref> and Mitchison and Durbin.<xref rid="bb0065" ref-type="bibr"><sup>13</sup></xref> Although previous results<xref rid="bb0065 bb0070" ref-type="bibr"><sup>13,14</sup></xref> cannot be explained by a pure time-homogeneous Markov model or a realistic mixture of such models on the amino acid level, the aggregated Markov model captures the qualitative behavior of empirical studies and leads to better agreement between models and empirical data. Although it does not incorporate any of the physicochemical properties considered by Benner <italic>et al.</italic> to be responsible for their results, the AMP in fact is able to capture quite accurately the form of the results interpreted by Benner <italic>et al.</italic> and Mitchison and Durbin as evidence of time-dependent evolution. We therefore conclude that the paradox that arose from past observations of time-dependent behavior can be resolved.</p>
      <p>AMPs based on M0 (above) capture the high proportion of single base changes at very low divergence levels observed by Mitchison and Durbin because they assume that individual codon replacements involve only single bases [Eq. (<xref rid="fo0020" ref-type="disp-formula">3</xref>)].<xref rid="bb0065" ref-type="bibr"><sup>13</sup></xref> Studies that have investigated instantaneous occurrence of multiple base replacements suggest that these do arise in low numbers.<xref rid="bb0215 bb0150" ref-type="bibr"><sup>43,30</sup></xref> AMPs based on models incorporating these events could lead to improved fit with Mitchison and Durbin's observations. We found that a high level of rate variation across sites was also needed to give a good fit to empirical results. An effect of this rate variation is to concentrate codon changes into a small number of highly variable sequence sites, leading to more changes per altered site and thus a higher proportion of altered sites requiring multiple base changes to explain observed amino acid differences. This contributes to the much steeper fall in the proportion of single base changes as divergence increases for the AMP with rate variation, as shown in <xref rid="f0015 f0010" ref-type="fig">Fig. 3b, and Fig. 2</xref> illustrates the same effects at the level of individual amino acid replacements. An additional effect that contributes to the improved fit of our rate-heterogeneous AMP is systematic underestimation of divergence caused by model misspecification. Here, we estimate divergences from data generated by a rate-heterogeneous codon process, with an amino acid model assuming rate homogeneity. The concentration of changes into a small number of sites leads to more multiple hits and thus more amino acid replacements that are not observable and underestimation of divergence levels (see <xref rid="ec1" ref-type="supplementary-material">Supplementary Material Fig. S3</xref>; the nonlinearity of the relationship between <italic>t</italic><sub><italic>k</italic></sub><sup>⁎</sup> and the inferred PAM distance also explains the gradient changes in the rate-heterogeneous AMP plot in <xref rid="f0015" ref-type="fig">Fig. 3</xref>b).</p>
      <p>The considerable level of rate variation across sites needed to generate behavior similar to that observed by Benner <italic>et al.</italic> and Mitchison and Durbin could also be caused in part by variation in selective pressures such as those modeled by parameters of the M7 or M8 codon models for selection.<xref rid="bb0110" ref-type="bibr"><sup>22</sup></xref> Such study of the causes of rate heterogeneity is beyond the “proof-of-principle” approach used in this paper. Furthermore, our comparisons were limited, since the original data (and detailed results) of the above studies are not available anymore. However, the results of our simulation study using AMPs already strongly suggest that protein evolution will be most accurately modeled with codon rather than amino acid substitution models.</p>
      <p>This recommendation is in accord with recent work on the use of codon-level models for molecular phylogenetics. Ren <italic>et al.</italic> study the utility of codon models for phylogenetic reconstruction and molecular dating.<xref rid="bb0220" ref-type="bibr"><sup>44</sup></xref> They report that codon models have good performance in both recent and deep divergences. Although their computational burden makes codon models currently infeasible for tree searching, Ren <italic>et al.</italic> recommend them for comparing predetermined candidate trees. In contrast, modeling protein sequence evolution on the amino acid level may introduce systematic error. The nature of protein-coding sequence evolution is such that time-homogeneous Markov modeling on the codon level seems reasonable, but this leads to time-dependent and non-Markov behavior on the amino acid level. It is increasingly feasible to use codon models where amino acid models have been used in the past, and our results overturn a long-standing claim that proteins evolve in a time-dependent manner and give further reasons why codon models may be preferable.</p>
      <p>Supplementary materials related to this article can be found online at <ext-link ext-link-type="doi" xlink:href="10.1016/j.jmb.2011.06.005">doi:10.1016/j.jmb.2011.06.005</ext-link></p>
      <p>The following are the supplementary materials related to this article.<supplementary-material content-type="local-data" id="ec1"><caption><p>Supplementary materials</p></caption><media xlink:href="mmc1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></p>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="bb0005">
        <label>1</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Dayhoff</surname>
              <given-names>M.O.</given-names>
            </name>
            <name>
              <surname>Eck</surname>
              <given-names>R.V.</given-names>
            </name>
          </person-group>
          <chapter-title>A model of evolutionary change in proteins</chapter-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Dayhoff</surname>
              <given-names>M.O.</given-names>
            </name>
            <name>
              <surname>Eck</surname>
              <given-names>R.V.</given-names>
            </name>
          </person-group>
          <source>Atlas of Protein Sequence and Structure</source>
          <year>1968</year>
          <publisher-name>National Biomedical Research Foundation</publisher-name>
          <publisher-loc>Washington, DC</publisher-loc>
          <fpage>33</fpage>
          <lpage>41</lpage>
        </element-citation>
      </ref>
      <ref id="bb0010">
        <label>2</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Adachi</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Hasegawa</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Model of amino acid substitution in proteins encoded by mitochondrial DNA</article-title>
          <source>J. Mol. Evol.</source>
          <volume>42</volume>
          <year>1996</year>
          <fpage>459</fpage>
          <lpage>468</lpage>
          <pub-id pub-id-type="pmid">8642615</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0015">
        <label>3</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Thorne</surname>
              <given-names>J.L.</given-names>
            </name>
            <name>
              <surname>Jones</surname>
              <given-names>D.T.</given-names>
            </name>
          </person-group>
          <article-title>Assessing the impact of secondary structure and solvent accessibility on protein evolution</article-title>
          <source>Genetics</source>
          <volume>149</volume>
          <year>1998</year>
          <fpage>445</fpage>
          <lpage>458</lpage>
          <pub-id pub-id-type="pmid">9584116</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0020">
        <label>4</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Liò</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Using protein structural information in evolutionary inference: transmembrane proteins</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>16</volume>
          <year>1999</year>
          <fpage>1696</fpage>
          <lpage>1710</lpage>
          <pub-id pub-id-type="pmid">10605112</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0025">
        <label>5</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Le</surname>
              <given-names>S.Q.</given-names>
            </name>
            <name>
              <surname>Gascuel</surname>
              <given-names>O.</given-names>
            </name>
          </person-group>
          <article-title>Accounting for solvent accessibility and secondary structure in protein phylogenetics is clearly beneficial</article-title>
          <source>Syst. Biol.</source>
          <volume>59</volume>
          <year>2010</year>
          <fpage>277</fpage>
          <lpage>287</lpage>
          <pub-id pub-id-type="pmid">20525635</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0030">
        <label>6</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Liò</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Models of molecular evolution and phylogeny</article-title>
          <source>Genome Res.</source>
          <volume>8</volume>
          <year>1998</year>
          <fpage>1233</fpage>
          <lpage>1244</lpage>
          <pub-id pub-id-type="pmid">9872979</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0035">
        <label>7</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Thorne</surname>
              <given-names>J.L.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <chapter-title>Probabilistic models for the study of protein evolution</chapter-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Balding</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Bishop</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Cannings</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <source>Handbook of Statistical Genetics</source>
          <year>2007</year>
          <publisher-name>Wiley</publisher-name>
          <publisher-loc>Chichester, UK</publisher-loc>
          <fpage>439</fpage>
          <lpage>459</lpage>
        </element-citation>
      </ref>
      <ref id="bb0040">
        <label>8</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Felsenstein</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Maximum likelihood and minimum-steps methods for estimating evolutionary trees from data on discrete characters</article-title>
          <source>Syst. Zool.</source>
          <volume>22</volume>
          <year>1973</year>
          <fpage>240</fpage>
          <lpage>249</lpage>
        </element-citation>
      </ref>
      <ref id="bb0045">
        <label>9</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
          </person-group>
          <chapter-title>Computational Molecular Evolution</chapter-title>
          <year>2006</year>
          <publisher-name>Oxford University Press</publisher-name>
          <publisher-loc>Oxford, UK</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0050">
        <label>10</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Evaluation and extension of Markov process models for the evolution of DNA (in Chinese, with Abstract in English)</article-title>
          <source>Acta Genet. Sin.</source>
          <volume>21</volume>
          <year>1994</year>
          <fpage>17</fpage>
          <lpage>23</lpage>
          <pub-id pub-id-type="pmid">8003346</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0055">
        <label>11</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kosiol</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Different versions of the Dayhoff rate matrix</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>22</volume>
          <year>2005</year>
          <fpage>193</fpage>
          <lpage>199</lpage>
          <pub-id pub-id-type="pmid">15483331</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0060">
        <label>12</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Henikoff</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Henikoff</surname>
              <given-names>J.G.</given-names>
            </name>
          </person-group>
          <article-title>Amino acid substitution matrices from protein blocks</article-title>
          <source>Proc. Natl Acad. Sci. USA</source>
          <volume>89</volume>
          <year>1992</year>
          <fpage>10915</fpage>
          <lpage>10919</lpage>
          <pub-id pub-id-type="pmid">1438297</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0065">
        <label>13</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Mitchison</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Durbin</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Tree-based maximal likelihood substitution matrices and hidden Markov models</article-title>
          <source>J. Mol. Evol.</source>
          <volume>41</volume>
          <year>1995</year>
          <fpage>1139</fpage>
          <lpage>1151</lpage>
        </element-citation>
      </ref>
      <ref id="bb0070">
        <label>14</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Benner</surname>
              <given-names>S.A.</given-names>
            </name>
            <name>
              <surname>Cohen</surname>
              <given-names>M.A.</given-names>
            </name>
            <name>
              <surname>Gonnet</surname>
              <given-names>G.H.</given-names>
            </name>
          </person-group>
          <article-title>Amino acid substitution during functionally constrained divergent evolution of protein sequences</article-title>
          <source>Protein Eng.</source>
          <volume>7</volume>
          <year>1994</year>
          <fpage>1323</fpage>
          <lpage>1332</lpage>
          <pub-id pub-id-type="pmid">7700864</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0075">
        <label>15</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Bartlett</surname>
              <given-names>M.S.</given-names>
            </name>
          </person-group>
          <chapter-title>Introduction to Stochastic Processes</chapter-title>
          <edition>3rd edit.</edition>
          <year>1978</year>
          <publisher-name>Cambridge University Press</publisher-name>
          <publisher-loc>Cambridge, UK</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0080">
        <label>16</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Ohno</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <chapter-title>Evolution by Gene Duplication</chapter-title>
          <year>1970</year>
          <publisher-name>Springer-Verlag</publisher-name>
          <publisher-loc>Berlin, Germany</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0085">
        <label>17</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Seoighe</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Johnston</surname>
              <given-names>C.R.</given-names>
            </name>
            <name>
              <surname>Shields</surname>
              <given-names>D.C.</given-names>
            </name>
          </person-group>
          <article-title>Significantly different patterns of amino acid replacement after gene duplication as compared to after speciation</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>20</volume>
          <year>2003</year>
          <fpage>484</fpage>
          <lpage>490</lpage>
          <pub-id pub-id-type="pmid">12654935</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0090">
        <label>18</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kondrashov</surname>
              <given-names>F.A.</given-names>
            </name>
            <name>
              <surname>Rogozin</surname>
              <given-names>I.B.</given-names>
            </name>
            <name>
              <surname>Wolf</surname>
              <given-names>Y.I.</given-names>
            </name>
            <name>
              <surname>Koonin</surname>
              <given-names>E.V.</given-names>
            </name>
          </person-group>
          <article-title>Selection in the evolution of gene duplications</article-title>
          <source>Genome Biol.</source>
          <volume>3</volume>
          <year>2002</year>
          <comment>research0008.1–0008.9</comment>
        </element-citation>
      </ref>
      <ref id="bb0095">
        <label>19</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Larget</surname>
              <given-names>B.</given-names>
            </name>
          </person-group>
          <article-title>A canonical representation for aggregated Markov processes</article-title>
          <source>J. Appl. Probab.</source>
          <volume>32</volume>
          <year>1998</year>
          <fpage>313</fpage>
          <lpage>324</lpage>
        </element-citation>
      </ref>
      <ref id="bb0100">
        <label>20</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Klosterman</surname>
              <given-names>P.S.</given-names>
            </name>
            <name>
              <surname>Uzilov</surname>
              <given-names>A.V.</given-names>
            </name>
            <name>
              <surname>Bendaña</surname>
              <given-names>Y.R.</given-names>
            </name>
            <name>
              <surname>Bradley</surname>
              <given-names>R.K.</given-names>
            </name>
            <name>
              <surname>Chao</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Kosiol</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <article-title>XRate: a fast prototyping, training and annotation tool for phylo-grammars</article-title>
          <source>BMC Bioinformatics</source>
          <volume>7</volume>
          <year>2006</year>
          <fpage>428</fpage>
          <pub-id pub-id-type="pmid">17018148</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0105">
        <label>21</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
          </person-group>
          <article-title>A codon-based model of nucleotide substitution for protein-coding DNA sequences</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>11</volume>
          <year>1994</year>
          <fpage>725</fpage>
          <lpage>736</lpage>
          <pub-id pub-id-type="pmid">7968486</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0110">
        <label>22</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Nielsen</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Pedersen</surname>
              <given-names>A.M.</given-names>
            </name>
          </person-group>
          <article-title>Codon-substitution models for heterogeneous selection pressure at amino acid sites</article-title>
          <source>Genetics</source>
          <volume>155</volume>
          <year>2000</year>
          <fpage>431</fpage>
          <lpage>449</lpage>
          <pub-id pub-id-type="pmid">10790415</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0115">
        <label>23</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Norris</surname>
              <given-names>J.R.</given-names>
            </name>
          </person-group>
          <chapter-title>Markov Chains</chapter-title>
          <year>1997</year>
          <publisher-name>Cambridge University Press</publisher-name>
          <publisher-loc>Cambridge, UK</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0120">
        <label>24</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Moler</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Van Loan</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <article-title>Nineteen dubious ways to compute the exponential of a matrix, twenty-five years later</article-title>
          <source>SIAM Rev.</source>
          <volume>45</volume>
          <year>2003</year>
          <fpage>3</fpage>
          <lpage>49</lpage>
        </element-citation>
      </ref>
      <ref id="bb0125">
        <label>25</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
          </person-group>
          <article-title>PAML 4: phylogenetic analysis by maximum likelihood</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>24</volume>
          <year>2007</year>
          <fpage>1586</fpage>
          <lpage>1591</lpage>
          <pub-id pub-id-type="pmid">17483113</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0130">
        <label>26</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Muse</surname>
              <given-names>S.V.</given-names>
            </name>
            <name>
              <surname>Gaut</surname>
              <given-names>B.S.</given-names>
            </name>
          </person-group>
          <article-title>A likelihood approach for comparing synonymous and nonsynonymous nucleotide substitution rates, with application to the chloroplast genome</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>11</volume>
          <year>1994</year>
          <fpage>715</fpage>
          <lpage>724</lpage>
          <pub-id pub-id-type="pmid">7968485</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0135">
        <label>27</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Nielsen</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Codon-substitution models for detecting molecular adaptation at individual sites along specific lineages</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>19</volume>
          <year>2002</year>
          <fpage>908</fpage>
          <lpage>917</lpage>
          <pub-id pub-id-type="pmid">12032247</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0140">
        <label>28</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Massingham</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Detecting amino acid sites under positive selection and purifying selection</article-title>
          <source>Genetics</source>
          <volume>169</volume>
          <year>2005</year>
          <fpage>1753</fpage>
          <lpage>1762</lpage>
          <pub-id pub-id-type="pmid">15654091</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0145">
        <label>29</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
          </person-group>
          <article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title>
          <source>J. Mol. Evol.</source>
          <volume>39</volume>
          <year>1994</year>
          <fpage>306</fpage>
          <lpage>314</lpage>
          <pub-id pub-id-type="pmid">7932792</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0150">
        <label>30</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kosiol</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Holmes</surname>
              <given-names>I.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>An empirical codon model for protein sequence evolution</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>24</volume>
          <year>2007</year>
          <fpage>1464</fpage>
          <lpage>1479</lpage>
          <pub-id pub-id-type="pmid">17400572</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0155">
        <label>31</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Kuensch</surname>
              <given-names>H.R.</given-names>
            </name>
          </person-group>
          <chapter-title>State space and hidden Markov models</chapter-title>
          <person-group person-group-type="editor">
            <name>
              <surname>Barndorff-Nielsen</surname>
              <given-names>O.E.</given-names>
            </name>
            <name>
              <surname>Cox</surname>
              <given-names>D.R.</given-names>
            </name>
            <name>
              <surname>Klüppelberg</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <source>Complex Stochastic Systems</source>
          <year>2001</year>
          <publisher-name>CRC Press</publisher-name>
          <publisher-loc>New York, NY</publisher-loc>
          <fpage>109</fpage>
          <lpage>173</lpage>
        </element-citation>
      </ref>
      <ref id="bb0160">
        <label>32</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Nielsen</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Hasegawa</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Models of amino acid substitution and applications to mitochondrial protein evolution</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>15</volume>
          <year>1998</year>
          <fpage>1600</fpage>
          <lpage>1611</lpage>
          <pub-id pub-id-type="pmid">9866196</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0165">
        <label>33</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gonnet</surname>
              <given-names>G.H.</given-names>
            </name>
            <name>
              <surname>Cohen</surname>
              <given-names>M.A.</given-names>
            </name>
            <name>
              <surname>Benner</surname>
              <given-names>S.A.</given-names>
            </name>
          </person-group>
          <article-title>Exhaustive matching of the entire protein sequence database</article-title>
          <source>Science</source>
          <volume>256</volume>
          <year>1992</year>
          <fpage>1443</fpage>
          <lpage>1445</lpage>
          <pub-id pub-id-type="pmid">1604319</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0170">
        <label>34</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Fletcher</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
          </person-group>
          <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>26</volume>
          <year>2009</year>
          <fpage>1879</fpage>
          <lpage>1888</lpage>
          <pub-id pub-id-type="pmid">19423664</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0175">
        <label>35</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Gillespie</surname>
              <given-names>D.T.</given-names>
            </name>
          </person-group>
          <chapter-title>Markov Processes: An Introduction for Physical Scientists</chapter-title>
          <year>1992</year>
          <publisher-name>London Academic Press</publisher-name>
          <publisher-loc>Boston, UK</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bb0180">
        <label>36</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Friday</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <article-title>Comparison of models for nucleotide substitution used in maximum-likelihood phylogenetic estimation</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>11</volume>
          <year>1994</year>
          <fpage>316</fpage>
          <lpage>324</lpage>
          <pub-id pub-id-type="pmid">8170371</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0185">
        <label>37</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Whelan</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <article-title>A novel use of equilibrium frequencies in models of sequence evolution</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>19</volume>
          <year>2002</year>
          <fpage>1821</fpage>
          <lpage>1831</lpage>
          <pub-id pub-id-type="pmid">12411592</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0190">
        <label>38</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gu</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Fu</surname>
              <given-names>Y.X.</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>W.H.</given-names>
            </name>
          </person-group>
          <article-title>Maximum likelihood estimation of the heterogeneity of substitution rate among nucleotide sites</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>12</volume>
          <year>1995</year>
          <fpage>546</fpage>
          <lpage>557</lpage>
          <pub-id pub-id-type="pmid">7659011</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0195">
        <label>39</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Le</surname>
              <given-names>S.Q.</given-names>
            </name>
            <name>
              <surname>Gascuel</surname>
              <given-names>O.</given-names>
            </name>
          </person-group>
          <article-title>An improved general amino acid replacement matrix</article-title>
          <source>Mol. Biol. Evol.</source>
          <volume>25</volume>
          <year>2008</year>
          <fpage>1307</fpage>
          <lpage>1320</lpage>
          <pub-id pub-id-type="pmid">18367465</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0200">
        <label>40</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sunyaev</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Ramensky</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>Bork</surname>
              <given-names>P.</given-names>
            </name>
          </person-group>
          <article-title>Towards a structural basis of human non-synonymous single nucleotide polymorphisms</article-title>
          <source>Trends Genet.</source>
          <volume>16</volume>
          <year>2000</year>
          <fpage>198</fpage>
          <lpage>200</lpage>
          <pub-id pub-id-type="pmid">10782110</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0205">
        <label>41</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ng</surname>
              <given-names>P.C.</given-names>
            </name>
            <name>
              <surname>Henikoff</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <article-title>SIFT: predicting amino acid changes that affect protein function</article-title>
          <source>Nucleic Acids Res.</source>
          <volume>31</volume>
          <year>2003</year>
          <fpage>3812</fpage>
          <lpage>3814</lpage>
          <pub-id pub-id-type="pmid">12824425</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0210">
        <label>42</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Williamson</surname>
              <given-names>S.H.</given-names>
            </name>
            <name>
              <surname>Hernandez</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Fledel-Alon</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Nielsen</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Bustamante</surname>
              <given-names>C.D.</given-names>
            </name>
          </person-group>
          <article-title>Simultaneous inference of selection and population growth from patterns of variation in the human genome</article-title>
          <source>Proc. Natl Acad. Sci. USA</source>
          <volume>102</volume>
          <year>2005</year>
          <fpage>7882</fpage>
          <lpage>7887</lpage>
          <pub-id pub-id-type="pmid">15905331</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0215">
        <label>43</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Whelan</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <article-title>Estimating the frequency of events that cause multiple-nucleotide changes</article-title>
          <source>Genetics</source>
          <volume>167</volume>
          <year>2004</year>
          <fpage>2027</fpage>
          <lpage>2043</lpage>
          <pub-id pub-id-type="pmid">15342538</pub-id>
        </element-citation>
      </ref>
      <ref id="bb0220">
        <label>44</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ren</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Tanaka</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>Z.</given-names>
            </name>
          </person-group>
          <article-title>An empirical examination of the utility of codon substitution models in phylogenetic reconstruction</article-title>
          <source>Syst. Biol.</source>
          <volume>54</volume>
          <year>2005</year>
          <fpage>808</fpage>
          <lpage>818</lpage>
          <pub-id pub-id-type="pmid">16243764</pub-id>
        </element-citation>
      </ref>
    </ref-list>
    <ack>
      <title>Acknowledgements</title>
      <p>C.K. and N.G. would like to thank Bret Larget and Allen Rodrigo for discussions on AMPs and an anonymous referee for extensive and perceptive comments that led to numerous improvements to the manuscript. This research was supported by the Wellcome Trust through grants GR069321MA and GR078968MA.</p>
    </ack>
  </back>
  <floats-group>
    <fig id="f0005">
      <label>Fig. 1</label>
      <caption>
        <p>Observing evolutionary processes at different time points. Throughout the figure, different colors represent different substitution processes along a branch, and we consider observing different sequence pairs (colored lineages) at time <italic>t</italic><sub>0</sub> (black eye) and at later time <italic>t</italic><sub>1</sub> (gray eye). (a) Simple time-homogeneous Markov model. (b) Replacement dynamics dependent on time since MRCA, color coded according to spectrum to the left of panel. (c) Approach of Benner <italic>et al.</italic>: replacement dynamics dependent on speciation and duplication events and subsequent elapsed time. The “callout” (green box) with asterisks indicates lineage splits that are not observed when pairwise comparisons B and E are used. (d) Modeling the “average” process using a time-homogenous approach: process changes without trend are indicated by random change in color patterns. Note that, for all the processes illustrated in (a)–(d), we assume that corrections for the occurrence of multiple substitutions have been made so that the “snapshot” we take at different times should not lead to different observations caused by multiple substitutions.</p>
      </caption>
      <graphic xlink:href="gr1"/>
    </fig>
    <fig id="f0010">
      <label>Fig. 2</label>
      <caption>
        <p>Graphs of some cross terms of <italic>L</italic>(250) log-odds matrices. For example, the line labeled WF represents the value of the cross term (off-diagonal element) [<italic>L</italic>(250)]<sub>WF</sub> computed from data at divergence levels between 0 and 100 PAMs. (a and b) Graphs redrawn from Benner <italic>et al.</italic>,<xref rid="bb0070" ref-type="bibr"><sup>14</sup></xref> colored for clarity. (c and d) Results of simulations under an AMP model.</p>
      </caption>
      <graphic xlink:href="gr2"/>
    </fig>
    <fig id="f0015">
      <label>Fig. 3</label>
      <caption>
        <p>Comparison to Mitchison and Durbin's results. (a) Experimental data, simple time-homogeneous Markovian and mixture of time-homogeneous Markov processes on the amino acid level. (b) Experimental data and aggregated processes of a codon-level time-homogeneous Markov process both with and without rate heterogeneity.</p>
      </caption>
      <graphic xlink:href="gr3"/>
    </fig>
    <fig id="f0020">
      <label>Fig. 4</label>
      <caption>
        <p>Dependence of transition probabilities on the time of intermediate observation. Transition probabilities for the purely Markov codon model (labeled Codon) and the AMP (Aggregated) are calculated using the right-hand side of the Chapman–Kolmogorov Eq. (<xref rid="fo0055" ref-type="disp-formula">8</xref>). (a) Probability of a change from cysteine (C) to methionine (M) via an intermediate step at time τ. Cysteine and methionine are distant in the genetic code (three-nucleotide changes). (b) Probability of a change from cysteine (C) to arginine (R) via an intermediate step at time τ. Cysteine and arginine are close in the genetic code (one-nucleotide change).</p>
      </caption>
      <graphic xlink:href="gr4"/>
    </fig>
  </floats-group>
</article>