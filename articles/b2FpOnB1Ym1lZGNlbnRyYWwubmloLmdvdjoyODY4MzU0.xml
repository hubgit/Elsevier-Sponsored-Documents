<article xmlns="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://dtd.nlm.nih.gov/2.0/xsd/archivearticle http://dtd.nlm.nih.gov/2.0/xsd/archivearticle.xsd" article-type="research-article">
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Ultramicroscopy</journal-id>
      <journal-title-group>
        <journal-title>Ultramicroscopy</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">0304-3991</issn>
      <issn pub-type="epub">1879-2723</issn>
      <publisher>
        <publisher-name>Elsevier</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmc">2868354</article-id>
      <article-id pub-id-type="pmid">19647366</article-id>
      <article-id pub-id-type="publisher-id">ULTRAM10874</article-id>
      <article-id pub-id-type="doi">10.1016/j.ultramic.2009.07.004</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Enhanced imaging in low dose electron microscopy using electron counting</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>McMullan</surname>
            <given-names>G.</given-names>
          </name>
          <email>gm2@mrc-lmb.cam.ac.uk</email>
          <xref rid="aff1" ref-type="aff">a</xref>
          <xref rid="cor1" ref-type="corresp">⁎</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>A.T.</given-names>
          </name>
          <xref rid="aff2" ref-type="aff">b</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Turchetta</surname>
            <given-names>R.</given-names>
          </name>
          <xref rid="aff2" ref-type="aff">b</xref>
        </contrib>
        <contrib contrib-type="author">
          <name>
            <surname>Faruqi</surname>
            <given-names>A.R.</given-names>
          </name>
          <xref rid="aff1" ref-type="aff">a</xref>
        </contrib>
      </contrib-group>
      <aff id="aff1"><label>a</label>MRC Laboratory of Molecular Biology, Hills Road, Cambridge CB2 0QH, UK</aff>
      <aff id="aff2"><label>b</label>STFC Rutherford Appleton Laboratory, Chilton, Didcot OX11 0QX, UK</aff>
      <author-notes>
        <corresp id="cor1"><label>⁎</label>Corresponding author. <email>gm2@mrc-lmb.cam.ac.uk</email></corresp>
      </author-notes>
      <pub-date pub-type="pmc-release">
        <month>11</month>
        <year>2009</year>
      </pub-date>
      <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="ppub"/>. -->
      <pub-date pub-type="ppub">
        <month>11</month>
        <year>2009</year>
      </pub-date>
      <volume>109</volume>
      <issue>12</issue>
      <fpage>1411</fpage>
      <lpage>1416</lpage>
      <history>
        <date date-type="received">
          <day>20</day>
          <month>3</month>
          <year>2009</year>
        </date>
        <date date-type="rev-recd">
          <day>24</day>
          <month>6</month>
          <year>2009</year>
        </date>
        <date date-type="accepted">
          <day>7</day>
          <month>7</month>
          <year>2009</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2009 Elsevier B.V.</copyright-statement>
        <copyright-year>2009</copyright-year>
        <copyright-holder>Elsevier B.V.</copyright-holder>
        <license>
          <license-p>This document may be redistributed and reused, subject to <ext-link ext-link-type="uri" xlink:href="http://www.elsevier.com/wps/find/authorsview.authors/supplementalterms1.0">certain conditions</ext-link>.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>We compare the direct electron imaging performance at 120 keV of a monolithic active pixel sensor (MAPS) operated in a conventional integrating mode with the performance obtained when operated in a single event counting mode. For the combination of sensor and incident electron energy used here, we propose a heuristic approach with which to process the single event images in which each event is renormalised to have an integrated weight of unity. Using this approach we find enhancements in the Nyquist frequency modulation transfer function (MTF) and detective quantum efficiency (DQE) over the corresponding integrating mode values by factors of 8 and 3, respectively.</p>
      </abstract>
      <kwd-group>
        <title>Keywords</title>
        <kwd>DQE</kwd>
        <kwd>MTF</kwd>
        <kwd>CMOS</kwd>
        <kwd>Electron counting</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="sec1">
      <label>1</label>
      <title>Introduction</title>
      <p>The signal to noise ratio in an electron microscope image of a radiation sensitive sample is limited by the small number of incident electrons that can be used to form the image before radiation damage destroys the specimen. In the study of radiation sensitive samples the electron detector performance therefore assumes a greater importance than with less radiation sensitive samples. A convenient way to measure the performance of a detector is with the detective quantum efficiency (DQE). At zero spatial frequency this is defined as<disp-formula id="fd1"><label>(1)</label><mml:math id="M1" altimg="si0011.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>out</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>in</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></disp-formula>in which <inline-formula><alternatives><textual-form specific-use="jats-markup">(<italic>S</italic> / <italic>N</italic>)</textual-form><mml:math id="M2" altimg="si0012.gif" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>/</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> indicates the signal to noise ratio. An ideal detector faithfully records all incident electrons with the same response and without introducing additional noise. Such a detector has a DQE of unity but all real detectors have lower values. For imaging applications the generalisation of Eq. <xref rid="fd1" ref-type="disp-formula">(1)</xref> to finite spatial frequency, ω, is important. This can be expressed as <xref rid="bib1 bib2 bib3" ref-type="bibr">[1–3]</xref><disp-formula id="fd2"><label>(2)</label><mml:math id="M3" altimg="si0014.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>MTF</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>in which <inline-formula><alternatives><textual-form specific-use="jats-markup">MTF(ω)</textual-form><mml:math id="M4" altimg="si0015.gif" overflow="scroll"><mml:mi>MTF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> is the modulation transfer function, <italic>n</italic> is the number of incident electrons per pixel, <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>d</italic><sub><italic>n</italic></sub></textual-form><mml:math id="M5" altimg="si0016.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> the average output signal, <inline-formula><alternatives><textual-form specific-use="jats-markup">NPS<sub><italic>n</italic></sub>(ω)</textual-form><mml:math id="M6" altimg="si0017.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> the noise power spectrum of the image and the output signal per incident electron is given by <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>d</italic><sub><italic>n</italic></sub> / <italic>n</italic></textual-form><mml:math id="M7" altimg="si0018.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>. The subscript <italic>n</italic> on <inline-formula><alternatives><textual-form specific-use="jats-markup"><italic>d</italic><sub><italic>n</italic></sub></textual-form><mml:math id="M8" altimg="si0019.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup">NPS<sub><italic>n</italic></sub>(ω)</textual-form><mml:math id="M9" altimg="si0020.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> is used to emphasise that they are the values obtained with <italic>n</italic> electrons per pixel. From Eq. <xref rid="fd2" ref-type="disp-formula">(2)</xref> it can be seen that a high <inline-formula><alternatives><textual-form specific-use="jats-markup">MTF(ω)</textual-form><mml:math id="M10" altimg="si0021.gif" overflow="scroll"><mml:mi>MTF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> is advantageous in achieving a high <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M11" altimg="si0022.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> but not essential provided there is a corresponding drop in the <inline-formula><alternatives><textual-form specific-use="jats-markup">NPS<sub><italic>n</italic></sub>(ω)</textual-form><mml:math id="M12" altimg="si0023.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula>.</p>
      <p>Monolithic active pixel sensors, MAPS, show great promise as direct detectors of electrons with energies between 100 and 300 keV typically used in an electron microscope <xref rid="bib4 bib5 bib6 bib7 bib8" ref-type="bibr">[4–8]</xref>. They combine the advantages of film (which result from detecting incident electrons in a thin, i.e. <inline-formula><alternatives><textual-form specific-use="jats-markup">~10 μ<italic>m</italic></textual-form><mml:math id="M13" altimg="si0024.gif" overflow="scroll"><mml:mo>~</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:math></alternatives></inline-formula>, sensitive layer) with the low noise, fast readout, and immediate feedback of electronic detectors. They are fabricated using standard CMOS technology which enables them to be produced with large numbers of pixels, e.g., <inline-formula><alternatives><textual-form specific-use="jats-markup">4 <italic>k</italic>×4 <italic>k</italic></textual-form><mml:math id="M14" altimg="si0025.gif" overflow="scroll"><mml:mn>4</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">k</mml:mi><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">k</mml:mi></mml:math></alternatives></inline-formula>. The exposure to high energy electrons in direct detection does however lead to radiation damage in the detector itself. The initial consequence of this is an increase in leakage current but by using standard radiation hardening (radhard) design techniques, along with fast readout and cooling, it is possible to make a detector that is usable even after an exposure to more than 1 MRad <xref rid="bib9 bib7" ref-type="bibr">[9,7]</xref>. While insufficient for many applications, this level of radiation hardness is sufficient for several years of careful use in low dose applications such as cryoEM or cryo-tomography.</p>
      <p>In a MAPS detector, incident electrons or photons are detected via the voltage drop across a capacitor resulting from the collection of mobile charge associated with electron–hole pair excitations generated in a sensitive layer consisting of a highly ordered epitaxially grown semiconductor. To maximise the response and minimise the reset noise, the associated capacitance is usually kept as small as possible <xref rid="bib10" ref-type="bibr">[10]</xref>. In the detection of visible light the number of electron–hole excitations generated per incident photon and corresponding voltage drop per photon, is small. The detector is therefore operated in what we will call an integrating mode, in which the voltage drop is measured after a fixed time and contains the sum of contributions from a large number of incident photons. MAPS detectors recording incident electrons are conventionally also operated in this mode. The number of electron–hole pairs generated per incident electron is however much larger and to avoid saturation the number of electrons incident during the integration time must be kept low. The actual numbers are design dependent but at 120 keV the average number of incident electrons per pixel in an individual frame typically has to be kept below 10. As a result even a typical low dose image, with just 25 electrons per pixel, has to be accumulated over several frames. The sensitivity of MAPS detectors to incident electrons does however allow the detection of individual incident electrons. This makes it possible to generate an image using what we will call the single electron event mode, in which the final image is assembled from the information contained in the images of the individual incident electrons. In order to do this, it must be possible to distinguish the individual events and so the total number of electrons incident per frame must be kept very low. As a result, a low dose image collected in single electron event mode has to be generated from several thousand individual frames.</p>
      <p>The performance of a MAPS detector in recording electrons can be optimised through the choice of pixel size as well as the thickness of the passivation, sensitive layer and substrate together with the use of low noise readout. When operated in integrating mode the performance is limited by a number of factors. In particular the intrinsic variability of the energy deposited along the stochastic trajectory followed by an incident electron through the sensitive layer and the blurring of the resulting signal by the diffusion of charge carriers within the sensitive layer. In this paper we show that it is possible to minimise these factors and produce improved images by computational analysis of the signals from individual incident electrons.</p>
    </sec>
    <sec sec-type="methods" id="sec2">
      <label>2</label>
      <title>Methods</title>
      <p>Images were recorded on an experimental MAPS detector fabricated as part of the MI3 collaboration <xref rid="bib11" ref-type="bibr">[11]</xref>. The detector is known as a Vanilla detector and has a non-radhard three transistor (3T) pixel design <xref rid="bib12 bib10" ref-type="bibr">[12,10]</xref>. Each pixel has an area of <inline-formula><alternatives><textual-form specific-use="jats-markup">25×25 μ<italic>m</italic><sup>2</sup></textual-form><mml:math id="M15" altimg="si0026.gif" overflow="scroll"><mml:mn>25</mml:mn><mml:mo>×</mml:mo><mml:mn>25</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> and the whole detector consists of <inline-formula><alternatives><textual-form specific-use="jats-markup">520×520</textual-form><mml:math id="M16" altimg="si0027.gif" overflow="scroll"><mml:mn>520</mml:mn><mml:mo>×</mml:mo><mml:mn>520</mml:mn></mml:math></alternatives></inline-formula> pixels. The detector is read out using a rolling shutter via 12-bit successive approximation ADCs fabricated on the sensor. There is one ADC for every four columns and with these the whole sensor can be readout at a maximum rate of 148 fps. The operation of the sensor is controlled by custom FPGA software that allows it to be reset and readout in different modes and at different speeds. The results presented here were obtained using a hard reset <xref rid="bib10" ref-type="bibr">[10]</xref> and the sensor integration time, and corresponding frame rate, adjusted using time delays at the end of each frame. Output from the sensor is transferred via gigabit Ethernet for processing and storage on a dedicated computer.</p>
      <p>The detector was mounted at the plate camera position in a Philips CM12 microscope operating at 120 keV. The electron dose was calculated from the microscope exposure meter which was cross calibrated, via film images, with a Faraday cup on an adjacent microscope. The actual number of electrons per frame was controlled by varying the magnification of the microscope. Single event images were typically collected using approximately 1 electron per 500 pixels so that a data set with a total of 15 electrons per pixel requires 55 s to collect, consists of nearly 8000 frames and requires 4 GB of storage. While it is useful to retain all the images it was also possible to retain only the single events or simply the final processed image. The detector does not employ correlated double sampling and all images are dark subtracted and gain normalised.</p>
      <p>To find the single events we first search for a seed pixel in which the signal is above a fixed threshold relative to the background. Having found a seed pixel the remainder of the corresponding event is obtained by including all neighbouring pixels that either have signal above the threshold, or are within a given distance of any other pixel that is above the threshold. Because of the high signal to noise, the choice of threshold is not critical. The threshold is typically taken to be as low as possible, so as to minimise the number of true events missed, but yet sufficiently high, so as to avoid generating false events. As the size of each event is limited, the search can be carried out in a cache efficient manner along a row following a few rows behind the current rolling shutter readout window. This enables the finding and processing of the individual events to be carried out during the acquisition of images, though in practice the analysis presented here was done off-line.</p>
      <p>Single event images can be analysed in many ways. Simply counting those pixels in which the signal exceeds a given threshold mimics the behaviour of the Medipix2 hybrid pixel detector <xref rid="bib13 bib14" ref-type="bibr">[13,14]</xref>. A problem with this procedure is that individual events can be recorded in more than one pixel. This introduces a variability in response to an incident electrons that results in a decreased DQE. To avoid this, individual events need to be identified and given the same weight, no matter how many pixels they are spread over. One way to do this is to choose one pixel to represent the event. This could be the pixel with the largest signal or the pixel containing the weighted centroid of the event. Assigning the full weight of the incident electron to this pixel removes the intrinsic variability in response to an incident electron and leads to an improved low spatial frequency <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M17" altimg="si0028.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula>. However, restricting each event to a single pixel removes the fall in the <inline-formula><alternatives><textual-form specific-use="jats-markup">NPS<sub><italic>n</italic></sub>(ω)</textual-form><mml:math id="M18" altimg="si0029.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> with increasing ω and leads to <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M19" altimg="si0031.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> being proportional to <inline-formula><alternatives><textual-form specific-use="jats-markup">MTF(ω)<sup>2</sup></textual-form><mml:math id="M20" altimg="si0032.gif" overflow="scroll"><mml:mi>MTF</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> (see Eq. <xref rid="fd2" ref-type="disp-formula">(2)</xref>). With this method it is important that the MTF is as high as possible and so ensure that a chosen pixel accurately represents the arrival position of the incident electron. Ideally one would like to be able to infer from an event the position at which the electron was incident on the detector. If this can be done with sub-pixel resolution it would be possible to overcome the <inline-formula><alternatives><textual-form specific-use="jats-markup">sin(<italic>x</italic>) / <italic>x</italic></textual-form><mml:math id="M21" altimg="si0033.gif" overflow="scroll"><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula> pixel damping envelope which otherwise restricts the MTF at the Nyquist frequency to <inline-formula><alternatives><textual-form specific-use="jats-markup">2 / π</textual-form><mml:math id="M22" altimg="si0034.gif" overflow="scroll"><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mi>π</mml:mi></mml:math></alternatives></inline-formula>. From the observed single events, Bayesian inference can be used to generate a probability distribution for the arrival position of the electrons. Unfortunately, the diffusion blurred images obtained with the Vanilla detector's <inline-formula><alternatives><textual-form specific-use="jats-markup">25×25 μ<italic>m</italic><sup>2</sup></textual-form><mml:math id="M23" altimg="si0035.gif" overflow="scroll"><mml:mn>25</mml:mn><mml:mo>×</mml:mo><mml:mn>25</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> pixels do not in general retain sufficient information about the energy loss along the stochastic trajectory of an incident 120 keV electron in order to accurately identify the electron's arrival position. Analysis of simulated events in which calculated electron trajectories and measured charge diffusion effects are used as priors, does however indicate that the signal in a pixel approximately reflects the calculated probability distribution obtained using a Bayesian analysis. Based on this observation, our preferred way of processing the single event images is a heuristic approach in which we ignore any contributions below the threshold for the event and renormalise the remaining contributions so that they sum to unity. The resulting effective probability distribution is fast to calculate and yet captures the main features of the more computationally expensive Bayesian analysis. With this approach all events contribute equally to the <inline-formula><alternatives><textual-form specific-use="jats-markup">NPS<sub><italic>n</italic></sub>(ω)</textual-form><mml:math id="M24" altimg="si0036.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> at zero spatial but events that are spread over several pixels contribute less at higher spatial frequency.</p>
      <p>The MTF was measured using the well-known edge method <xref rid="bib1" ref-type="bibr">[1]</xref> with a 2 mm diameter Pt rod placed at the pointer position of the microscope being used to create the edge. The processed images were analysed using the same approach and computer programs used in <xref rid="bib8" ref-type="bibr">[8]</xref>. In particular the edge spread function was fitted to a model for the point spread function consisting of a sum of up to three Gaussian functions.</p>
      <p>The <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M25" altimg="si0037.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> of the detector in integrating mode was calculated via Eq. <xref rid="fd2" ref-type="disp-formula">(2)</xref> using the measured number of electrons per frame, <inline-formula><alternatives><textual-form specific-use="jats-markup">NPS<sub><italic>n</italic></sub>(ω)</textual-form><mml:math id="M26" altimg="si0038.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> calculated from the power spectra of the difference between successive frames and previously calculated <inline-formula><alternatives><textual-form specific-use="jats-markup">MTF(ω)</textual-form><mml:math id="M27" altimg="si0039.gif" overflow="scroll"><mml:mi>MTF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula>. When operated in single event mode, the <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M28" altimg="si0040.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> was obtained from an estimate of <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(0)</textual-form><mml:math id="M29" altimg="si0041.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula>, the measured <inline-formula><alternatives><textual-form specific-use="jats-markup">MTF(ω)</textual-form><mml:math id="M30" altimg="si0042.gif" overflow="scroll"><mml:mi>MTF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> and the <inline-formula><alternatives><textual-form specific-use="jats-markup">NPS<sub><italic>n</italic></sub>(ω)</textual-form><mml:math id="M31" altimg="si0043.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>NPS</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> obtained from the circular average of the sum of power spectra of the individual renormalised events <xref rid="bib2" ref-type="bibr">[2]</xref>. <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(0)</textual-form><mml:math id="M32" altimg="si0044.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> is obtained from the ratio of the number of recorded events to the expected number of incident electrons.</p>
    </sec>
    <sec id="sec3">
      <label>3</label>
      <title>Results</title>
      <p>In <xref rid="fig1" ref-type="fig">Fig. 1</xref>, panels (a)–(r) show examples of typical single electron event images obtained at 120 keV. For comparison the noise level is illustrated with an area having no events in panel (s) and the zero level is shown in panel (t). The reason for wanting to use the electron event counting mode instead of integrating mode is illustrated by the difference in the way the events in <xref rid="fig1" ref-type="fig">Fig. 1</xref>(b) and (r) are treated. The event shown in <xref rid="fig1" ref-type="fig">Fig. 1</xref>b contains <inline-formula><alternatives><textual-form specific-use="jats-markup">12×</textual-form><mml:math id="M33" altimg="si0045.gif" overflow="scroll"><mml:mn>12</mml:mn><mml:mo>×</mml:mo></mml:math></alternatives></inline-formula> the integrated signal of that in <xref rid="fig1" ref-type="fig">Fig. 1</xref>(r) but it is the latter event that contains the high spatial frequency information and it is weak precisely because it comes from an incident electron that passes relatively unscattered through the sensitive layer. In the integrating mode the low resolution event ends up with greater weight whereas in the single electron event mode the weight of the high resolution event is increased and both events correctly have the same weight at zero spatial frequency.</p>
      <p><xref rid="fig2" ref-type="fig">Fig. 2</xref> shows a <inline-formula><alternatives><textual-form specific-use="jats-markup">300×300</textual-form><mml:math id="M34" altimg="si0046.gif" overflow="scroll"><mml:mn>300</mml:mn><mml:mo>×</mml:mo><mml:mn>300</mml:mn></mml:math></alternatives></inline-formula> pixel area on the detector used in the measurement of the MTF via the edge method. <xref rid="fig2" ref-type="fig">Fig. 2</xref>(a) shows a typical frame in the series used to calculate the MTF using single electron events. In <xref rid="fig2" ref-type="fig">Fig. 2</xref>(b) the selected events from the image shown in <xref rid="fig2" ref-type="fig">Fig. 2</xref>(a) are marked with a circle centred on the seed pixel. <xref rid="fig2" ref-type="fig">Fig. 2</xref>(c) and (d) show the final edge images obtained from the summation of all frames using the single electron and integrating modes, respectively. The insets in <xref rid="fig2" ref-type="fig">Fig. 2</xref>(c) and (d) contain <inline-formula><alternatives><textual-form specific-use="jats-markup">8×</textual-form><mml:math id="M35" altimg="si0047.gif" overflow="scroll"><mml:mn>8</mml:mn><mml:mo>×</mml:mo></mml:math></alternatives></inline-formula> magnified areas around the edge and clearly illustrate the improved MTF obtained using the single event mode.</p>
      <p>A comparison of the measured <inline-formula><alternatives><textual-form specific-use="jats-markup">MTF(ω)</textual-form><mml:math id="M36" altimg="si0048.gif" overflow="scroll"><mml:mi>MTF</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M37" altimg="si0049.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> results obtained using the integrating and single electron counting modes of the Vanilla detector is given in <xref rid="fig3" ref-type="fig">Fig. 3</xref>. Single event image results obtained using the peak pixel position of an event and the heuristic event renormalisation procedure introduced in <xref rid="sec2" ref-type="sec">Section 2</xref> are given. The integrating mode MTF was obtained with a three Gaussian fit and falls to 3% at the Nyquist frequency. A double Gaussian fit was sufficient to describe the single event MTF and the results obtained using either the peak position or renormalised event distributions are almost identical. In both cases the MTF at the Nyquist frequency is 25% and represents an eight-fold improvement over the corresponding integrating mode result. The value of DQE(0) in the integrating mode was independently measured via the binning method described in <xref rid="bib8" ref-type="bibr">[8]</xref> to be 65%. This agrees well with the zero frequency limit of <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M38" altimg="si0050.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> shown in <xref rid="fig3" ref-type="fig">Fig. 3</xref>b. The corresponding value at the Nyquist frequency is 6%. The value of DQE(0) in the single event mode was estimated to be 90% based on the ratio of counted to expected number of incident electrons. When the peak position of events is used to analyse the single event images the resulting <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M39" altimg="si0051.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> falls as <inline-formula><alternatives><textual-form specific-use="jats-markup">MTF(ω)<sup>2</sup></textual-form><mml:math id="M40" altimg="si0052.gif" overflow="scroll"><mml:mi>MTF</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> with increasing ω. Despite the <inline-formula><alternatives><textual-form specific-use="jats-markup">8×</textual-form><mml:math id="M41" altimg="si0054.gif" overflow="scroll"><mml:mn>8</mml:mn><mml:mo>×</mml:mo></mml:math></alternatives></inline-formula> enhancement of the MTF, there is no difference in the value of DQE at the Nyquist frequency between that calculated using the single event peak position and that obtained using the integrating mode. In contrast, using the renormalised event method to analyse the single electron event images produces an enhanced <inline-formula><alternatives><textual-form specific-use="jats-markup">DQE(ω)</textual-form><mml:math id="M42" altimg="si0055.gif" overflow="scroll"><mml:mi>DQE</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> at all spatial frequencies. In particular the value of 20% at the Nyquist frequency represents a three-fold improvement over both the corresponding integrating and single electron peak position results.</p>
      <p>The enhanced imaging performance possible by using the single electron mode is further illustrated in <xref rid="fig4" ref-type="fig">Fig. 4</xref> using shadow images of an EM grid. The grid was mounted at the pointer position of the microscope and shadow images were taken with a dose of 15 electrons per pixel. The integrating mode image shown in <xref rid="fig4" ref-type="fig">Fig. 4</xref>(a) came from 5 frames and was acquired in 0.1 s while the corresponding single electron image shown in <xref rid="fig4" ref-type="fig">Fig. 4</xref>(c) was obtained using renormalised events from 7500 frames and took 51 s to acquire. The single event image appears sharper than the integrating mode image although it took longer to acquire. This difference is illustrated in the corresponding Fourier transforms shown in <xref rid="fig4" ref-type="fig">Fig. 4</xref>(b) and (d) where the spots visible in the single event transform are stronger, more numerous and have a lower surrounding noise level. To quantify this difference the MTF enhancement was obtained by comparing the amplitudes of the signal from the strongest spots along the [01] and [10] directions. Similarly, the DQE enhancement was obtained by estimating the noise in the vicinity of a spot and comparing the square of the signal to noise ratios. The results of this analysis and the corresponding results expected from <xref rid="fig3" ref-type="fig">Fig. 3</xref> are given in <xref rid="fig5" ref-type="fig">Fig. 5</xref>. The results from the two alternative ways of measuring the improvement in MTF and DQE agree well.</p>
    </sec>
    <sec id="sec4">
      <label>4</label>
      <title>Discussion and conclusions</title>
      <p>When operating in electron counting mode the DQE performance at 120 keV presented in <xref rid="fig3" ref-type="fig">Fig. 3</xref>(b) exceeds that of all currently available CCD detectors, the Medpix2 detector and film <xref rid="bib8" ref-type="bibr">[8]</xref>. The advantage obtained using the counting mode can be expected to be even greater at higher incident energies where the decrease in the ratio of the average to the corresponding variability, in the signal deposited in a thin sensitive layer leads to a lower DQE(0) for integrating mode detectors. The increased range over which electrons backscatter at higher energies also makes it feasible to attempt to disentangle the contributions from primary and backscattered events. Doing so would enable a further improvement in both the higher spatial frequency MTF and DQE.</p>
      <p>Even with the improved performance available through using the electron counting mode, any practical detector for use in low dose applications such as single particle cryoEM or cryo-tomography will require a larger field of view than is available with the Vanilla sensor used here. While it is possible to compensate for sample drift during image acquisition, higher frame rates would be advantageous in reducing the overall time for an exposure. Higher frame rates would also increase the apparent rad-hardness of a detector due to the reduction of the integrated leakage current contribution in an individual frame. On the other hand, longer exposure times enforce a welcome increase in spatial coherence and corresponding improved microscope envelope function.</p>
      <p>The Vanilla detector does not employ a radhard design and, on top of the increase in leakage current, the exposure to the direct beam results in transient hot pixels. In particular, while the use of a hard reset minimises any image lag, occasionally there is a noticeable long lasting response in a pixel after an event. As this can be above the threshold it will lead to erroneously recording duplicated events. Fortunately such events are typically restricted to a single pixel and can be distinguished from true events, such as those illustrated in <xref rid="fig1" ref-type="fig">Fig. 1</xref>, which are generally spread into neighbouring pixels and are absent in the following frames. A practical event counting detector should however incorporate radhard design <xref rid="bib15 bib7" ref-type="bibr">[15,7]</xref> so as to minimise radiation damage and need for extra event processing.</p>
      <p>In this paper we have shown that it is possible to obtain both higher MTF and DQE performance from a MAPS detector by operating it in an electron counting mode. We show that using renormalised single event images as an effective probability distribution for the incident electrons arrival position provides an efficient and effective method for processing single electron events. This method, as opposed to choosing the position of the maximum signal or centroid of an event, leads to an improvement in the DQE over all spatial frequencies. We believe that, despite the more than <inline-formula><alternatives><textual-form specific-use="jats-markup">~5000×</textual-form><mml:math id="M43" altimg="si0056.gif" overflow="scroll"><mml:mo>~</mml:mo><mml:mn>5000</mml:mn><mml:mo>×</mml:mo></mml:math></alternatives></inline-formula> increase in raw data, the improvement in imaging performance demonstrated here will make collecting electron event counting images the preferred method with which to obtain low dose images of radiation sensitive samples.</p>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="bib1">
        <label>1</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Dainty</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Shaw</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <chapter-title>Image Science</chapter-title>
          <year>1974</year>
          <publisher-name>Academic Press</publisher-name>
          <publisher-loc>New York</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bib2">
        <label>2</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Meyer</surname>
              <given-names>R.R.</given-names>
            </name>
            <name>
              <surname>Kirkland</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <source>Ultramicroscopy</source>
          <volume>75</volume>
          <year>1998</year>
          <fpage>23</fpage>
          <lpage>33</lpage>
        </element-citation>
      </ref>
      <ref id="bib3">
        <label>3</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Mooney</surname>
              <given-names>P.</given-names>
            </name>
          </person-group>
          <source>Methods Cell Biol.</source>
          <volume>79</volume>
          <year>2007</year>
          <fpage>661</fpage>
          <lpage>719</lpage>
          <pub-id pub-id-type="pmid">17327180</pub-id>
        </element-citation>
      </ref>
      <ref id="bib4">
        <label>4</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Faruqi</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Henderson</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Pryddetch</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Turchetta</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Allport</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Evans</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <source>Nucl. Instrum. Methods A</source>
          <volume>546</volume>
          <year>2005</year>
          <fpage>170</fpage>
          <lpage>175</lpage>
        </element-citation>
      </ref>
      <ref id="bib5">
        <label>5</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Deptuch</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Besson</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Rehak</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Szelezniak</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Wall</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Winter</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>Y.</given-names>
            </name>
          </person-group>
          <source>Ultramicroscopy</source>
          <volume>107</volume>
          <year>2007</year>
          <fpage>674</fpage>
          <lpage>684</lpage>
          <pub-id pub-id-type="pmid">17346890</pub-id>
        </element-citation>
      </ref>
      <ref id="bib6">
        <label>6</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Jin</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Milazzo</surname>
              <given-names>A.-C.</given-names>
            </name>
            <name>
              <surname>Kleinfelder</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Leblanc</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Duttweiler</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Bouwer</surname>
              <given-names>J.C.</given-names>
            </name>
            <name>
              <surname>Peltier</surname>
              <given-names>S.T.</given-names>
            </name>
            <name>
              <surname>Ellisman</surname>
              <given-names>M.H.</given-names>
            </name>
            <name>
              <surname>Xuong</surname>
              <given-names>N.-H.</given-names>
            </name>
          </person-group>
          <source>J. Struct. Biol.</source>
          <volume>161</volume>
          <year>2008</year>
          <fpage>352</fpage>
          <lpage>358</lpage>
          <pub-id pub-id-type="pmid">18054249</pub-id>
        </element-citation>
      </ref>
      <ref id="bib7">
        <label>7</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Battaglia</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Contarato</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Denes</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Doering</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Giubilato</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>T.S.</given-names>
            </name>
            <name>
              <surname>Mattiazzo</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Radmilovic</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>Zalusky</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <source>Nucl. Instrum. Methods A</source>
          <volume>598</volume>
          <year>2009</year>
          <fpage>642</fpage>
          <lpage>649</lpage>
        </element-citation>
      </ref>
      <ref id="bib8">
        <label>8</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>McMullan</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Henderson</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Faruqi</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <source>Ultramicroscopy</source>
          <volume>109</volume>
          <year>2009</year>
          <fpage>1126</fpage>
          <lpage>1143</lpage>
          <pub-id pub-id-type="pmid">19497671</pub-id>
        </element-citation>
      </ref>
      <ref id="bib9">
        <label>9</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Faruqi</surname>
              <given-names>A.R.</given-names>
            </name>
            <name>
              <surname>Henderson</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Holmes</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <source>Nucl. Instrum. Methods A</source>
          <volume>565</volume>
          <year>2006</year>
          <fpage>139</fpage>
          <lpage>143</lpage>
        </element-citation>
      </ref>
      <ref id="bib10">
        <label>10</label>
        <element-citation publication-type="book">
          <person-group person-group-type="author">
            <name>
              <surname>Ohta</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <chapter-title>Smart CMOS Image Sensors and Applications</chapter-title>
          <year>2007</year>
          <publisher-name>CRC Press</publisher-name>
          <publisher-loc>Boca Raton</publisher-loc>
        </element-citation>
      </ref>
      <ref id="bib11">
        <label>11</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Allinson</surname>
              <given-names>N.</given-names>
            </name>
          </person-group>
          <source>Nucl. Instrum. Methods A</source>
          <volume>604</volume>
          <year>2009</year>
          <fpage>196</fpage>
          <lpage>198</lpage>
        </element-citation>
      </ref>
      <ref id="bib12">
        <label>12</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Bohndiek</surname>
              <given-names>S.E.</given-names>
            </name>
            <name>
              <surname>Arvanitis</surname>
              <given-names>C.D.</given-names>
            </name>
            <name>
              <surname>Royle</surname>
              <given-names>G.J.</given-names>
            </name>
            <name>
              <surname>Speller</surname>
              <given-names>R.D.</given-names>
            </name>
            <name>
              <surname>Clark</surname>
              <given-names>A.T.</given-names>
            </name>
            <name>
              <surname>Crooks</surname>
              <given-names>J.P.</given-names>
            </name>
            <name>
              <surname>Prydderch</surname>
              <given-names>M.L.</given-names>
            </name>
            <name>
              <surname>Turchetta</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Blue</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>O’Shea</surname>
              <given-names>V.</given-names>
            </name>
          </person-group>
          <source>Opt. Eng.</source>
          <volume>46</volume>
          <year>2007</year>
          <fpage>124003</fpage>
        </element-citation>
      </ref>
      <ref id="bib13">
        <label>13</label>
        <mixed-citation publication-type="other">Medipix2 collaboration, URL 〈<ext-link ext-link-type="uri" xlink:href="http://medipix.web.cern.ch/MEDIPIX">http://medipix.web.cern.ch/MEDIPIX</ext-link>〉.</mixed-citation>
      </ref>
      <ref id="bib14">
        <label>14</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>McMullan</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Cattermole</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Henderson</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Llopart</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Summerfield</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Tlustos</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Faruqi</surname>
              <given-names>A.R.</given-names>
            </name>
          </person-group>
          <source>Ultramicroscopy</source>
          <volume>107</volume>
          <year>2007</year>
          <fpage>401</fpage>
          <lpage>413</lpage>
          <pub-id pub-id-type="pmid">17140733</pub-id>
        </element-citation>
      </ref>
      <ref id="bib15">
        <label>15</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Eid</surname>
              <given-names>E.-S.</given-names>
            </name>
            <name>
              <surname>Chan</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Fossum</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Tsai</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Spagnuolo</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Deily</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Byers</surname>
              <given-names>W.B.</given-names>
            </name>
            <name>
              <surname>Peden</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <source>IEEE Trans. Nucl. Sci.</source>
          <volume>48</volume>
          <year>2001</year>
          <fpage>1796</fpage>
          <lpage>1806</lpage>
        </element-citation>
      </ref>
    </ref-list>
    <ack>
      <title>Acknowledgements</title>
      <p>The Vanilla detector was fabricated as part of the RC-UK Basic Technology Multidimensional Integrated Intelligent Imaging programme (GR/S 85733/01). We are indebted to the MRC-LMB workshops for their help in the installation of the detector.</p>
    </ack>
  </back>
  <floats-group>
    <fig id="fig1">
      <label>Fig. 1</label>
      <caption>
        <p>Examples of single electron events due to 120 keV incident electrons as recorded on the Vanilla sensor. The pixel values are both dark subtracted and gain corrected. Their values lie between <inline-formula><alternatives><textual-form specific-use="jats-markup"> - 15</textual-form><mml:math id="M44" altimg="si0001.gif" overflow="scroll"><mml:mo>-</mml:mo><mml:mn>15</mml:mn></mml:math></alternatives></inline-formula> and 241 ADC units and they are illustrated by linearly mapping their values to a grey scale in which the incident electrons are shown as darker. A typical area with just readout noise is shown in (s) and, for reference, the zero value is illustrated in (t). The integrated value of each event is given in the lower right-hand corner of each panel. The average integrated value for 120 keV electrons was found to be 375 ADC units. In the images shown the peak value in an individual pixel is 241 ADC units and is found in event (c). The peak value in the weakest event shown in (r) is 49 ADC units.</p>
      </caption>
      <graphic xlink:href="gr1"/>
    </fig>
    <fig id="fig2">
      <label>Fig. 2</label>
      <caption>
        <p>Images of a <inline-formula><alternatives><textual-form specific-use="jats-markup">300×300</textual-form><mml:math id="M45" altimg="si0002.gif" overflow="scroll"><mml:mn>300</mml:mn><mml:mo>×</mml:mo><mml:mn>300</mml:mn></mml:math></alternatives></inline-formula> pixel area of the detector illuminated by the edge shadow pattern used to calculate the MTF. The pattern is formed by partially blocking a uniform beam with a 2 mm diameter Pt rod placed in the pointer position of the microscope. (a) Shows a typical frame in a series used to calculate the edge image via single electron events. As in <xref rid="fig1" ref-type="fig">Fig. 1</xref>, darker areas indicate the single electron events. (b) Shows the events selected from the frame shown in (a). The circles have been drawn around the seed pixel associated with each event. The use of a threshold meant that some events are not counted and where two incident electrons are too close they are counted as a single event. (c) Shows the edge image obtained by summing the contributions from single electron events contained in 68 550 frames such as shown in (a). The events have been renormalised using the procedure described in the text. (d) Shows the corresponding edge image obtained using the MAPS detector in the integrating mode in which the individual dark subtracted and gain normalised frames are simply added. The insets in (c) and (d) show an <inline-formula><alternatives><textual-form specific-use="jats-markup">8×</textual-form><mml:math id="M46" altimg="si0003.gif" overflow="scroll"><mml:mn>8</mml:mn><mml:mo>×</mml:mo></mml:math></alternatives></inline-formula> magnified view of an area of the edge with a scale bar representing 8 pixels, i.e. <inline-formula><alternatives><textual-form specific-use="jats-markup">200 μ<italic>m</italic></textual-form><mml:math id="M47" altimg="si0004.gif" overflow="scroll"><mml:mn>200</mml:mn><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:math></alternatives></inline-formula>.</p>
      </caption>
      <graphic xlink:href="gr2"/>
    </fig>
    <fig id="fig3">
      <label>Fig. 3</label>
      <caption>
        <p>Comparison of (a) MTF <inline-formula><alternatives><textual-form specific-use="jats-markup">(ω)</textual-form><mml:math id="M48" altimg="si0005.gif" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> and (b) DQE <inline-formula><alternatives><textual-form specific-use="jats-markup">(ω)</textual-form><mml:math id="M49" altimg="si0006.gif" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> obtained using integrating and single electron event modes. Results obtained using the integrating mode are shown as the solid (—) lines. Single electron mode results in which renormalised events are used are shown in dashed (-) lines and single electron mode results obtained using the events’ peak positions are shown as dotted (⋯) lines.</p>
      </caption>
      <graphic xlink:href="gr3"/>
    </fig>
    <fig id="fig4">
      <label>Fig. 4</label>
      <caption>
        <p>Comparison of integrating and single electron mode shadow images of an EM grid obtained using the same total number of electrons. The integrating mode and single electron mode images are shown in (a) and (c), respectively, with the darker areas representing areas exposed to electrons. A quadrant of the Fourier transforms of the images shown in (a) and (c) are given in (b) and (d), respectively. The circles in (d) indicate the spots from one of the [10] directions whose amplitudes and signal to noise ratios were measured and used in generating <xref rid="fig5" ref-type="fig">Fig. 5</xref>.</p>
      </caption>
      <graphic xlink:href="gr4"/>
    </fig>
    <fig id="fig5">
      <label>Fig. 5</label>
      <caption>
        <p>Enhancement in (a) MTF (ω) and (b) DQE (ω) performance obtained by using renormalised single event imaging over the conventional integrating mode imaging. The dashed lines in (a) and (b) show the corresponding enhancements taken from the results given in <xref rid="fig3" ref-type="fig">Fig. 3</xref>. The circles (∘) show results obtained from the grid shadow images. The MTF enhancement was obtained from the ratio of amplitudes of the spots as indicated in <xref rid="fig4" ref-type="fig">Fig. 4</xref> measured in single event and integrating modes. The DQE enhancement was obtained from the corresponding square of the ratio of signal-to-noise for the spots.</p>
      </caption>
      <graphic xlink:href="gr5"/>
    </fig>
  </floats-group>
</article>